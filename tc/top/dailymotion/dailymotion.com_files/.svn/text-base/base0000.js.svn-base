var EventSelectors={version:"1.0_pre",cache:[],start:function(A){this.rules=A||{};this.timer=new Array();this._extendRules();this.assign(this.rules)},assign:function(B){var A=null;this._unloadCache();B._each(function(D){var C=$A(D.key.split(","));C.each(function(E){var G=E.split(":");var F=G[1];$$(G[0]).each(function(H){if(G[1]==""||G.length==1){return D.value(H)}if(F.toLowerCase()=="loaded"){this.timer[G[0]]=setInterval(this._checkLoaded.bind(this,H,G[0],D),15)}else{A=function(J){var I=Event.element(J);if(I.nodeType==3){I=I.parentNode}D.value($(I),J)};this.cache.push([H,F,A]);Event.observe(H,F,A)}}.bind(this))}.bind(this))}.bind(this))},_unloadCache:function(){if(!this.cache){return }for(var A=0;A<this.cache.length;A++){Event.stopObserving.apply(this,this.cache[A]);this.cache[A][0]=null}this.cache=[]},_checkLoaded:function(A,D,C){var B=$(A);if(A.tagName!="undefined"){clearInterval(this.timer[D]);C.value(B)}},_extendRules:function(){Object.extend(this.rules,{_each:function(A){for(key in this){if(key=="_each"){continue}var B=this[key];var C=[key,B];C.key=key;C.value=B;A(C)}}})}};var DM_Domfixer={cssBrowserSelector:function(){var B=navigator.userAgent.toLowerCase(),D=function(G){return B.indexOf(G)!=-1},C=document.getElementsByTagName("html")[0],A=(!(/opera|webtv/i.test(B))&&/msie (\d)/.test(B))?("ie ie"+RegExp.$1):D("gecko/")?"gecko":D("opera/9")?"opera opera9":/opera (\d)/.test(B)?"opera opera"+RegExp.$1:D("konqueror")?"konqueror":D("applewebkit/")?"webkit safari":D("mozilla/")?"gecko":"",E=(D("x11")||D("linux"))?" linux":D("mac")?" mac":D("win")?" win":"";var F=A+E+" js";C.className+=C.className?" "+F:F}};DM_Domfixer.cssBrowserSelector();var DM_Widget_Popup={show:function(){if(!$("dimmer")){var F=new Element("div",{"id":"dimmer"});$("bodyall").insert({top:F});$("dimmer").setStyle({width:$("bodyall").getWidth()+"px",height:$("bodyall").getHeight()+"px"})}if(!$("popup")){var A=new Element("div",{"class":"popup_widget background_3","id":"popup"});var D=new Element("div",{"class":" close_img"});var E=new Element("div",{"class":"foreground2 light_border close"}).update(DM_CloseLabel);E.onclick=D.onclick=DM_Widget_Popup.close;A.insert({bottom:E});A.insert({bottom:D});$("dimmer").insert({after:A});new Draggable("popup");DM_KeyHandler.registerAction(Keyboard.ESCAPE,null,DM_Widget_Popup.close)}else{var A=$("popup")}if($("video_player")){var C=$("video_player");var B=(Position.cumulativeOffset(C)[1])+C.getHeight();A.setStyle({top:B+10+"px",left:"35%"})}else{A.setStyle({top:((document.viewport.getHeight()-360)/2+document.viewport.getScrollOffsets().top)+"px",left:(document.viewport.getWidth()-A.getWidth())/2+"px"})}return A},close:function(){$("popup").hide();$("dimmer").hide()},destroy:function(){if($("popup")){$("popup").remove()}$("dimmer").hide()}};var Keyboard={BACKSPACE:8,ENTER:13,SHIFT:16,CONTROL:17,ESCAPE:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90};if(Prototype.Browser.WebKit){}var DM_Ajax={defaultLocation:null,enableEventListener:false,debugCallBack:true,debug:false,init:function(){if(!$("loading")){return false}this.initLoading();this.ajaxify(document)},debug:function(A){if(DM_Ajax.debug){dbg(A)}},initLoading:function(){Ajax.clicked_obj=new Array;Ajax.loading_cnt=0;Ajax.loading_div=$("loading");Event.observe(document,"scroll",this.scrollLoading.bindAsEventListener(this))},ajaxify:function(A,B){if(typeof (A)=="undefined"){var A=document}A=$(A);try{if(A.nodeName=="A"&&A.hasClassName("ajax")){DM_Ajax.ajaxifyLink(A)}}catch(F){}var E=A.getElementsByTagName("a");var D=E.length;for(var C=0;C<D;C++){if(DM_Ajax.needAjaxify(E[C])){continue}DM_Ajax.ajaxifyLink(E[C])}E=Object.isElement(A)?A.down("form.ajax"):$$("form.ajax");D=E.length;for(var C=0;C<D;C++){this.addAjaxForm(E[C])}if(Ajax.loading_cnt==0){Ajax.loading_div.hide()}},needAjaxify:function(A){return A.name!="ajax"},addAjaxForm:function(A){A=$(A);if(typeof (A.alreadyObserved)=="undefined"){A.alreadyObserved=true;A.submitForm=this.submitForm.bind(this,A);A.observe("submit",this.checkFormSubmit.bindAsEventListener(this,A));if(!A.getInputs("submit").length){inputs=A.getInputs();for(i=0;i<inputs.length;i++){if(inputs[i].type!="password"&&inputs[i].type!="text"){continue}inputs[i].observe("keyup",this.checkFormSubmit.bindAsEventListener(this,A))}}this.parseAction(A)}},parseAction:function(D){var B=new RegExp("action:(replace|insert|top|bottom|before|after|fade|hide|popup)");var F=0;var H=[];var E=null;var I=null;if(D.nodeName=="FORM"){I="replace"}if((E=D.className.match(B))||I){var G=null;if(I){G=I}else{G=E[1]}while(arg=D.className.match(new RegExp("action:arg"+F+":([^ ]+)"))){H[H.length]=arg[1].sub("--"," ");F++}var C=[D];if(H.length>0){if(H[0]=="parent"){C=[D.parentNode]}else{C=$$(H[0])}}switch(G){case"top":case"bottom":case"before":case"after":var A=function(K){var J={};J[G]=Ajax.XHR.responseText;K.insert(J)};break;case"fade":var A=function(J){Effect.Fade(J)};break;case"hide":var A=function(J){J.hide()};break;case"replace":var A=function(J){Element.replace(J,Ajax.XHR.responseText)};break;case"insert":var A=function(J){J.update(Ajax.XHR.responseText)};break;case"popup":var A=function(J){popup=DM_Widget_Popup.show();if(popup.firstDescendant()){if(popup.firstDescendant().hasClassName("close")){popup.insert({top:Ajax.XHR.responseText})}else{popup.firstDescendant().replace(Ajax.XHR.responseText)}}$("dimmer").show();new Effect.Appear(popup)};break}if(A){D.jsAction=function(){C.each(function(J){A(J)});DM_Ajax.ajaxify(document)}}}},ajaxifyLink:function(B,A){B=$(B);if(typeof (B.alreadyObserved)=="undefined"){this.parseAction(B);B.alreadyObserved=true;if(!DM_Ajax.enableEventListener){B.onclick=DM_Ajax.clickWithOnClick}else{B.listener=this.clickWithEventListener.bindAsEventListener(this,B);B.observe("click",B.listener)}if(typeof (A)=="undefined"){var A=B.href}B.ajaxlink=A}},lockClickedObj:function(A){A.ajaxLock=true},isLockedClickedObj:function(A){return A.ajaxLock==true?true:false},unlockClickedObj:function(A){A.ajaxLock=false},getElementUniqueId:function(A){var B=A.offsetTop+""+A.offsetWidth+""+A.className;return B},clickWithOnClick:function(){var B=DM_Ajax.getElementUniqueId(this);Ajax.clicked_obj[B]=this;if(!DM_Ajax.isLockedClickedObj(this)){DM_Ajax.lockClickedObj(this);var A=findParamInClass("confirm",Ajax.clicked_obj[B]);if(A&&!confirm(hex2str(A))){DM_Ajax.unlockClickedObj(this);return false}if(Ajax.clicked_obj[B].nodeName=="A"){Ajax.clicked_obj[B].addClassName("icon_loading")}DM_Ajax.request(Ajax.clicked_obj[B].ajaxlink,B)}return false},clickWithEventListener:function(B,A){var C=DM_Ajax.getElementUniqueId($(A));Ajax.clicked_obj[C]=$(A);this.request(Ajax.clicked_obj[C].href,C);Event.stop(B)},deAjaxifyLink:function(A){link.stopObserving("click",link.listener)},scrollLoading:function(A){res=document.documentElement.scrollTop||document.body.scrollTop;Ajax.loading_div.setStyle({top:res+"px"})},saveClientBodyHeight:function(){var A=document.getElementsByTagName("body");A[0].oldHeight=A[0].style.height;A[0].style.height=A[0].clientHeight+"px"},resetClientBodyHeight:function(){var A=document.getElementsByTagName("body");A[0].style.height=A[0].oldHeight},request:function(A,C){var B="";Ajax.loading_cnt++;Ajax.loading_div.show();new Ajax.Request(A,{method:"get",parameters:B,onComplete:this.ajaxCallback.bind(this,C)})},ajaxCallback:function(uniqueID,XHR,eJSON){Ajax.XHR=XHR;try{DM_Ajax.saveClientBodyHeight();DM_Ajax.tmpUniqueID=uniqueID;DM_Ajax.resetClientBodyHeight();if(Ajax.clicked_obj[uniqueID].jsAction){Ajax.clicked_obj[uniqueID].jsAction()}if(eJSON){var curLen=eJSON.length;for(var j=0;j<curLen;j++){eval(eJSON[j])}}DM_Ajax.unlockClickedObj(Ajax.clicked_obj[uniqueID])}catch(e){if(DM_Ajax.debugCallBack){dbg("CallBackError: "+e.message)}DM_Ajax.unlockClickedObj(Ajax.clicked_obj[uniqueID])}if(Ajax.clicked_obj[uniqueID]&&Ajax.clicked_obj[uniqueID].submited){Ajax.clicked_obj[uniqueID].submited=false}if(Ajax.loading_cnt>0){Ajax.loading_cnt--}if(Ajax.loading_cnt==0){Ajax.loading_div.hide();Ajax.clicked_obj[uniqueID].removeClassName("icon_loading");if(loading=Ajax.clicked_obj[uniqueId].down("div.loading")){loading.hide()}}},submitForm:function(A){var A=$(A);var C=DM_Ajax.getElementUniqueId(A);A.submited=true;Ajax.clicked_obj[C]=A;var B=A.down(".loading");if(B){B.show()}A.request({onComplete:this.ajaxCallback.bind(this,C)})},checkFormSubmit:function(B,A){Event.stop(B);A=$(A);if((!B.keyCode||B.keyCode==Event.KEY_RETURN)&&!A.submited){this.submitForm(A)}},replaceParentWidgetByReponse:function(){DM_Ajax.replaceWidgetByReponse("parent")},replacePageItemByReponse:function(){DM_Ajax.replaceWidgetByReponse("pageitem")},replaceComponentByReponse:function(){DM_Ajax.replaceWidgetByReponse("component")},replaceWidgetByReponse:function(A){var C=Ajax.clicked_obj[[DM_Ajax.tmpUniqueID]];if(A=="pageitem"){var E=/(dmpi)_(.*)/}else{if(A=="component"){var E=/(dmco)_(.*)/}else{var E=/(dmco|dmpi)_(.*)/}}if(A!="parent"){var D=E.exec(C.className)}if(D&&A!="parent"){var B=C}else{var F=C;while(F.parentNode){var D=E.exec(F.parentNode.className);if(D){var B=F.parentNode;break}var F=F.parentNode}}if(typeof (B)!="undefined"){DM_Ajax.replaceElementByReponse(B)}}};Event.onDOMReady(function(){DM_Ajax.init()});var Scriptaculous={Version:"1.8.0",require:function(A){document.write('<script type="text/javascript" src="'+A+'"><\/script>')},REQUIRED_PROTOTYPE:"1.6.0",load:function(){function A(B){var C=B.split(".");return parseInt(C[0])*100000+parseInt(C[1])*1000+parseInt(C[2])}if((typeof Prototype=="undefined")||(typeof Element=="undefined")||(typeof Element.Methods=="undefined")||(A(Prototype.Version)<A(Scriptaculous.REQUIRED_PROTOTYPE))){throw ("script.aculo.us requires the Prototype JavaScript framework >= "+Scriptaculous.REQUIRED_PROTOTYPE)}$A(document.getElementsByTagName("script")).findAll(function(B){return(B.src&&B.src.match(/scriptaculous\.js(\?.*)?$/))}).each(function(C){var D=C.src.replace(/scriptaculous\.js(\?.*)?$/,"");var B=C.src.match(/\?.*load=([a-z,]*)/);(B?B[1]:"builder,effects,dragdrop,controls,slider,sound").split(",").each(function(E){Scriptaculous.require(D+E+".js")})})}};Scriptaculous.load();String.prototype.parseColor=function(){var A="#";if(this.slice(0,4)=="rgb("){var C=this.slice(4,this.length-1).split(",");var B=0;do{A+=parseInt(C[B]).toColorPart()}while(++B<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var B=1;B<4;B++){A+=(this.charAt(B)+this.charAt(B)).toLowerCase()}}if(this.length==7){A=this.toLowerCase()}}}return(A.length==7?A:(arguments[0]||this))};Element.collectTextNodes=function(A){return $A($(A).childNodes).collect(function(B){return(B.nodeType==3?B.nodeValue:(B.hasChildNodes()?Element.collectTextNodes(B):""))}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(A,B){return $A($(A).childNodes).collect(function(C){return(C.nodeType==3?C.nodeValue:((C.hasChildNodes()&&!Element.hasClassName(C,B))?Element.collectTextNodesIgnoreClass(C,B):""))}).flatten().join("")};Element.setContentZoom=function(A,B){A=$(A);A.setStyle({fontSize:(B/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return A};Element.getInlineOpacity=function(A){return $(A).style.opacity||""};Element.forceRerendering=function(A){try{A=$(A);var C=document.createTextNode(" ");A.appendChild(C);A.removeChild(C)}catch(B){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(A){return(-Math.cos(A*Math.PI)/2)+0.5},reverse:function(A){return 1-A},flicker:function(A){var A=((-Math.cos(A*Math.PI)/4)+0.75)+Math.random()/4;return A>1?1:A},wobble:function(A){return(-Math.cos(A*Math.PI*(9*A))/2)+0.5},pulse:function(B,A){A=A||5;return(((B%(1/A))*A).round()==0?((B*A*2)-(B*A*2).floor()):1-((B*A*2)-(B*A*2).floor()))},spring:function(A){return 1-(Math.cos(A*4.5*Math.PI)*Math.exp(-A*6))},none:function(A){return 0},full:function(A){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},PAIRS:{"slide":["SlideDown","SlideUp"],"blind":["BlindDown","BlindUp"],"appear":["Appear","Fade"]},toggle:function(B,C){B=$(B);C=(C||"appear").toLowerCase();var A=Object.extend({queue:{position:"end",scope:(B.id||"global"),limit:1}},arguments[2]||{});Effect[B.visible()?Effect.PAIRS[C][1]:Effect.PAIRS[C][0]](B,A)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(A){this.effects._each(A)},add:function(B){var C=new Date().getTime();var A=Object.isString(B.options.queue)?B.options.queue:B.options.queue.position;switch(A){case"front":this.effects.findAll(function(D){return D.state=="idle"}).each(function(D){D.startOn+=B.finishOn;D.finishOn+=B.finishOn});break;case"with-last":C=this.effects.pluck("startOn").max()||C;break;case"end":C=this.effects.pluck("finishOn").max()||C;break}B.startOn+=C;B.finishOn+=C;if(!B.options.queue.limit||(this.effects.length<B.options.queue.limit)){this.effects.push(B)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(A){this.effects=this.effects.reject(function(B){return B==A});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var C=new Date().getTime();for(var B=0,A=this.effects.length;B<A;B++){this.effects[B]&&this.effects[B].loop(C)}}});Effect.Queues={instances:$H(),get:function(A){if(!Object.isString(A)){return A}return this.instances.get(A)||this.instances.set(A,new Effect.ScopedQueue())}};Effect.Queue=Effect.Queues.get("global");Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+"Internal"]?"this.options."+eventName+"Internal(this);":"")+(options[eventName]?"this.options."+eventName+"(this);":""))}if(options&&options.transition===false){options.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;eval('this.render = function(pos){ if (this.state=="idle"){this.state="running";'+codeForEvent(this.options,"beforeSetup")+(this.setup?"this.setup();":"")+codeForEvent(this.options,"afterSetup")+'};if (this.state=="running"){pos=this.options.transition(pos)*'+this.fromToDelta+"+"+this.options.from+";this.position=pos;"+codeForEvent(this.options,"beforeUpdate")+(this.update?"this.update(pos);":"")+codeForEvent(this.options,"afterUpdate")+"}}");this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)}},loop:function(C){if(C>=this.startOn){if(C>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return }var B=(C-this.startOn)/this.totalTime,A=(B*this.totalFrames).round();if(A>this.currentFrame){this.render(B);this.currentFrame=A}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(A){if(this.options[A+"Internal"]){this.options[A+"Internal"](this)}if(this.options[A]){this.options[A](this)}},inspect:function(){var A=$H();for(property in this){if(!Object.isFunction(this[property])){A.set(property,this[property])}}return"#<Effect:"+A.inspect()+",options:"+$H(this.options).inspect()+">"}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(A){this.effects=A||[];this.start(arguments[1])},update:function(A){this.effects.invoke("render",A)},finish:function(A){this.effects.each(function(B){B.render(1);B.cancel();B.event("beforeFinish");if(B.finish){B.finish(A)}B.event("afterFinish")})}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(B){this.element=$(B);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var A=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(A)},update:function(A){this.element.setOpacity(A)}});Effect.Move=Class.create(Effect.Base,{initialize:function(B){this.element=$(B);if(!this.element){throw (Effect._elementDoesNotExistError)}var A=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(A)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(A){this.element.setStyle({left:(this.options.x*A+this.originalLeft).round()+"px",top:(this.options.y*A+this.originalTop).round()+"px"})}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(B){this.element=$(B);if(!this.element){throw (Effect._elementDoesNotExistError)}var A=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(A)},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return }this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color")}this._base=$R(0,2).map(function(A){return parseInt(this.options.startcolor.slice(A*2+1,A*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(A){return parseInt(this.options.endcolor.slice(A*2+1,A*2+3),16)-this._base[A]}.bind(this))},update:function(A){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(B,C,D){return B+((this._base[D]+(this._delta[D]*A)).round().toColorPart())}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.Fade=function(C){C=$(C);var A=C.getInlineOpacity();var B=Object.extend({from:C.getOpacity()||1,to:0,afterFinishInternal:function(D){if(D.options.to!=0){return }D.element.hide().setStyle({opacity:A})}},arguments[1]||{});return new Effect.Opacity(C,B)};Effect.Appear=function(B){B=$(B);var A=Object.extend({from:(B.getStyle("display")=="none"?0:B.getOpacity()||0),to:1,afterFinishInternal:function(C){C.element.forceRerendering()},beforeSetup:function(C){C.element.setOpacity(C.options.from).show()}},arguments[1]||{});return new Effect.Opacity(B,A)};Effect.BlindUp=function(A){A=$(A);A.makeClipping();return new Effect.Scale(A,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(B){B.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(B){B=$(B);var A=B.getDimensions();return new Effect.Scale(B,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:A.height,originalWidth:A.width},restoreAfterFinish:true,afterSetup:function(C){C.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(C){C.element.undoClipping()}},arguments[1]||{}))};Effect.SlideDown=function(C){C=$(C).cleanWhitespace();var A=C.down().getStyle("bottom");var B=C.getDimensions();return new Effect.Scale(C,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:B.height,originalWidth:B.width},restoreAfterFinish:true,afterSetup:function(D){D.element.makePositioned();D.element.down().makePositioned();if(window.opera){D.element.setStyle({top:""})}D.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(D){D.element.down().setStyle({bottom:(D.dims[0]-D.element.clientHeight)+"px"})},afterFinishInternal:function(D){D.element.undoClipping().undoPositioned();D.element.down().undoPositioned().setStyle({bottom:A})}},arguments[1]||{}))};Effect.SlideUp=function(C){C=$(C).cleanWhitespace();var A=C.down().getStyle("bottom");var B=C.getDimensions();return new Effect.Scale(C,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:B.height,originalWidth:B.width},restoreAfterFinish:true,afterSetup:function(D){D.element.makePositioned();D.element.down().makePositioned();if(window.opera){D.element.setStyle({top:""})}D.element.makeClipping().show()},afterUpdateInternal:function(D){D.element.down().setStyle({bottom:(D.dims[0]-D.element.clientHeight)+"px"})},afterFinishInternal:function(D){D.element.hide().undoClipping().undoPositioned();D.element.down().undoPositioned().setStyle({bottom:A})}},arguments[1]||{}))};Effect.Morph=Class.create(Effect.Base,{initialize:function(C){this.element=$(C);if(!this.element){throw (Effect._elementDoesNotExistError)}var A=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(A.style)){this.style=$H(A.style)}else{if(A.style.include(":")){this.style=A.style.parseStyle()}else{this.element.addClassName(A.style);this.style=$H(this.element.getStyles());this.element.removeClassName(A.style);var B=this.element.getStyles();this.style=this.style.reject(function(D){return D.value==B[D.key]});A.afterFinishInternal=function(D){D.element.addClassName(D.options.style);D.transforms.each(function(E){D.element.style[E.style]=""})}}}this.start(A)},setup:function(){function A(B){if(!B||["rgba(0, 0, 0, 0)","transparent"].include(B)){B="#ffffff"}B=B.parseColor();return $R(0,2).map(function(C){return parseInt(B.slice(C*2+1,C*2+3),16)})}this.transforms=this.style.map(function(G){var F=G[0],E=G[1],D=null;if(E.parseColor("#zzzzzz")!="#zzzzzz"){E=E.parseColor();D="color"}else{if(F=="opacity"){E=parseFloat(E);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}}else{if(Element.CSS_LENGTH.test(E)){var C=E.match(/^([\+\-]?[0-9\.]+)(.*)$/);E=parseFloat(C[1]);D=(C.length==3)?C[2]:null}}}var B=this.element.getStyle(F);return{style:F.camelize(),originalValue:D=="color"?A(B):parseFloat(B||0),targetValue:D=="color"?A(E):E,unit:D}}.bind(this)).reject(function(B){return((B.originalValue==B.targetValue)||(B.unit!="color"&&(isNaN(B.originalValue)||isNaN(B.targetValue))))})},update:function(A){var D={},B,C=this.transforms.length;while(C--){D[(B=this.transforms[C]).style]=B.unit=="color"?"#"+(Math.round(B.originalValue[0]+(B.targetValue[0]-B.originalValue[0])*A)).toColorPart()+(Math.round(B.originalValue[1]+(B.targetValue[1]-B.originalValue[1])*A)).toColorPart()+(Math.round(B.originalValue[2]+(B.targetValue[2]-B.originalValue[2])*A)).toColorPart():(B.originalValue+(B.targetValue-B.originalValue)*A).toFixed(3)+(B.unit===null?"":B.unit)}this.element.setStyle(D,true)}});Effect.Transform=Class.create({initialize:function(A){this.tracks=[];this.options=arguments[1]||{};this.addTracks(A)},addTracks:function(A){A.each(function(B){B=$H(B);var C=B.values().first();this.tracks.push($H({ids:B.keys().first(),effect:Effect.Morph,options:{style:C}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(A){var D=A.get("ids"),C=A.get("effect"),B=A.get("options");var E=[$(D)||$$(D)].flatten();return E.map(function(F){return new C(F,Object.extend({sync:true},B))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");String.prototype.parseStyle=function(){var B,A=$H();if(Prototype.Browser.WebKit){B=new Element("div",{style:this}).style}else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';B=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(C){if(B[C]){A.set(C,B[C])}});if(Prototype.Browser.IE&&this.include("opacity")){A.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1])}return A};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(B){var A=document.defaultView.getComputedStyle($(B),null);return Element.CSS_PROPERTIES.inject({},function(C,D){C[D]=A[D];return C})}}else{Element.getStyles=function(B){B=$(B);var A=B.currentStyle,C;C=Element.CSS_PROPERTIES.inject({},function(E,D){E.set(D,A[D]);return E});if(!C.opacity){C.set("opacity",B.getOpacity())}return C}}Effect.Methods={morph:function(A,B){A=$(A);new Effect.Morph(A,Object.extend({style:B},arguments[2]||{}));return A},visualEffect:function(C,E,B){C=$(C);var D=E.dasherize().camelize(),A=D.charAt(0).toUpperCase()+D.substring(1);new Effect[A](C,B);return C},highlight:function(B,A){B=$(B);new Effect.Highlight(B,A);return B}};$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(A){Effect.Methods[A]=function(C,B){C=$(C);Effect[A.charAt(0).toUpperCase()+A.substring(1)](C,B);return C}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(A){Effect.Methods[A]=Element[A]});Element.addMethods(Effect.Methods);if(Object.isUndefined(Effect)){throw ("dragdrop.js requires including script.aculo.us' effects.js library")}var Droppables={drops:[],remove:function(A){this.drops=this.drops.reject(function(B){return B.element==$(A)})},add:function(B){B=$(B);var A=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(A.containment){A._containers=[];var C=A.containment;if(Object.isArray(C)){C.each(function(D){A._containers.push($(D))})}else{A._containers.push($(C))}}if(A.accept){A.accept=[A.accept].flatten()}Element.makePositioned(B);A.element=B;this.drops.push(A)},findDeepestChild:function(A){deepest=A[0];for(i=1;i<A.length;++i){if(Element.isParent(A[i].element,deepest.element)){deepest=A[i]}}return deepest},isContained:function(B,A){var C;if(A.tree){C=B.treeNode}else{C=B.parentNode}return A._containers.detect(function(D){return C==D})},isAffected:function(A,C,B){return((B.element!=C)&&((!B._containers)||this.isContained(C,B))&&((!B.accept)||(Element.classNames(C).detect(function(D){return B.accept.include(D)})))&&Position.within(B.element,A[0],A[1]))},deactivate:function(A){if(A.hoverclass){Element.removeClassName(A.element,A.hoverclass)}this.last_active=null},activate:function(A){if(A.hoverclass){Element.addClassName(A.element,A.hoverclass)}this.last_active=A},show:function(A,C){if(!this.drops.length){return }var B,D=[];this.drops.each(function(E){if(Droppables.isAffected(A,C,E)){D.push(E)}});if(D.length>0){B=Droppables.findDeepestChild(D)}if(this.last_active&&this.last_active!=B){this.deactivate(this.last_active)}if(B){Position.within(B.element,A[0],A[1]);if(B.onHover){B.onHover(C,B.element,Position.overlap(B.overlap,B.element))}if(B!=this.last_active){Droppables.activate(B)}}},fire:function(B,A){if(!this.last_active){return }Position.prepare();if(this.isAffected([Event.pointerX(B),Event.pointerY(B)],A,this.last_active)){if(this.last_active.onDrop){this.last_active.onDrop(A,this.last_active.element,B);return true}}},reset:function(){if(this.last_active){this.deactivate(this.last_active)}}};var Draggables={drags:[],observers:[],register:function(A){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress)}this.drags.push(A)},unregister:function(A){this.drags=this.drags.reject(function(B){return B==A});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress)}},activate:function(A){if(A.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=A}.bind(this),A.options.delay)}else{window.focus();this.activeDraggable=A}},deactivate:function(){this.activeDraggable=null},updateDrag:function(A){if(!this.activeDraggable){return }var B=[Event.pointerX(A),Event.pointerY(A)];if(this._lastPointer&&(this._lastPointer.inspect()==B.inspect())){return }this._lastPointer=B;this.activeDraggable.updateDrag(A,B)},endDrag:function(A){if(this._timeout){clearTimeout(this._timeout);this._timeout=null}if(!this.activeDraggable){return }this._lastPointer=null;this.activeDraggable.endDrag(A);this.activeDraggable=null},keyPress:function(A){if(this.activeDraggable){this.activeDraggable.keyPress(A)}},addObserver:function(A){this.observers.push(A);this._cacheObserverCallbacks()},removeObserver:function(A){this.observers=this.observers.reject(function(B){return B.element==A});this._cacheObserverCallbacks()},notify:function(B,A,C){if(this[B+"Count"]>0){this.observers.each(function(D){if(D[B]){D[B](B,A,C)}})}if(A.options[B]){A.options[B](A,C)}},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(A){Draggables[A+"Count"]=Draggables.observers.select(function(B){return B[A]}).length})}};var Draggable=Class.create({initialize:function(B){var C={handle:false,reverteffect:function(F,E,D){var G=Math.sqrt(Math.abs(E^2)+Math.abs(D^2))*0.02;new Effect.Move(F,{x:-D,y:-E,duration:G,queue:{scope:"_draggable",position:"end"}})},endeffect:function(E){var D=Object.isNumber(E._opacity)?E._opacity:1;new Effect.Opacity(E,{duration:0.2,from:0.7,to:D,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[E]=false}})},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect)){Object.extend(C,{starteffect:function(D){D._opacity=Element.getOpacity(D);Draggable._dragging[D]=true;new Effect.Opacity(D,{duration:0.2,from:D._opacity,to:0.7})}})}var A=Object.extend(C,arguments[1]||{});this.element=$(B);if(A.handle&&Object.isString(A.handle)){this.handle=this.element.down("."+A.handle,0)}if(!this.handle){this.handle=$(A.handle)}if(!this.handle){this.handle=this.element}if(A.scroll&&!A.scroll.scrollTo&&!A.scroll.outerHTML){A.scroll=$(A.scroll);this._isScrollChild=Element.childOf(this.element,A.scroll)}Element.makePositioned(this.element);this.options=A;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this)},currentDelta:function(){return([parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")])},initDrag:function(A){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element]){return }if(Event.isLeftClick(A)){var C=Event.element(A);if((tag_name=C.tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA")){return }var B=[Event.pointerX(A),Event.pointerY(A)];var D=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(E){return(B[E]-D[E])});Draggables.activate(this);Event.stop(A)}},startDrag:function(B){this.dragging=true;if(!this.delta){this.delta=this.currentDelta()}if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex}if(this.options.ghosting){this._clone=this.element.cloneNode(true);this.element._originallyAbsolute=(this.element.getStyle("position")=="absolute");if(!this.element._originallyAbsolute){Position.absolutize(this.element)}this.element.parentNode.insertBefore(this._clone,this.element)}if(this.options.scroll){if(this.options.scroll==window){var A=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=A.left;this.originalScrollTop=A.top}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop}}Draggables.notify("onStart",this,B);if(this.options.starteffect){this.options.starteffect(this.element)}},updateDrag:function(event,pointer){if(!this.dragging){this.startDrag(event)}if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element)}Draggables.notify("onDrag",this,event);this.draw(pointer);if(this.options.change){this.options.change(this)}if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height]}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight)}var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity)}if(pointer[1]<(p[1]+this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity)}if(pointer[0]>(p[2]-this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity)}if(pointer[1]>(p[3]-this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity)}this.startScrolling(speed)}if(Prototype.Browser.WebKit){window.scrollBy(0,0)}Event.stop(event)},finishDrag:function(B,E){this.dragging=false;if(this.options.quiet){Position.prepare();var D=[Event.pointerX(B),Event.pointerY(B)];Droppables.show(D,this.element)}if(this.options.ghosting){if(!this.element._originallyAbsolute){Position.relativize(this.element)}delete this.element._originallyAbsolute;Element.remove(this._clone);this._clone=null}var F=false;if(E){F=Droppables.fire(B,this.element);if(!F){F=false}}if(F&&this.options.onDropped){this.options.onDropped(this.element)}Draggables.notify("onEnd",this,B);var A=this.options.revert;if(A&&Object.isFunction(A)){A=A(this.element)}var C=this.currentDelta();if(A&&this.options.reverteffect){if(F==0||A!="failure"){this.options.reverteffect(this.element,C[1]-this.delta[1],C[0]-this.delta[0])}}else{this.delta=C}if(this.options.zindex){this.element.style.zIndex=this.originalZ}if(this.options.endeffect){this.options.endeffect(this.element)}Draggables.deactivate(this);Droppables.reset()},keyPress:function(A){if(A.keyCode!=Event.KEY_ESC){return }this.finishDrag(A,false);Event.stop(A)},endDrag:function(A){if(!this.dragging){return }this.stopScrolling();this.finishDrag(A,true);Event.stop(A)},draw:function(A){var F=Position.cumulativeOffset(this.element);if(this.options.ghosting){var C=Position.realOffset(this.element);F[0]+=C[0]-Position.deltaX;F[1]+=C[1]-Position.deltaY}var E=this.currentDelta();F[0]-=E[0];F[1]-=E[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){F[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;F[1]-=this.options.scroll.scrollTop-this.originalScrollTop}var D=[0,1].map(function(G){return(A[G]-F[G]-this.offset[G])}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){D=this.options.snap(D[0],D[1],this)}else{if(Object.isArray(this.options.snap)){D=D.map(function(G,H){return(G/this.options.snap[H]).round()*this.options.snap[H]}.bind(this))}else{D=D.map(function(G){return(G/this.options.snap).round()*this.options.snap}.bind(this))}}}var B=this.element.style;if((!this.options.constraint)||(this.options.constraint=="horizontal")){B.left=D[0]+"px"}if((!this.options.constraint)||(this.options.constraint=="vertical")){B.top=D[1]+"px"}if(B.visibility=="hidden"){B.visibility=""}},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null}},startScrolling:function(A){if(!(A[0]||A[1])){return }this.scrollSpeed=[A[0]*this.options.scrollSpeed,A[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10)},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0){Draggables._lastScrollPointer[0]=0}if(Draggables._lastScrollPointer[1]<0){Draggables._lastScrollPointer[1]=0}this.draw(Draggables._lastScrollPointer)}if(this.options.change){this.options.change(this)}},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}return{top:T,left:L,width:W,height:H}}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(B,A){this.element=$(B);this.observer=A;this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element)){this.observer(this.element)}}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(A){while(A.tagName.toUpperCase()!="BODY"){if(A.id&&Sortable.sortables[A.id]){return A}A=A.parentNode}},options:function(A){A=Sortable._findRootElement($(A));if(!A){return }return Sortable.sortables[A.id]},destroy:function(A){var B=Sortable.options(A);if(B){Draggables.removeObserver(B.element);B.droppables.each(function(C){Droppables.remove(C)});B.draggables.invoke("destroy");delete Sortable.sortables[B.element.id]}},create:function(C){C=$(C);var B=Object.extend({element:C,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:C,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(C);var A={revert:true,quiet:B.quiet,scroll:B.scroll,scrollSpeed:B.scrollSpeed,scrollSensitivity:B.scrollSensitivity,delay:B.delay,ghosting:B.ghosting,constraint:B.constraint,handle:B.handle};if(B.starteffect){A.starteffect=B.starteffect}if(B.reverteffect){A.reverteffect=B.reverteffect}else{if(B.ghosting){A.reverteffect=function(F){F.style.top=0;F.style.left=0}}}if(B.endeffect){A.endeffect=B.endeffect}if(B.zindex){A.zindex=B.zindex}var D={overlap:B.overlap,containment:B.containment,tree:B.tree,hoverclass:B.hoverclass,onHover:Sortable.onHover};var E={onHover:Sortable.onEmptyHover,overlap:B.overlap,containment:B.containment,hoverclass:B.hoverclass};Element.cleanWhitespace(C);B.draggables=[];B.droppables=[];if(B.dropOnEmpty||B.tree){Droppables.add(C,E);B.droppables.push(C)}(B.elements||this.findElements(C,B)||[]).each(function(H,F){var G=B.handles?$(B.handles[F]):(B.handle?$(H).select("."+B.handle)[0]:H);B.draggables.push(new Draggable(H,Object.extend(A,{handle:G})));Droppables.add(H,D);if(B.tree){H.treeNode=C}B.droppables.push(H)});if(B.tree){(Sortable.findTreeElements(C,B)||[]).each(function(F){Droppables.add(F,E);F.treeNode=C;B.droppables.push(F)})}this.sortables[C.id]=B;Draggables.addObserver(new SortableObserver(C,B.onUpdate))},findElements:function(B,A){return Element.findChildren(B,A.only,A.tree?true:false,A.tag)},findTreeElements:function(B,A){return Element.findChildren(B,A.only,A.tree?true:false,A.treeTag)},onHover:function(E,D,A){if(Element.isParent(D,E)){return }if(A>0.33&&A<0.66&&Sortable.options(D).tree){return }else{if(A>0.5){Sortable.mark(D,"before");if(D.previousSibling!=E){var B=E.parentNode;E.style.visibility="hidden";D.parentNode.insertBefore(E,D);if(D.parentNode!=B){Sortable.options(B).onChange(E)}Sortable.options(D.parentNode).onChange(E)}}else{Sortable.mark(D,"after");var C=D.nextSibling||null;if(C!=E){var B=E.parentNode;E.style.visibility="hidden";D.parentNode.insertBefore(E,C);if(D.parentNode!=B){Sortable.options(B).onChange(E)}Sortable.options(D.parentNode).onChange(E)}}}},onEmptyHover:function(E,G,H){var I=E.parentNode;var A=Sortable.options(G);if(!Element.isParent(G,E)){var F;var C=Sortable.findElements(G,{tag:A.tag,only:A.only});var B=null;if(C){var D=Element.offsetSize(G,A.overlap)*(1-H);for(F=0;F<C.length;F+=1){if(D-Element.offsetSize(C[F],A.overlap)>=0){D-=Element.offsetSize(C[F],A.overlap)}else{if(D-(Element.offsetSize(C[F],A.overlap)/2)>=0){B=F+1<C.length?C[F+1]:null;break}else{B=C[F];break}}}}G.insertBefore(E,B);Sortable.options(I).onChange(E);A.onChange(E)}},unmark:function(){if(Sortable._marker){Sortable._marker.hide()}},mark:function(B,A){var D=Sortable.options(B.parentNode);if(D&&!D.ghosting){return }if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker)}var C=Position.cumulativeOffset(B);Sortable._marker.setStyle({left:C[0]+"px",top:C[1]+"px"});if(A=="after"){if(D.overlap=="horizontal"){Sortable._marker.setStyle({left:(C[0]+B.clientWidth)+"px"})}else{Sortable._marker.setStyle({top:(C[1]+B.clientHeight)+"px"})}}Sortable._marker.show()},_tree:function(E,B,F){var D=Sortable.findElements(E,B)||[];for(var C=0;C<D.length;++C){var A=D[C].id.match(B.format);if(!A){continue}var G={id:encodeURIComponent(A?A[1]:null),element:E,parent:F,children:[],position:F.children.length,container:$(D[C]).down(B.treeTag)};if(G.container){this._tree(G.container,B,G)}F.children.push(G)}return F},tree:function(D){D=$(D);var C=this.options(D);var B=Object.extend({tag:C.tag,treeTag:C.treeTag,only:C.only,name:D.id,format:C.format},arguments[1]||{});var A={id:null,parent:null,children:[],container:D,position:0};return Sortable._tree(D,B,A)},_constructIndex:function(B){var A="";do{if(B.id){A="["+B.position+"]"+A}}while((B=B.parent)!=null);return A},sequence:function(B){B=$(B);var A=Object.extend(this.options(B),arguments[1]||{});return $(this.findElements(B,A)||[]).map(function(C){return C.id.match(A.format)?C.id.match(A.format)[1]:""})},setSequence:function(B,C){B=$(B);var A=Object.extend(this.options(B),arguments[2]||{});var D={};this.findElements(B,A).each(function(E){if(E.id.match(A.format)){D[E.id.match(A.format)[1]]=[E,E.parentNode]}E.parentNode.removeChild(E)});C.each(function(E){var F=D[E];if(F){F[1].appendChild(F[0]);delete D[E]}})},serialize:function(C){C=$(C);var B=Object.extend(Sortable.options(C),arguments[1]||{});var A=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:C.id);if(B.tree){return Sortable.tree(C,arguments[1]).children.map(function(D){return[A+Sortable._constructIndex(D)+"[id]="+encodeURIComponent(D.id)].concat(D.children.map(arguments.callee))}).flatten().join("&")}else{return Sortable.sequence(C,arguments[1]).map(function(D){return A+"[]="+encodeURIComponent(D)}).join("&")}}};Element.isParent=function(B,A){if(!B.parentNode||B==A){return false}if(B.parentNode==A){return true}return Element.isParent(B.parentNode,A)};Element.findChildren=function(D,B,A,C){if(!D.hasChildNodes()){return null}C=C.toUpperCase();if(B){B=[B].flatten()}var E=[];$A(D.childNodes).each(function(G){if(G.tagName&&G.tagName.toUpperCase()==C&&(!B||(Element.classNames(G).detect(function(H){return B.include(H)})))){E.push(G)}if(A){var F=Element.findChildren(G,B,A,C);if(F){E.push(F)}}});return(E.length>0?E.flatten():[])};Element.offsetSize=function(A,B){return A["offset"+((B=="vertical"||B=="height")?"Height":"Width")]};var DM_Pngfix={blank:"/images/transparent.gif",rules:{"* html img.png":function(A){if(A.fixed!=null){return }var B=A.src;A.fixed=true;A.style.backgroundImage="none";A.style.width=A.width+"px";A.style.height=A.height+"px";A.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+B+"', sizingMethod='scale')";A.src=DM_Pngfix.blank}},initialize:function(){Event.onDOMReady(function(){var B=navigator.appVersion.split("MSIE");var A=parseFloat(B[1]);if(!(A<=6&&(document.body.filters))){return }EventSelectors.start(DM_Pngfix.rules)})}};DM_Pngfix.initialize();var DM_WidgetV3={rules:{"a.with_urlback, div.with_urlback a":function(A){A.href+=A.href.querySeparator()+"urlback="+extractUriPath()},"form.with_urlback, div.with_urlback form":function(A){A.action+=A.action.querySeparator()+"urlback="+extractUriPath()}},addCss:function(A){var B=document.createElement("link");B.setAttribute("href",A);B.setAttribute("rel","stylesheet");$$("head").shift().appendChild(B)},addScript:function(A){var B=document.createElement("script");B.setAttribute("type","text/javascript");B.setAttribute("src",A);$$("head")[0].appendChild(B)},getClassFromUrl:function(B){var A=B.replace(/\/pageitem\//,".dmpi_");A=A.replace(/\//,"_");return A},getUrlFromClass:function(B){var A=B.replace(/\.dmpi_/,"/pageitem/");A=A.replace(/_/,"/");return A},reloadUsesAuth:function(){document.location.reload();return ;var A=$$(".uses_auth");if(A.size()>=5){document.location.reload()}else{}},findClass:function(A){return"."+A.className.match(/dmpi_[a-z_]+/)},reload:function(A,B){var C=DM_WidgetV3.findClass($$(A).shift());if(!B){B=Request.getRequestURI()}DM_WidgetV3.get(DM_WidgetV3.getUrlFromClass(C),A,B)},get:function(C,A,B){if(!B){B=Request.getRequestURI()}new Ajax.Request(C,{method:"get",parameters:{dispatch:1,request:B},onComplete:function(E){var D=$$(A).shift();D.replace(E.responseText);var F=$$(A).shift();DM_Ajax.ajaxify(F)}})},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_WidgetV3.rules)})}};DM_WidgetV3.initialize();var DM_WidgetV3_Page={rules:{"div#content div.dmpi_box_verticalmenu div.menu_box div.content_right":function(D){var C=$$("div#content div.dmpi_box_verticalmenu div.box_no_corner_left div.content_right").first();var G=D.getHeight();var F=C.getHeight();var E=parseInt(C.getStyle("padding-top"))+parseInt(C.getStyle("padding-bottom"));var B=parseInt(D.getStyle("padding-top"))+parseInt(D.getStyle("padding-bottom"));if(G+B>F+E){var A=G+B}else{var A=F+E}A+=50;D.setStyle({"height":(A-B)+"px"});C.setStyle({"height":(A-E)+"px"})}},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_WidgetV3_Page.rules)})}};DM_WidgetV3_Page.initialize();var DM_Widget_Component_LocaleSelector={rules:{"div.dmco_localeselector div.available_locales a.dmco_flag":function(A){A.onclick=function(){var B=Element.findParamInClass(A,"country");var C=Element.findParamInClass(A,"language");DM_Widget_Component_LocaleSelector.changeLocale(C,B);return false}}},changeLocale:function(B,A){if(A){B=B+"_"+A.toUpperCase()}setCookie("lang",B,365);ajax_call("locale","switch_to",location.href,B,function(C){location.href=C.split("#")[0]})},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_Component_LocaleSelector.rules)})}};DM_Widget_Component_LocaleSelector.initialize();var DM_Form_Inputs={inputs:new Hash({}),getInstance:function(B,A){if(typeof this.inputs.get(B)=="undefined"){this.inputs.set(B,new Hash({}))}if(typeof this.inputs.get(B).get(A)=="undefined"){this.inputs.get(B).set(A,new DM_Form_Input(B,A))}return this.inputs.get(B).get(A)}};var DM_Form_Input=Class.create({initialize:function(C,A){this.form=C;this.name=A;this.inputs=C.getInputByName(A);var B=this.getRealInput();if(B.findParamInClass("rule_visible")){this.visibility()}return this},visibility:function(){var B=this.getRealInput();var A=B.findParamInClass("rule_visible");try{var E=/(.*)\-(.*)/;var F=E.exec(A);if(F){var C=F[1];var H=F[2];var J=H.split("?");if(J){var I=$A(J);B=($(B.getAttribute("id")+"_cont")||B);var K=false;if(C==this.name){var G=this}else{var G=DM_Form_Inputs.getInstance(this.form,C)}G.observe("change",function(L){L.element().fire("form:valueChanged")});G.observe("form:valueChanged",(function(N){var M=false;var L=N.element();if(((L.readAttribute("type")=="radio"||L.readAttribute("type")=="checkbox")&&L.checked&&I.indexOf(L.getValue())>=0)||(L.readAttribute("type")!="radio"&&L.readAttribute("type")!="checkbox"&&I.indexOf(L.getValue())>=0)){this.visible=true;$(B).show();M=true;return }if(!M){this.visible=false;$(B).hide()}}).bind(this));G.fire("form:valueChanged")}}}catch(D){dbg("error "+D)}return false},observe:function(A,B){this.inputs.each(function(C){C.observe(A,B)})},fire:function(A){this.inputs.each(function(B){B.fire(A)})},validate:function(){var result=true;var hintResult=true;var f=this.inputs[this.inputs.length-1];var rules=$w(f.className).select(function(className){return className.startsWith("rule_")});var hints=$w(f.className).select(function(className){return className.startsWith("hint_")});var visibilityRule=rules.find(function(className){return className.startsWith("rule_visible","")});var visible=true;if(visibilityRule){visible=this.visible}if(visible){rules.find((function(cl){if(result==true){try{cl=cl.sub("rule_","");var pos;if((pos=cl.indexOf("-"))>-1){var ruleName=cl.slice(0,pos);var ruleParams=cl.slice(pos+1);if(!cl.slice(0,pos).startsWith("visible")){result=eval("DM_Form_Validator."+ruleName+"( '"+escape(this.getFilteredValue())+"', '"+ruleParams+"')")}}else{var ruleName=cl;var ruleParam="";result=eval("DM_Form_Validator."+cl+"('"+escape(this.getFilteredValue())+"')")}}catch(e){}if(!result&&DM_Form_Validator[this.getFormName()]){this.displayError(DM_Form_Validator[this.getFormName()][this.getName()][ruleName])}}}).bind(this));hints.find((function(cl){if(hintResult==true){try{cl=cl.sub("hint_","");var pos;if((pos=cl.indexOf("-"))>-1){var ruleName=cl.slice(0,pos);var ruleParams=cl.slice(pos+1);if(!cl.slice(0,pos).startsWith("visible")){hintResult=eval("DM_Form_Validator."+ruleName+"( '"+escape(this.getFilteredValue())+"', '"+ruleParams+"')")}}else{var ruleName=cl;var ruleParam="";hintResult=eval("DM_Form_Validator."+cl+"('"+escape(this.getFilteredValue())+"')")}}catch(e){}if(!hintResult&&DM_Form_Validator[this.getFormName()]){this.displayHint(DM_Form_Validator[this.getFormName()][this.getName()][ruleName])}}}).bind(this))}return result},getFormName:function(){return this.form.getFormName()},getName:function(){return this.getRealInput().name},getValue:function(){if(!this.value){this.value=this.getRawValue()}return this.value},getRawValue:function(){var C=this.inputs.length;var D="";if(C==1){if(this.inputs[0].tagName.toLowerCase()=="input"){D=this.inputs[0].value}else{if(this.inputs[0].tagName.toLowerCase()=="select"){D=this.inputs[0].options[this.input.selectedIndex].value}else{if(this.inputs[0].tagName.toLowerCase()=="textarea"){D=this.inputs[0].value}}}}else{if(C>1&&this.inputs[0].type=="radio"){for(var B=0;B<C;B++){if(this.inputs[B].checked){D=this.inputs[B].value}}}else{if(C>1&&this.inputs[0].type=="checkbox"){var A=[];for(var B=0;B<C;B++){if(this.inputs[B].checked){A.push(this.inputs[B].value)}}D=A}}}return D},reset:function(){delete (this.value);delete (this.filteredValue)},getFilteredValue:function(){if(!this.filteredValue){var filters=$w(this.getRealInput().className).select(function(className){return className.startsWith("filter_")});var value=this.getValue();filters.each(function(filter){filter=filter.sub("filter_","");value=eval("DM_Form_Filter."+filter+"( '"+value.sub("'","'")+"')")});this.filteredValue=value}return this.filteredValue},getRealInput:function(){return this.inputs[this.inputs.length-1]},displayError:function(A){el=new Element("div").update(A).addClassName("error_msg").hide();input=this.getRealInput();realInput=input.next("span.dmco_form_input_info");if(realInput){realInput.insert({after:el})}else{input.insert({after:el})}new Effect.Appear(el)},displayHint:function(A){el=new Element("div").update(A).addClassName("hint_msg").hide();input=this.getRealInput();realInput=input.next("span.dmco_form_input_info");if(realInput){realInput.insert({after:el})}else{input.insert({after:el})}new Effect.Appear(el)}});var DM_Form=Class.create({validate:function(B){this.form.descendants().select(function(D){return D.hasClassName("error_msg")||D.hasClassName("hint_msg")}).invoke("remove");var C=true;this.fieldsToCheck.each(function(D){D.reset();C=D.validate()&&C});if(!C){B.stop();noticeBox=$("notice_box");var A=this.getFormName();if(noticeBox&&DM_Form_Validator[A]&&DM_Form_Validator[A]["error_msg"]){box=new Element("div").addClassName("dmpi_notice dmpi_notice_error").hide();box.update('<div class="notice_message"><div class="dmco_text">'+DM_Form_Validator[A]["error_msg"]+"</div></div>");noticeBox.update(box);new Effect.Appear(box)}}return },getFormName:function(){var A=this.getInputByName("form_name");return A.length>0?A.first().value:"none"},initialize:function(A){this.form=$(A);this.form.observe("submit",this.validate.bindAsEventListener(this));this.fieldsToCheck=[];this.form.getElements().select(function(B){return B.hasClassName("check")}).each((function(B){this.fieldsToCheck.push(DM_Form_Inputs.getInstance(this,B.name))}).bind(this))},getInputByName:function(B){var A=this.form.getElements().findAll(function(C){return(C.name==B)});return A}});var DM_Form_Filter={striptags:function(A){if(Object.isString(A)){A=A.stripTags()}return A}};var DM_Form_Validator={error_msg:[],required:function(A){A=unescape(A);if(!A.blank()){return true}else{return false}},url:function(A){A=unescape(A);return(A.blank()||A.match(/^(http(s)?:\/\/)?[a-z0-9-]+(\.[a-z0-9-]+)*(:[0-9]+)?(\/.*)?$/i))},visible:function(A,B){A=unescape(A)},custom:function(value,params){value=unescape(value);params=params.split("-");try{return eval("DM_Form_Validator."+params[1]+"("+escape(value)+");")}catch(e){}return true},mimetype:function(A){A=unescape(A);return true},filesize:function(A){A=unescape(A);return true},compare:function(A,B){A=unescape(A);return true},stringlength:function(C,D){C=unescape(C);var A=true;D=D.split("-");if(C){for(var B=0;B<D.length;B++){var E=D[B].split(":");if(E[0]=="max"){A=(C.length<=parseInt(E[1]))&&A}else{if(E[0]=="min"){A=(C.length>=parseInt(E[1]))&&A}else{if(E[0]=="equal"){A=(C.length==parseInt(E[1]))&&A}else{}}}}}return A}};var DM_Widget_Form={forms:[],check_checkbox:function(A){if(next=A.next("span")){next.writeAttribute("class",A.checked?"dmco_input_checkbox_checked":"dmco_input_checkbox_unchecked")}return true},check_radio:function(B,A){B.getInputs("radio",A.name).each(function(D){var C=D.checked?"dmco_input_radio_checked":"dmco_input_radio_unchecked";if((next=D.next("span"))&&(!next.hasClassName(C))){next.writeAttribute("class",C)}});return true},rules:{"form":function(A){DM_Widget_Form.forms.push(new DM_Form(A))},"form.form_with_confirm":function(A){A.onsubmit=function(){return confirm(DM_Form[A.getElements().findAll(function(B){return(B.name=="form_name")}).first().value]["confirm"])}},"form div.link_to_post a":function(A){A.onclick=function(){parentForm=A.up("form",0);parentForm.submit();return false}},"textarea.counter":function(B){var C=findParamInClass("count",B);var A=new Element("span",{"class":"dmco_form_input_info"});B.insert({after:A});B.onkeypress=function(){B=$(B);if(B.value.length>C){B.next().addClassName("error_msg")}else{B.next().removeClassName("error_msg")}B.next().update(B.value.length+"/"+C+" characters used")}},"form.form_with_confirm div.link_to_post a":function(A){A.onclick=function(){parentForm=A.up("form",0);if(confirm(DM_Form[parentForm.getElements().findAll(function(B){return(B.name=="form_name")}).first().value]["confirm"])){parentForm.submit()}return false}},"input.switcher":function(A){A.onclick=function(){var B=A.next();if(B.value=="show"){B.value="hide"}else{B.value="show"}B.fire("form:valueChanged")}},"html.safari form.dmco_form div.form_item label.dmco_form_checkbox":function(A){A.onclick=function(){if(input=A.down("input")){input.checked=!input.checked;DM_Widget_Form.check_checkbox(input)}return true}},"form.dmco_form div.form_item label input[type=checkbox]":function(A){el=new Element("span").update("&nbsp;").writeAttribute("class",A.checked?"dmco_input_checkbox_checked":"dmco_input_checkbox_unchecked");A.insert({after:el});A.setStyle({height:"1px",width:"1px",position:"absolute",left:"-9999px"});A.onclick=function(){DM_Widget_Form.check_checkbox(A);return true}},"html.safari form.dmco_form div.form_item div.dmco_form_choice label":function(A){A.observe("click",function(C){var B=C.element();if(input=B.down("input")){input.checked=!input.checked;DM_Widget_Form.check_radio(B.up("form"),input)}return true})},"form.dmco_form div.form_item label input[type=radio]":function(A){el=new Element("span").update("&nbsp;").writeAttribute("class",A.checked?"dmco_input_radio_checked":"dmco_input_radio_unchecked");A.insert({after:el});A.setStyle({height:"1px",width:"1px",position:"absolute",left:"-9999px"});A.onclick=function(){DM_Widget_Form.check_radio(A.up("form"),A);return true}}},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_Form.rules)})},getForm:function(B){B=$(B);var A=B.ancestors();A=A.select(function(C){if(C.tagName=="FORM"){return true}else{return false}});return A[A.length-1]}};DM_Widget_Form.initialize();var DM_Widget_PageItem_Header={enableSubBottomTimeout:true,enableSubBottomEffect:true,subBottomState:"hide",subBottom:null,subBottomTimeout:null,currentSubBottomMenuLabel:null,flagsTimeout:null,flagsElement:null,enableLocalesSelectorEffect:true,availableLocales:null,selectedLocale:null,loginTimer:null,rules:{"#header_search_search":function(A){if(DM_Widget_PageItem_Header.search){A.setValue(DM_Widget_PageItem_Header.search)}},"#header div.sub_bottom":function(A){DM_Widget_PageItem_Header.subBottom=A;A.onmouseover=function(){DM_Widget_PageItem_Header.clearTimeoutSubBottomTimeout()};A.onmouseout=function(){DM_Widget_PageItem_Header.timeoutHideSubBottom()}},"#header div.dmco_localeselector div.available_locales":function(A){DM_Widget_PageItem_Header.availableLocales=A;$("footer").insert({after:A.remove()});A.onmousemove=DM_Widget_PageItem_Header.showAvailableLocale},"#header div.dmco_localeselector div.available_locales a":function(A){A.onmousemove=DM_Widget_PageItem_Header.showAvailableLocale;A.onmouseover=DM_Widget_PageItem_Header.showAvailableLocale},"#header div.dmco_localeselector div.selected_locale":function(A){DM_Widget_PageItem_Header.selectedLocale=A},"#header div.dmco_localeselector div.selected_locale a.dmco_flag":function(A){DM_Widget_PageItem_Header.flagsElement=A;DM_Widget_PageItem_Header.flagsElement.showFlags=false;A.href=location.href;A.onclick=function(){if(!DM_Widget_PageItem_Header.flagsElement.showFlags){DM_Widget_PageItem_Header.showAvailableLocale()}DM_Widget_PageItem_Header.toggleAvailableLocale();return false}},"#header div.sub_bottom div.header_sub_menu_container.selected":function(A){var B=DM_Widget_PageItem_Header.getMenuLabel(A);DM_Widget_PageItem_Header.toggleSubMenuContainer(B,"show");DM_Widget_PageItem_Header.toggleSubBottom("show");DM_Widget_PageItem_Header.currentSubBottomMenuLabel=B},"#header div.bottom ul.header_main_menu li div":function(A){A.onmouseover=function(){var B=DM_Widget_PageItem_Header.getMenuLabel(this);DM_Widget_PageItem_Header.clearTimeoutSubBottomTimeout();if($("header_sub_menu_container:"+B)){if(DM_Widget_PageItem_Header.currentSubBottomMenuLabel!=B){DM_Widget_PageItem_Header.toggleSubMenuContainer(B,"show")}DM_Widget_PageItem_Header.toggleSubBottom("show");DM_Widget_PageItem_Header.currentSubBottomMenuLabel=B}else{DM_Widget_PageItem_Header.toggleSubBottom("hide")}};A.onmouseout=function(){DM_Widget_PageItem_Header.timeoutHideSubBottom()}},"#header div.sub_bottom div.header_sub_menu_more":function(A){A.onclick=function(){var D=DM_Widget_PageItem_Header.getMenuLabel(this);var F=$("header_sub_menu_container:"+D);var C=$("header_sub_menu:"+D);var I=F.getWidth();if(!C.moveInited){var J=C.offsetLeft+15;var E=new Array;E[0]=0;var K=0;var H=0;var G=1;for(i=0;i<C.childNodes.length;i++){if(C.childNodes[i].tagName=="LI"){lastWidth=$(C.childNodes[i]).getWidth();H+=lastWidth;K+=lastWidth;if(lastWidth>18&&K>(I-50)){E[G]=(H-lastWidth);K=0;G++}}}C.lastPosition=0;C.movePosition=0;C.moveStep=E;C.moveInited=true}if(C.movingState!="moving"){C.movePosition++;if(C.movePosition>(C.moveStep.size()-1)){C.movePosition=0;var B=0-C.lastPosition}else{var B=0-(C.moveStep[C.movePosition]-C.moveStep[C.movePosition-1])}new Effect.Move($("header_sub_menu:"+D),{x:B,mode:"relative",duration:1.2,beforeStart:function(){$("header_sub_menu:"+D).movingState="moving"},afterFinish:function(){C.lastPosition+=B;$("header_sub_menu:"+D).movingState="moved"}});return false}}}},toggleAvailableLocale:function(){var A=DM_Widget_PageItem_Header.flagsElement;if(A.showFlags=="running"){return }if(!A.showFlags){A.showFlags="running";if(DM_Widget_PageItem_Header.enableLocalesSelectorEffect){new Effect.Appear(DM_Widget_PageItem_Header.availableLocales,{duration:0.5,afterFinish:function(){DM_Widget_PageItem_Header.flagsElement.showFlags=true}})}else{DM_Widget_PageItem_Header.availableLocales.show();A.showFlags=true}DM_Widget_PageItem_Header.selectedLocale.addClassName("show_flags")}else{A.showFlags="running";if(DM_Widget_PageItem_Header.flagsTimeout!=null){clearTimeout(DM_Widget_PageItem_Header.flagsTimeout);DM_Widget_PageItem_Header.flagsTimeout=null}if(DM_Widget_PageItem_Header.enableLocalesSelectorEffect){new Effect.Fade(DM_Widget_PageItem_Header.availableLocales,{duration:0.3,afterFinish:function(){DM_Widget_PageItem_Header.flagsElement.showFlags=false}})}else{DM_Widget_PageItem_Header.availableLocales.hide();A.showFlags=false}DM_Widget_PageItem_Header.selectedLocale.removeClassName("show_flags")}},showAvailableLocale:function(){if(DM_Widget_PageItem_Header.flagsTimeout!=null){clearTimeout(DM_Widget_PageItem_Header.flagsTimeout);DM_Widget_PageItem_Header.flagsTimeout=null}DM_Widget_PageItem_Header.flagsTimeout=setTimeout(DM_Widget_PageItem_Header.toggleAvailableLocale,3500);return false},getMenuLabel:function(A){var C=A.id.split(":");var B=C[1];return B},resetSubMenuMove:function(B){if(B.movingState=="moved"){B.style.left=null;B.style.top=null;B.movingState=null;B.movePosition=0;B.lastPosition=0;try{B.style.position=0}catch(A){}}},toggleSubMenuContainer:function(A,B){if($("header_sub_menu_container:"+A)){var D=$("header_sub_menu_container:"+A);var C=$("header_sub_menu:"+A);DM_Widget_PageItem_Header.resetSubMenuMove(C);if(B=="show"){if(DM_Widget_PageItem_Header.currentSubBottomMenuLabel&&DM_Widget_PageItem_Header.currentSubBottomMenuLabel!=A){DM_Widget_PageItem_Header.toggleSubMenuContainer(DM_Widget_PageItem_Header.currentSubBottomMenuLabel,"hide")}D.show()}else{D.hide()}}DM_Widget_PageItem_Header.toggleSubMenuMoreButton(A,B)},toggleSubMenuMoreButton:function(A,B){if($("header_sub_menu_more:"+A)){var C=$("header_sub_menu_more:"+A);if(B=="show"){C.show()}else{C.hide()}}},toggleSubBottom:function(A){if(A=="show"){DM_Widget_PageItem_Header.subBottomState="show";if(DM_Widget_PageItem_Header.enableSubBottomEffect){new Effect.Appear(DM_Widget_PageItem_Header.subBottom,{duration:0.2})}else{DM_Widget_PageItem_Header.subBottom.show()}}else{if(DM_Widget_PageItem_Header.subBottomState=="show"){DM_Widget_PageItem_Header.subBottomState="hide";if(DM_Widget_PageItem_Header.enableSubBottomEffect){new Effect.Fade(DM_Widget_PageItem_Header.subBottom,{duration:0.5})}else{DM_Widget_PageItem_Header.subBottom.hide()}}}},timeoutHideSubBottom:function(){if(DM_Widget_PageItem_Header.enableSubBottomTimeout){if(DM_Widget_PageItem_Header.subBottomTimeout){DM_Widget_PageItem_Header.clearTimeoutSubBottomTimeout()}DM_Widget_PageItem_Header.subBottomTimeout=setTimeout("DM_Widget_PageItem_Header.toggleSubBottom('hide');",1000)}else{DM_Widget_PageItem_Header.toggleSubBottom("hide")}},clearTimeoutSubBottomTimeout:function(){if(DM_Widget_PageItem_Header.subBottomTimeout){clearTimeout(DM_Widget_PageItem_Header.subBottomTimeout)}},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_PageItem_Header.rules)})}};DM_Widget_PageItem_Header.initialize();var DM_Widget_PageItem_Header_Login={ffLinkInitialized:false,rules:{"form.dmpi_header_login div.open_header_login_form a":function(A){A.onclick=function(){DM_Widget_PageItem_Header_Login.showLoginForm();return false}},"a#family_filter_link":function(A){if(!DM_Widget_PageItem_Header_Login.ffLinkInitialized){A.href=A.href.gsub(/urlback=/,"urlback="+encodeURIComponent(Request.getRequestURI()));DM_Widget_PageItem_Header_Login.ffLinkInitialized=true}},"form.dmpi_header_login .close_header_login_form":function(A){A.onclick=function(){DM_Widget_PageItem_Header_Login.hideLoginForm();return false}},".dmpi_header_login #dmpi_header_login_username, .dmpi_header_login #dmpi_header_login_password":function(A){A.onfocus=function(){DM_Widget_PageItem_Header_Login.stopLoginTimer()};A.onblur=function(){DM_Widget_PageItem_Header_Login.startLoginTimer()}}},startLoginTimer:function(){DM_Widget_PageItem_Header_Login.loginTimer=setTimeout(DM_Widget_PageItem_Header_Login.hideLoginForm,20000)},stopLoginTimer:function(){clearTimeout(DM_Widget_PageItem_Header_Login.loginTimer)},showLoginForm:function(){$("header_login_menu").hide();$("header_search").hide();$("header_login_form").show();DM_Widget_PageItem_Header_Login.startLoginTimer()},hideLoginForm:function(){DM_Widget_PageItem_Header_Login.stopLoginTimer();$("header_login_menu").show();$("header_search").show();$("header_login_form").hide()},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_PageItem_Header_Login.rules)})}};DM_Widget_PageItem_Header_Login.initialize();var DM_Widget_PageItem_Search={defaultValue:null,rules:{"form.dmpi_search input#header_search_search, form.dmpi_search input#search":function(A){DM_Widget_PageItem_Search.defaultValue=A.value;A.onblur=function(){if(A.value==""){A.value=DM_Widget_PageItem_Search.defaultValue}};A.onfocus=function(){if(A.value==DM_Widget_PageItem_Search.defaultValue){A.value=""}}}},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_PageItem_Search.rules)})}};DM_Widget_PageItem_Search.initialize();var DM_Widget_PageItem_Notice={rules:{"div.dmpi_notice":function(A){new Effect.Fade(A,{duration:0.1,from:1,to:0.1,afterFinish:function(B){new Effect.Appear(B.element)}})},"div.dmpi_notice div.close_notice":function(A){A.onclick=function(){new Effect.Fade(A.up("div.dmpi_notice"),{duration:0.4});return false}},"div.dmpi_notice a.set_lang":function(A){A.onclick=function(){if(arg=A.className.match(new RegExp("lang_([a-zA-Z_]+)"))){setCookie("lang",arg[1],500)}return true}}},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_PageItem_Notice.rules)})}};DM_Widget_PageItem_Notice.initialize();var DM_Widget_PageItem_Footer={rules:{"#wrapper":function(A){$("wrapper").setStyle({height:document.viewport.getHeight()+"px"});var B=Position.positionedOffset($("content"))[1]+$("content").getHeight();if(B<(document.viewport.getHeight()-$("footer").getHeight())){B=document.viewport.getHeight()-$("footer").getHeight()}$("footer").setStyle({position:"absolute",top:B+"px"})}},initialize:function(){Event.onDOMReady(function(){EventSelectors.start(DM_Widget_PageItem_Footer.rules)})}};if(typeof (renderStartTime)!="undefined"){Event.observe(window,"load",function(B){var A="http://sense.dailymotion.com/images/vs/tag.gif";var C=new Hash({vs_version:"version",vs_locale:"locale",vs_country:"country",vs_channel:"actionchannel",vs_pagename:"actionpage"});var D=new Hash();D.set("action","timer");D.set("npd",Math.round((new Date()-renderStartTime)/10));if(typeof (vskeys)=="object"){C.each(function(E){if($H(vskeys).get(E.key)!=undefined){D.set(E.value,$H(vskeys).get(E.key))}})}if(typeof (generateTime)!="undefined"){D.set("npa",generateTime)}(new Image()).src=A+"?"+D.toQueryString()})}function cookieSet(A,B,C){d=new Date();d.setTime(d.getTime()+(C*1000));expiry="; expires="+d.toGMTString();document.cookie=A+"="+B+expiry+"; path=/"}function instrument(C){var B;for(B=0;B<C.length;B++){var A={rank:B,call:function(D){var E=location.href.substring((location.href.lastIndexOf("/"))+1);if(E[0]<"0"||E[0]>"9"){E=0}else{E=parseInt(E)-1}cookieSet("rn",""+E+","+this.rank,60)}};Event.observe(C[B],"click",A.call.bindAsEventListener(A))}}function instrumentAction(G,F,D){var C;for(C=0;C<G.length;C++){if(G[C].is_vs_obs){return }var B=vsRedUrl+"log=1&action="+encodeURIComponent(F);if(D=="video"){B+="&video="+encodeURIComponent(vskeys["vs_video"]);B+="&videotitle="+encodeURIComponent(vskeys["vs_videotitle"]);B+="&user="+encodeURIComponent(vskeys["vs_user"]);B+="&usertype="+encodeURIComponent(vskeys["vs_usertype"]);B+="&version="+encodeURIComponent(vskeys["vs_version"]);B+="&actionpage="+encodeURIComponent(vskeys["vs_pagename"]);B+="&spa="+encodeURIComponent(vskeys["vs_spa"])}if(D=="list"){B+="&experience="+encodeURIComponent(vskeys["vs_experience"]);B+="&actionpage="+encodeURIComponent(vskeys["vs_pagename"]);var E="0";if("vs_page" in vskeys){E=vskeys["vs_page"]}B+="&rank="+encodeURIComponent(E+","+C);B+="&version="+encodeURIComponent(vskeys["vs_version"]);B+="&actionchannel="+encodeURIComponent(vskeys["vs_channel"])}var A={url:B,call:function(I){var H=new Ajax.Request(this.url,{method:"get",onComplete:function(J){if(200==J.status){}}})}};Event.observe(G[C],"click",A.call.bindAsEventListener(A));G[C].is_vs_obs=true}}function vsStat(){var G=vskeys;var C=screen;var F=document;if(F.referrer){G["vs_dr"]=F.referrer}G["vs_dh"]=location.href;G["vs_cb"]=new Date().getTime();var E=vsUrl;var D=true;for(cKey in G){if(!D){E+="&"}E+=cKey.substr(3)+"="+encodeURIComponent(G[cKey]);D=false}var B=F.createElement("img");B.src="dailymotion.com_files/tag.gif";B.id="vstag";var A=F.getElementById("vstag");A.parentNode.insertBefore(B,A.nextSibling)}function vsInstrument(){Event.observe(window,"load",function(){instrument($$("div#videos_list div.videoitem_list a.preview"));instrument($$("div#videos_list div.videoitem_list a.video_title"));instrument($$("div.right_boxes div.videoitem_list a.preview"));instrument($$("div.right_boxes div.videoitem_list a.video_title"));instrumentAction($$("div#mc_close"),"ad/close","all");instrumentAction($$("a#dm_toggle_bookmark_link"),"video/bookmark_toggle","video");instrumentAction($$("a.name_blog_post"),"video/blog_post","video");instrumentAction($$("a.name_playlist_add"),"video/playlist_add","video");instrumentAction($$("a.name_social_tools"),"video/social_tools","video");instrumentAction($$("a.name_share"),"video/share","video");instrumentAction($$("a.name_feedback"),"video/feedback","video");instrumentAction($$("div.prevnext_prev"),"video/prev","video");instrumentAction($$("div.prevnext_next"),"video/next","video");instrumentAction($$("div.dm_button"),"video/channel_add","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_featured"),"tabs/featured","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_related"),"tabs/related","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_channel"),"tabs/channel","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_group"),"tabs/group","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_playlist"),"tabs/playlist","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_member"),"tabs/member","video");instrumentAction($$("div.dm_widget_videocontext div#tabs a.tab_video"),"tabs/video","video");if("vs_experience" in vskeys){instrumentAction($$("div#grid_button"),"list/button/v3/grid","list");instrumentAction($$("div#list_button"),"list/button/v3/list","list");instrumentAction($$("div.dmpi_pagination div div.next a.label"),"list/button/v3/nextpage","list");instrumentAction($$("div.dmpi_pagination div div.prev a.label"),"list/button/v3/prevpage","list");instrumentAction($$("div.dm_widget_pagination div.next a.label"),"list/button/v1/nextpage","list");instrumentAction($$("div.dm_widget_pagination div.prev a.label"),"list/button/v1/prevpage","list");instrumentAction($$("div.videos_list img.preview"),"list/result/v1/thumb","list");instrumentAction($$("div.videos_list a.video_title"),"list/result/v1/title","list");instrumentAction($$("div.dmpi_video_preview img.dmco_image"),"list/result/v3/thumb","list");instrumentAction($$("h4.dmco_title"),"list/result/v3/title","list");instrumentAction($$("div.mc_Right1"),"autopromo/1","list");instrumentAction($$("div.mc_Right2"),"autopromo/2","list");instrumentAction($$("div.mc_Right3"),"autopromo/3","list")}})}if(typeof (vskeys)!="undefined"&&$$("img#vstag").length==0){vsStat();vsInstrument();vsContextInstrument=function(){instrumentAction($$("div#contexts div.tab_list_featured a.preview"),"related/featured/preview","video");instrumentAction($$("div#contexts div.tab_list_featured a.video_title"),"related/featured/title","video");instrumentAction($$("div#contexts div.tab_list_related a.preview"),"related/related/preview","video");instrumentAction($$("div#contexts div.tab_list_related a.video_title"),"related/related/title","video");instrumentAction($$("div#contexts div.tab_list_channel a.preview"),"related/channel/preview","video");instrumentAction($$("div#contexts div.tab_list_channel a.video_title"),"related/channel/title","video");instrumentAction($$("div#contexts div.tab_list_group a.group_icon"),"related/group/preview","video");instrumentAction($$("div#contexts div.tab_list_group a.group_name"),"related/group/title","video");instrumentAction($$("div#contexts div.tab_list_playlist div.playlist_preview a"),"related/playlist/preview","video");instrumentAction($$("div#contexts div.tab_list_playlist a.playlist_name"),"related/playlist/title","video");instrumentAction($$("div#contexts div.tab_list_member a.preview"),"related/member/preview","video");instrumentAction($$("div#contexts div.tab_list_member a.video_title"),"related/member/title","video");instrumentAction($$("div#contexts div.tab_list_video a.preview"),"related/video/preview","video");instrumentAction($$("div#contexts div.tab_list_video a.video_title"),"related/video/title","video")};vsContextInstrument()}