var snag=2;F.stewart_event=function(G,u,b){writeDebug("stewart_event div_id:"+G+" pType:"+u+" pItem:"+b);if(_ge(G)){_ge(G).stewart_swf_event(u,b);}};F._stewart_swf_div={swf_path:(_qs_args.yep_branch)?"/apps/video/stewart_"+_qs_args.yep_branch+".swf.v"+new Date().getTime():"/apps/video/stewart.swf.v"+global_stewartVersion,swf_id:"",is_playing:false,was_playing:false,play_tim:null,stewart_swf_event:function(u,b){writeDebug("stewart_swf_event this.id:"+this.id+" pType:"+u+" pItem:"+b);if(u=="isPlayingChanged"){this.is_playing=(b=="true");if(this.is_playing){this.stewart_hide_loading_el();}}if(u=="showingPhotoAtStart"){this.stewart_hide_loading_el();}if(u=="platformReady"){this.stewart_swap_img_out();}},stewart_hide_loading_el:function(){if(_ge(this.loading_el_id)){_ge(this.loading_el_id).style.display="none";}},stewart_swap_img_in:function(){if(_ge(this.swf_id)){_ge(this.swf_id).style.visibility="hidden";}if(_ge(this.img_id)){_ge(this.img_id).style.display="block";}},stewart_swap_img_out:function(){if(_ge(this.swf_id)){_ge(this.swf_id).style.visibility="visible";}if(_ge(this.img_id)){_ge(this.img_id).style.display="none";}},stewart_play_after_pause:function(){var u=_ge(this.id);var b=_ge(this.swf_id);if(this.play_tim){clearTimeout(this.play_tim);}this.play_tim=setTimeout(function(){if(u.stewart_need_to_hide_video){u.stewart_swap_img_out();}if(b&&b.playVideo){u.was_playing=false;b.playVideo();}},200);},stewart_play_if_was_playing:function(){if(this.was_playing){this.stewart_play_after_pause();}else{if(this.stewart_need_to_hide_video){this.stewart_swap_img_out();}}},stewart_pause_if_need_to_hide_video:function(){if(this.stewart_need_to_hide_video){this.stewart_pause();}},stewart_pause:function(){if(this.stewart_need_to_hide_video){this.stewart_swap_img_in();}if(this.play_tim){clearTimeout(this.play_tim);}this.play_tim=null;var u=false;if(!this.is_playing){return ;}u=true;var b=_ge(this.swf_id);if(b&&b.getIsPlaying){u=b.getIsPlaying();if(b.pauseVideo){b.pauseVideo();}}this.was_playing=u;},stewart_go_go_go:function(g,c,I,C,u){F.eb_add(this);this.loading_el_id=this.id.replace("_div","_loading_el");this.img_id=this.id.replace("_div","_img");this.swf_id=this.id.replace("_div","");this.form_id=this.id.replace("_div","_form");this.wait=C;var Z=(navigator.appVersion.toLowerCase().indexOf("mac")>0);this.stewart_need_to_hide_video=(!F.is_safari&&!(F.is_ff3&&Z));this.flash_version=deconcept.SWFObjectUtil.getPlayerVersion();if(_qs_args.noflash){this.flash_version.major=0;}writeDebug("Flash:"+this.flash_version.major+"."+this.flash_version.minor+"r"+this.flash_version.rev);this.w=g.toString();this.h=c.toString();this.thumb_src=u;this.init_ob=I;this.stewart_make_sure_we_have_thumb_src();this.style.position="relative";if(_ge(this.form_id)){this.stewart_add_form();}var M=this.id;if(this.wait){if(this.stewart_is_flash_good()){var b=this.id.replace("_div","_trigger_a");var B=_ge(b);if(B){B.onclick=function(){if(_ge(M)&&_ge(M).stewart_write){_ge(M).stewart_write();return false;}};}var s=this.id.replace("_div","_big_trigger_a");var d=_ge(s);if(d){d.onclick=B.onclick;}}}else{if(Y.U.Dom.hasClass(this,"photo_gne_video_wrapper_div")){this.style.backgroundColor="black";}if(this.stewart_is_flash_good()){var E=0;if(!window.video_has_had_focus){E=1;}if(F.is_safari){E=0;}var E=0;if(E){var G=document.createElement("IMG");G.id="stewart_temp_jpg";G.src=this.thumb_src;G.width=this.w;G.height=this.h;G.style.position="absolute";G.style.display="block";this.appendChild(G);var G=document.createElement("IMG");G.id="stewart_play_button";G.src="video_play_icon_large.png";G.width=40;G.height=22;G.style.position="absolute";G.style.display="block";G.style.left=Math.round(this.w/2)-Math.round(G.width/2)+"px";G.style.top=Math.round(this.h/2)-Math.round(G.height/2)+"px";this.appendChild(G);window.video_play_on_focus=function(){window.video_has_had_focus=1;Y.U.Event.removeListener(window,"focus",window.video_play_on_focus);_ge(M).stewart_write();};Y.U.Event.addListener(window,"focus",window.video_play_on_focus);}else{this.stewart_write();}}else{if(_ge("photo_gne_flash_notice_div")){_ge("photo_gne_flash_notice_div").style.display="block";}}}},stewart_make_sure_we_have_thumb_src:function(){this.thumb_src=(!this.thumb_src&&global_photos&&global_photos[this.init_ob.photo_id]&&global_photos[this.init_ob.photo_id].video_thumb_src)?global_photos[this.init_ob.photo_id].video_thumb_src:this.thumb_src;},stewart_is_flash_good:function(){if(this.flash_version.major*1<9){return false;}if(this.flash_version.major*1==9&&this.flash_version.minor*1>0){return true;}if(this.flash_version.major*1==9&&this.flash_version.rev*1>=28){return true;}if(this.flash_version.major*1==10){return true;}return false;},stewart_write:function(C){if(this.stewart_wrote&&!C){return ;}var s=new SWFObject(this.swf_path,this.swf_id,this.w,this.h,9,"#000000");s.addParam("allowFullScreen","true");s.addParam("allowScriptAccess","always");s.addParam("bgcolor","#000000");s.addVariable("intl_lang",global_intl_lang);s.addVariable("div_id",this.id);s.addVariable("flickr_notracking","true");s.addVariable("flickr_target","_self");s.addVariable("flickr_h",this.h);s.addVariable("flickr_w",this.w);s.addVariable("flickr_no_logo","true");if(0&&this.init_ob.flickr_noAutoPlay!="true"&&!window.already_auto_played){writeDebug("AP PAUSE");this.init_ob.flickr_noAutoPlay="true";window.auto_play_this_id=this.id;}var M=F.get_hash();if(M&&M.indexOf&&M.indexOf("comment")==0){this.init_ob.flickr_noAutoPlay="true";}for(var c in this.init_ob){if(this.init_ob[c]==undefined){continue;}if(this.init_ob[c]==null){continue;}s.addVariable(c,this.init_ob[c]);}if(_qs_args.doSmall!="0"){s.addVariable("flickr_doSmall","true");}else{s.addVariable("flickr_doSmall","false");}if(_qs_args.flv){s.addVariable("flickr_flv",_qs_args.flv);}if(_qs_args.noLimit=="1"){s.addVariable("flickr_noLimit","true");}if(_qs_args.debugPos=="1"){s.addVariable("flickr_debugPos","true");}if(_qs_args.use_debugswf=="1"){s.addVariable("use_debugswf","true");}if(_qs_args.noBuffer=="1"){s.addVariable("flickr_noBuffer","true");}if(this.init_ob.onsite){var u=document.createElement("DIV");u.id=this.loading_el_id;u.className="loading_el";u.innerHTML=F.output.get("loading");if(Y.U.Dom.getStyle(this.parentNode,"position")!="absolute"){this.parentNode.style.position="relative";}this.parentNode.appendChild(u);if(this.parentNode.offsetWidth&&!Y.U.Dom.hasClass(this,"photo_gne_video_wrapper_div")&&!Y.U.Dom.hasClass(this,"pc_l")&&!Y.U.Dom.hasClass(this,"bbml_img")){var b=Math.round(this.parentNode.offsetWidth/2)-Math.round(u.offsetWidth/2);}else{var b=Math.round(this.w/2)-Math.round(u.offsetWidth/2);}var B=Math.round(this.h/2)-Math.round(u.offsetHeight/2);u.style.left=b+"px";u.style.top=B+"px";}if(this.wait){var G=this;setTimeout(function(){G.stewart_actually_write(s);},100);}else{this.stewart_actually_write(s);}this.stewart_wrote=1;return ;},stewart_actually_write:function(u){var b="";this.stewart_make_sure_we_have_thumb_src();if(this.stewart_need_to_hide_video&&this.thumb_src){b="<img style=\"display:none; position:absolute;\" id=\""+this.img_id+"\" width=\""+this.w+"\" height=\""+this.h+"\" src=\""+this.thumb_src+"\">";}if(!u.write(this.id,b)){return ;}if(F.is_ie){this.stewart_swap_img_in();}if(F.is_ie){window[this.swf_id]=_ge(this.swf_id);}writeAPIDebug(this.id+" "+_ge(this.id).innerHTML);},stewart_add_form:function(){var G=this.id;_ge(this.form_id+"_submit").style.display="none";var u=function(){var B=_ge(G);clearTimeout(B.activity_func_tim);B.activity_func_tim=setTimeout(function(){_ge(G).stewart_on_form_activity();},1000);};var b=function(){_ge(G).stewart_on_form_activity();};yui.Event.addListener(_ge(this.form_id+"_show_info_box_cb"),"click",b);yui.Event.addListener(_ge(this.form_id+"_show_info_box_cb"),"change",b);yui.Event.addListener(_ge(this.form_id+"_w_input"),"change",b);yui.Event.addListener(_ge(this.form_id+"_w_input"),"keyup",u);yui.Event.addListener(_ge(this.form_id+"_w_input"),"keydown",u);yui.Event.addListener(_ge(this.form_id+"_h_input"),"change",b);yui.Event.addListener(_ge(this.form_id+"_h_input"),"keyup",u);yui.Event.addListener(_ge(this.form_id+"_h_input"),"keydown",u);if(_ge(this.form_id+"_reset_to_suggested_a")){yui.Event.addListener(_ge(this.form_id+"_reset_to_suggested_a"),"click",function(B){_ge(G).stewart_reset_to_suggested_dims();YAHOO.util.Event.preventDefault(B||window.event);});}if(_ge(this.form_id+"_reset_to_original_a")){yui.Event.addListener(_ge(this.form_id+"_reset_to_original_a"),"click",function(B){_ge(G).stewart_reset_to_original_dims();YAHOO.util.Event.preventDefault(B||window.event);});}if(_ge(this.form_id+"_textarea")){yui.Event.addListener(_ge(this.form_id+"_textarea"),"click",function(C){var B=_get_event_src(C);B.select();});}},stewart_on_form_activity:function(){clearTimeout(this.activity_func_tim);var u=_ge(this.form_id+"_w_input").value;var G=_ge(this.form_id+"_h_input").value;if(isNaN(u)){u=this.w;_ge(this.form_id+"_w_input").value=u;}if(isNaN(G)){G=this.h;_ge(this.form_id+"_h_input").value=G;}var b=(_ge(this.form_id+"_show_info_box_cb").checked)?"true":undefined;if(u!=this.w||G!=this.h||b!=this.init_ob.flickr_show_info_box){writeDebug("w:"+u+" this.w:"+this.w);writeDebug("h:"+G+" this.h:"+this.h);if(G!=this.h){writeDebug("h changed");u=Math.round(this.w*(G/this.h));_ge(this.form_id+"_w_input").value=u;}else{if(u!=this.w){writeDebug("w changed");G=Math.round(this.h*(u/this.w));_ge(this.form_id+"_h_input").value=G;}}writeDebug("w:"+u+" this.w:"+this.w);writeDebug("h:"+G+" this.h:"+this.h);writeDebug("show_info_box:"+b+" this.init_ob.flickr_show_info_box:"+this.init_ob.flickr_show_info_box);this.w=u;this.h=G;this.init_ob.flickr_show_info_box=b;this.stewart_write(1);if(_ge(this.form_id+"_textarea")){_ge(this.form_id+"_textarea").value=F.output.get("loading");this.stewart_load_markup({markup_only:1,id:this.init_ob.photo_id,w:u,h:G,show_info_box:(b=="true")?1:0});}}},stewart_load_markup:function(u){F.fragment_getter.get("/photo_embed.gne",u,this,"stewart_markup_loaded");},stewart_markup_loaded:function(G,u,b){_ge(this.form_id+"_textarea").value=u;},stewart_reset_to_suggested_dims:function(){_ge(this.form_id+"_w_input").value=_ge(this.form_id+"_suggested_w").value;_ge(this.form_id+"_h_input").value=_ge(this.form_id+"_suggested_h").value;this.stewart_on_form_activity();},stewart_reset_to_original_dims:function(){_ge(this.form_id+"_w_input").value=_ge(this.form_id+"_original_w").value;_ge(this.form_id+"_h_input").value=_ge(this.form_id+"_original_h").value;this.stewart_on_form_activity();}};YAHOO.util.Event.on(window,"focus",function(){var u=new Date().getTime();window.video_has_had_focus=1;});F._stewart_poller={start_polling:function(u){if(!u){return ;}this.p_id=u;this.poll();},poll:function(){setTimeout(function(){F.API.callMethod("flickr.photos.getInfo",{photo_id:F._stewart_poller.p_id},F._stewart_poller);},5000);},flickr_photos_getInfo_onLoad:function(C,B,b){if(C&&B){var u=B.documentElement.getElementsByTagName("photo")[0];var G=_upsert_photo(u);writeAPIDebug(_uber_toString(G));if(G.video_ready||G.video_failed){document.location=page_current_url+"?processed=1&cb="+new Date().getTime();return ;}}this.poll();}};