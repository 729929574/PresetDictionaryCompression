String.addMethod("trim",function(){return this.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1")});String.addMethod("collapse",function(){
return this.replace(/\s+/g," ").trim()});Array.addMethod("last",function(){return this.length>0?this[this.length-1]:void 0});
Array.addMethod("remove",function(b){for(var a=this.length-1;a>=0;--a)if(this[a]===b)this.splice(a,1);return this});
Array.addMethod("contains",function(b){for(var a=0;a<this.length;++a)if(this[a]===b)return 1;return 0});(function(){
var a=this,c="string";Function.addMethod("hook",function(d,e){if(d){var f=b();if(!f&&d.addEventListener)d.addEventListener(e,this,false);
else if(!f&&d.attachEvent)d.attachEvent("on"+e,this);else{var c=d["x"+e];if(c&&c.constructor==Array)if(c.contains(this))c=null;else c.push(this);
else c=d["x"+e]=[this];if(c){d["on"+e]=function(d){var f=true;d=a.Event(d);for(var b=0;b<c.length;++b){var e=c[b](d);
if(typeof e!="undefined"&&!e)f=false}return f};d=null}}}return this});Function.addMethod("unhook",function(a,c){if(a){var e=b();
if(!e&&a.removeEventListener)a.removeEventListener(c,this,false);else if(!e&&a.detachEvent)a.detachEvent("on"+c,this);else{var d=a["x"+c];
if(d&&d.constructor==Array)d.remove(this);else a["on"+c]=null}}return this});a.CancelEvent=function(b){b=a.Event(b);if(b){b.cancelBubble=true;
if(b.stopPropagation)b.stopPropagation();b.returnValue=false;if(b.preventDefault)b.preventDefault()}return false};a.Event=function(a){
return a||window.event};a.Target=function(c){c=a.Event(c);var b=c.target||c.srcElement;if(b&&b.nodeType!=1)b=a.ParentElem(b);return b};
a.InnerText=function(b){var d="";if(b)if(typeof b.innerText==c)d=b.innerText;else for(var f=0;f<b.childNodes.length;++f){var e=b.childNodes[f];
switch(e.nodeType){case 1:d+=a.InnerText(e);break;case 3:d+=e.nodeValue;break}}return d};a.NextElem=function(c,b){var a=c.nextSibling;
while(a&&(a.nodeType!=1||b&&a.nodeName!=b))a=a.nextSibling;return a};a.PrevElem=function(c,b){var a=c.previousSibling;
while(a&&(a.nodeType!=1||b&&a.nodeName!=b))a=a.previousSibling;return a};a.ParentElem=function(c,b){var a=c.parentNode;
while(a&&(a.nodeType!=1||b&&a.nodeName!=b))a=a.parentNode;return a};a.ChildElem=function(e,f,g){var d=null,b;
for(var c=0;!d&&c<e.childNodes.length;++c){b=e.childNodes[c];if(b.nodeType==1)if(!f||b.nodeName==f)d=b}
if(!g)for(c=0;!d&&c<e.childNodes.length;++c){b=e.childNodes[c];if(b.nodeType==1)d=a.ChildElem(b,f)}return d};a.ForEach=function(e,d,c){
for(var b=0;b<d.childNodes.length;++b){var a=d.childNodes[b];if(a.nodeType==1&&(!c||a.nodeName==c))if(e(a))break}};a.ChildCount=function(d,c){
var e=0,a,b;for(a=0;a<d.childNodes.length;++a){b=d.childNodes[a];e+=b.nodeType==1&&(!c||b.nodeName==c)?1:0}return e};a.AddClass=function(a,e){
var c=a.className;if(c){var g=c.collapse().split(" "),d=e.collapse().split(" ");for(var b=0;b<d.length;++b){var f=d[b];
if(!g.contains(f))a.className+=" "+f}}else a.className=e;return a.className};a.DelClass=function(b,g){var a=b.className;
if(a){var f=a.collapse().split(" "),d=g.collapse().split(" ");for(var c=0;c<d.length;++c)f.remove(d[c]);var e=f.join(" ");if(e!=a)b.className=e}
return b.className};a.HasClass=function(a,b){return a&&a.className&&a.className.collapse().split(" ").contains(b)};
a.AppendChild=function(a,b){a.appendChild(b);return a};a.SetInnerHtml=function(a,b){a.innerHTML=b};
a.SetAttribute=function(b,a,c){b.setAttribute(a,c)};a.GetAttribute=function(b,a){return b.getAttribute(a)};
a.CreateElement=function(d,a){var b=document.createElement(d);if(typeof a==c)setInnerHtml(b,a);else if(a)appendChild(b,a);return b};
a.Updated=function(){if(a.Access&&typeof a.Access.Updated=="function")a.Access.Updated()};function b(){
return navigator.userAgent.indexOf("Safari")>=0}}).ns("Msn.DOM");(function(){var a=this,c=[];
Function.addMethod("bind",function(b,h){var d;switch(typeof b){
case "object":d=b.nodeType==1||b.nodeType==9?[b]:b.length?b:null;break;case "string":d=a.Select(b);break}
if(d)for(var g=0;g<d.length;++g){var e=d[g],f=new this(e,h);if(e.bindings)e.bindings.push(f);
else e.bindings=[f];c.push(f)}return this});a.Unbind=function(d,f){var b;if(d.bindings&&d.bindings.length){
for(b=0;b<d.bindings.length;++b){var e=d.bindings[b];if(e&&typeof e.dispose=="function")e.dispose();c.remove(e)}d.bindings=null}
if(f)for(b=0;b<d.childNodes.length;++b){var g=d.childNodes[b];if(g.nodeType==1)a.Unbind(g,f)}};
a.Select=function(c){function i(){var d=null;if(c)if(c.charAt(a)=="*")d="*";else while(a<c.length){var b=c.charAt(a);if("a"<=b&&b<="z"||"A"<=b&&b<="Z"||"0"<=b&&b<="9"||b=="-"){d=d?d+b:b;++a}else break}return d}function j(){while(a<c.length&&c.charAt(a)==" ")++a}function m(){var b=null;j();switch(c.charAt(a)){case "+":case ">":b=c.charAt(a);++a;j();break}return b}function h(){++a;return i()}function g(){var b=null,d=i();if(d!==null)b=new e(d);while(c&&a<c.length){var f=c.charAt(a);if(f=="#"){if(!b)b=new e;b.setID(h())}else if(f=="."){if(!b)b=new e;b.addClass(h())}else break}return b}function n(){var d=[],b=g();if(b){d.push(b);while(a<c.length){var e=m();b=g();if(b){if(e)b.setComb(e);d.push(b)}else break}}return d}function e(a){var g=this,e="",f=null,d=null;g.setID=function(a){e=a};g.setComb=function(a){f=a};g.addClass=function(a){if(d)d.push(a);else d=[a]};g.getNodes=function(i){var d,g,j,k=[];if(e){switch(f){case ">":for(d=0;d<i.childNodes.length;++d)if(i.childNodes[d].nodeType==1&&i.childNodes[d].id==e){g=i.childNodes[d];break}break;case "+":j=b(i);if(j&&j.id==e)g=j;break;default:g=i.getElementById(e);break}if(g&&(!a||a=="*"||a.toLowerCase()==g.nodeName.toLowerCase())&&c(g))k.push(g)}else if(a&&a!="*")switch(f){case ">":for(d=0;d<i.childNodes.length;++d){g=i.childNodes[d];if(g.nodeType==1&&g.nodeName.toLowerCase()==a&&c(g))k.push(g)}break;case "+":j=b(i);if(j&&j.nodeName.toLowerCase()==a&&c(j))k.push(j);break;default:var l=i.getElementsByTagName(a);for(d=0;d<l.length;++d)if(c(l[d]))k.push(l[d]);break}else switch(f){case ">":for(d=0;d<i.childNodes.length;++d){g=i.childNodes[d];if(g.nodeType==1&&c(g))k.push(g)}break;case "+":j=b(i);if(j&&c(j))k.push(j);break;default:h(i,k);break}return k};function h(d,e){for(var b=0;b<d.childNodes.length;++b){var a=d.childNodes[b];if(a.nodeType==1){if(c(a))e.push(a);h(a,e)}}}function c(f){var a=1;if(d){var c=f.className;if(c){var e=c.collapse().split(" ");for(var b=0;b<d.length;++b)if(!e.contains(d[b])){a=0;break}}else a=0}return a}}function l(c,d){var a=[];for(var b=0;b<c.length;++b)a=a.concat(d.getNodes(c[b]));return a}var a=0,k=n(),d=[document];for(var f=0;f<k.length&&d.length>0;++f)d=l(d,k[f]);return d};function b(b){var a=b.nextSibling;while(a&&a.nodeType!=1)a=a.nextSibling;return a}(function(){a.Unbind(document,1);c=[]}).hook(window,"unload")}).ns("Msn.Bind");(function(){var e=this,b=document,f=window,c="acciframe",a="blank.aspx",d;e.SetIFrameUrl=function(b){a=b};e.Updated=function(){if(d&&a){var e=b.getElementById(c);if(!e){e=b.createElement("iframe");e.id=e.name=c;e.width=e.height=0;b.body.appendChild(e)}if(e)e.src=a+"?"+(new Date).getTime()}};(function(){d=1}).hook(f,"load")}).ns("Msn.DOM.Access");(function(){this.ArgWithDefault=function(a,b){return typeof a!="undefined"?a:b}}).ns("Msn.Util");(function(){var n="ushpsvr",e="|",h=":",l="ushpcli",g=".",p="ushpwea",m="Q",k="A",c=this,d={},f=0,a={},b=[];function i(){var h=l.GetCookie();if(h){var b=h.split(e);f=b&&b.length>0?parseInt(b[0]):0;for(var c=1;c<b.length;++c){var a=b[c].split(g);d[a[0]]={V:a.length>1?parseInt(a[1]):0,E:a.length>2?parseInt(a[2]):1,D:a.length>3?a[3]:""}}}}function j(){var d=n.GetCookie();if(d){var f=d.split(e);for(var c=0;c<f.length;++c){var b=f[c].split(h);a[b[0]]=b.length>1?b[1]:""}}}function o(){var a=p.GetCookie();if(a)b=a.split(e);else b=[]}c.Settings=function(l){var c,f,e={},h=[],g=0;if(a["D"])e["D"]=a["D"];e["W"]=b?b.length:0;for(c in a){f=parseInt(a[c]);if(f)e[c]=f}for(c in d){var j=d[c];if(j.V){g++;if(j.E)if(c==="H"){f=l;e[c]=f}else{f=parseInt(a[c]);e[c]=f?f:1}else e[c]="C"}else if(e[c])e[c]=""}e[m]=g;var i=Msn.AgTest;if(i)e[k]=i.GetVersion();for(c in e)if(e[c]!=="")h.push(c+e[c]);return h.join(",")};i();j();o();c.C=d;c.H=f;c.W=b;c.S=a}).ns("Msn.HP.State");(function(){var u="ushpsvr",h="|",o=":",t="ushpcli",n=".",v="ushpwea",w=".msn.com",i=3650,k="ushpsvr,ushpcli,ushpwea,mh,CULTURE",s=",",j=60,f="hpovrt",g=Msn.HP.State,b=this,x=document,d=g.C,m=g.H,c=g.S,a=g.W,l=1;b.SetHonorCookie=function(d){if(!f||!j)return;if(!Msn.Page.Themes.ovr){f.SetCookie("");return}var a=0,e=f.GetCookie();if(e){var c=e.split("|");if(c&&c.length>1){var b=c[1].split(":");if(b&&b.length)a=b[1]}}if(l&&a<9){a++;l=0}if(d){var g="h:"+d+"|s:"+a;f.SetCookie(g,j)}};b.ClearCookies=function(){if(k.length){var b=k.split(s);for(var a=0;a<b.length;a++){b[a].SetCookie("",-1);b[a].SetCookie("",-1,w)}}};b.GetModuleData=function(e){var a,b=d[e];if(b){a={};for(var c in b)a[c]=b[c]}else a={V:0,E:1};return a};b.SetModuleData=function(e,b){var a=d[e],c=!a||a.V!=b.V||a.E!=b.E||a.D!=b.D;if(c){m=1;d[e]=b;t.SetCookie(p(),i)}return c};function p(){var b=[m?1:0];for(var a in d)if(a)b.push(q(a,d[a]));return b.join(h)}function q(c,a){var b=[c];b.push(a&&a.V?1:0);b.push(!a||a.E?1:0);if(a&&a.D)b.push(a.D);return b.join(n)}b.GetServerSetting=function(a){return typeof c[a]!="undefined"?c[a]:""};b.SetServerSetting=function(a,b){if(a&&c[a]!=b){c[a]=b;u.SetCookie(r(),i)}};function r(){var b=[];for(var a in c)if(a)b.push(("{0}{2}{1}").format(a,c[a],o));return b.join(h)}b.GetWeatherCodes=function(){return a};b.AddWeatherCode=function(b){if(!a.contains(b)){a.push(b);e()}};b.DelWeatherCode=function(b){if(a.contains(b)){a.remove(b);e()}};b.WeatherUp=function(c){for(var b=1;b<a.length;++b)if(a[b]==c){a[b]=a[b-1];a[b-1]=c;e();break}};b.WeatherDown=function(c){for(var b=a.length-2;b>=0;--b)if(a[b]==c){a[b]=a[b+1];a[b+1]=c;e();break}};function e(){v.SetCookie(a.join(h),i)}b.GetCookie=function(a){return a.GetCookie()};b.SetCookie=function(e,d,a,b,f,c){return e.SetCookie(d,a,b,f,c)}}).ns("Msn.HP.Settings");(function(){var a=this,b=null,d=document,h=Msn.DOM,f=h.AddClass;a.Build=function(m,g,i,h,n,c,e,k,f,j,l){var b=d.getElementById(n);if(b)a.Binding.bind(b,{ver:parseInt(g),width:i,height:h,url:m,allowScriptAccess:c,allowFullScreen:e,base:k,quality:f,wmode:j,flashvars:l})};a.Binding=function(h,a){if(a&&a.url){var i=typeof a.ver=="number"?a.ver:parseInt(a.ver),j=a.height?a.height:170,k=a.width?a.width:363,s=a.url?a.url:"",n=a.allowFullScreen?a.allowFullScreen:"true",m=a.allowScriptAccess?a.allowScriptAccess:"always",r=a.base?a.base:"",p=a.quality?a.quality:"high",q=a.wmode?a.wmode:"transparent",o=a.flashvars?a.flashvars:"";if(!i||i<=g()){var l=('<embed width="{0}" height="{1}" wmode="{2}" quality="{3}" flashvars="{4}" base="{5}" allowfullscreen="{6}" allowscriptaccess="{7}" src="{8}" />').format(k,j,q,p,o,r,n,m,s);if(h)h.innerHTML=l;else d.write(l)}else if(h&&a.dn){var b=c("img");b.width=k;b.height=j;b.src=a.dn;b.alt=a.alt?a.alt:"";if(a.href){b=c("a",b);b.href=a.href;b=c("div",b);f(b,"linkedimg")}h.innerHTML="";e(h,b)}}this.dispose=function(){h=null}};a.Version=function(){return g()};function g(){if(b===null){b=0;var c=window.navigator.plugins,a,d,e;if(c&&c.length){d=c["Shockwave Flash"]||c["Shockwave Flash 2.0"];if(d&&(e=d.description))b=parseInt(e.substring(e.indexOf(".")-2))}else if(window.ActiveXObject)for(a=25;a>2&&!b;--a)try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a);b=a}catch(f){}}return b}a.Module=function(d,k){var g=this,b,i;g.dispose=function(){d=b=0};g.OnExpand=function(){if(!i){a.Binding.bind(b,k);i=1}};function j(){f(d,"flashmod single1 cf");b=c("div");b.className="child c1 first";e(d,b);if(!h.HasClass(d,"closed"))g.OnExpand()}j()};function c(c,a){var b=d.createElement(c);if(a)e(b,a);return b}function e(a,b){a.appendChild(b)}a.SetHeight=function i(c,e){var b=d.getElementById(c);if(b){var a=b.getElementsByTagName("embed");if(a&&a.length)a[0].height=e}}}).ns("Msn.Flash");(function(){var b=this,d=Msn.Async.GetObj,c=0;b.Event=function(e,b,d,f,g,c){if(a())Msn.Tracking.Event(e,b,d,f,g,c)};b.Nav=function(e,b,d,f,g,c){if(a())Msn.Tracking.Navigation(e,b,d,f,g,c)};b.FormBind=function(c,b){if(a())Msn.Tracking.Form.bind(c,b)};function a(){if(!c)c=d("Msn.Tracking");return c}}).ns("Msn.TrackStub");(function(j,b){if(!b)b={};var d=Msn.Util.ArgWithDefault,A=d(b.btn,"Search {0}"),B=d(b.id,"srchfrm"),w=d(b.ftid,"spyft"),q=d(b.focus,1),p=d(b.track,0),t=d(b.spy,0),o=d(b.sf,0),D=d(b.fb,0),F=d(b.dlid,"dl"),C=d(b.dlurl,"http://search.live.com/results.aspx?q="),z=d(b.dlqry,"&mkt=en-us&FORM=MSNHPT"),c=Msn.DOM,i=c.ParentElem,k=c.ChildElem,l=c.HasClass,m=c.ForEach,g=document,n,e,a,h,f={};function v(){e=g.getElementById(B);if(e){y();if(a&&q)s.hook(g,"keydown");m(function(a){if(l(a,"selected"))n=a;var b=k(a,"A");if(b)r.hook(b,"click")},j,"LI");if(a&&o)(function(){a.focus();(function(){var a=Msn.HP.Tb;a?a.Reset():1}).hook(e,"submit").hook(g.getElementById(w),"submit")}).hook(window,"load")}}function y(){var b=k(e,"INPUT");while(b){switch(b.type){case "text":if(!a)a=b;break;case "submit":h=b;break;case "hidden":f[b.name]=b;break}b=c.NextElem(b,"INPUT")}}function r(l){l=c.Event(l);var b=c.Target(l);if(b&&b.nodeName!="A")b=i(b,"A");if(b){var r=i(b,"LI");if(E(r)){var q=b.href;e.action=q;if(h&&!t&&!D)h.value=A.format(c.InnerText(b));var d=q.split("?");if(d.length>1){var m=d[1].split("&"),k={},j,g;for(j=0;j<m.length;++j){d=m[j].split("=");var o=d.length>1?d[1]:"";if(j==m.length-1&&!o)a.name=d[0];else k[d[0]]=o}for(g in k)x(g,k[g]);for(g in f)if(!k[g]){var n=f[g];i(n).removeChild(n);delete f[g]}}}if(a&&a.value){if(p)Msn.TrackStub.Nav(e);e.submit()}else if(a)a.focus()}return c.CancelEvent(l)}function x(b,c){var a=f[b];if(!a){a=g.createElement("input");a.type="hidden";a.name=b;a.value=c;e.appendChild(a);f[b]=a}a.value=c}function E(a){var b=0;m(function(d){if(l(d,"selected")){if(d!=a)c.DelClass(d,"selected")}else if(d==a){c.AddClass(d,"selected");b=1}},j,"LI");return b}function s(d){d=c.Event(d);var e=c.Target(d),b=d.keyCode;if(e!=a&&e.type!="text"&&e.type!=""&&!d.ctrlKey&&!d.altKey&&!d.metaKey&&(47<b&&b<91||95<b&&b<112||185<b&&b<193||218<b&&b<231)){a.value="";a.focus()}}this.dispose=function(){j=n=e=a=h=f=0};function u(){var b=g.getElementById(F);if(b){var a=new Date,d=["January","February","March","April","May","June","July","August","September","October","November","December"][a.getMonth()],e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][a.getDay()],c=a.getDate();b.href=C+d+"+"+c+z;b.innerHTML=e+", "+d+" "+c+", "+a.getFullYear()}}u();v()}).as("Msn.HP.Search");(function(){var e="S",b="N",c="L",m=70,l=82,k="%",o='<style type="text/css">body{font-size:82%}</style>',f=Msn.HP.Settings,g=document,a=this;function d(){var a=f.GetServerSetting(e);return a?a:b}a.C=d;function n(a){g.body.style.fontSize=(a==b?l:m)+k}a.S=n;function j(){if(c==d())g.write(o)}a.F=j;function i(a){var d=a==b?c:b;f.SetServerSetting(e,d)}a.K=i;function h(a){return a==c}a.L=h}).ns("Msn.HP.FontSize");(function(){var p=this,b=Msn.Util.ArgWithDefault,j="D",m=document,n=window,o=Msn.TrackStub.Event,h=Msn.TrackStub.Nav,a=Msn.DOM,c=Msn.HP.Settings,g=[],l="",k;function i(a){return m.getElementById(a)}function e(c,b){return a.AddClass(c,b)}function f(c,b){return a.DelClass(c,b)}function d(c,a){var b=m.createElement(c);if(a)appendChild(b,a);return b}p.Switch=function(p,m){if(!m)m={};var F=b(m.exp,"Display Page Options"),M=b(m.clt,"Close Page Options"),bb=b(m.ctt,"Change color"),ab=b(m.rid,"res"),Y=b(m.cid,"cpw"),y=b(m.cc,"P"),R=b(m.cv,"N,W"),S=b(m.tt,"Page options"),W=b(m.mw,1024),X=b(m.wv,"W"),T=b(m.sr,0),A=b(m.pv,"V"),x=b(m.bgc,""),H=b(m.btc,""),I=b(m.mts,"Make text smaller"),J=b(m.mtl,"Make text larger"),Z=b(m.cfi,"cts"),q,u=a.ChildElem(p,"H3"),B=i(ab),E=i(Y),r,v=Msn.HP.FontSize,w=Msn.Page.Themes;g=w.themes?w.themes:[];k=w.id;l=w.base?w.base:"";p.style.display="block";e(p,"closed");var D=c.GetServerSetting(y),K=c.GetServerSetting(A),G=R.split(",");if(!D){c.SetServerSetting(y,Msn.Page.Width);c.SetServerSetting(A,0);K="0";D=Msn.Page.Width}if(T&&screen.width&&screen.width>=W&&K==="0")c.SetServerSetting(y,X);if(B)(function(b){b=a.Event(b);h(a.Target(b));c.ClearCookies();n.location.reload(false);return a.CancelEvent(b)}).hook(B,"click");if(E)(function(b){b=a.Event(b);h(a.Target(b));c.SetServerSetting(y,D==G[0]?G[1]:G[0]);c.SetServerSetting(A,1);n.location.reload(false);return a.CancelEvent(b)}).hook(E,"click");if(u){q=d("a");var Q=!a.HasClass(p,"closed");q.href="#";q.className="ocb";q.title=Q?M:F;C.hook(q,"click");C.hook(u,"click");u.insertBefore(q,u.firstChild);if(x)u.style.backgroundColor=x;if(H)u.style.color=H}var s=a.ChildElem(p,"UL");if(s){if(s.childNodes.length>0){var N=s.childNodes[s.childNodes.length-1];if(a.HasClass(N,"last"))f(N,"last")}r=d("li");var t=d("a");t.innerHTML=J;var V=v.C();if(v.L(V))t.innerHTML=I;t.id=Z;t.setAttribute("href","#");(function(c){var d=v.C(),b;c=a.Event(c);b=a.Target(c);h(b);v.S(d);v.K(d);if(v.L(d))b.innerHTML=J;else b.innerHTML=I;U();b=0;return a.CancelEvent(c)}).hook(t,"click");r.appendChild(t);s.appendChild(r);r=d("li");e(r,"thm last");var O=d("span");O.innerHTML=bb;r.appendChild(O);s.appendChild(r);if(x)s.style.borderColor=x}var z;if(k&&g.length>0){z=i(k);if(z)if(r)L(r);else L(p)}function U(){var b="closed";if(a.HasClass(p,"open")){e(p,b);f(p,"open");q.title=F}}function C(c){c=a.Event(c);var b="closed";if(a.HasClass(p,"open")){e(p,b);f(p,"open");q.title=F}else{b="open";f(p,"closed");e(p,b);q.title=M;for(var d=0;d<p.bindings.length;++d){var g=p.bindings[d];if(typeof g.OnExpand=="function")g.OnExpand()}}if(!a.Target(c).getAttribute("notrack"))o(q,"",S+" "+b);return a.CancelEvent(c)}function L(e){var c,a;for(c=0;c<g.length;c++){a=g[c];if(a.I&&a.U&&a.T){var b=d("a");b.href=l+a.U;b.id=j+a.I;b.title=a.T;b.setAttribute("notrack",1);b.style.background=a.B;e.appendChild(b);P.hook(b,"click")}}}function P(b){b=a.Event(b);var d=a.Target(b);z.href=d.href;c.SetServerSetting(j,d.id.substring(j.length));c.SetHonorCookie("1");C(b);return a.CancelEvent(b)}this.dispose=function(){p=z=u=q=B=E=s=r=t=null}}}).ns("Msn.HP.Theme");(function(){var a=0,b=0,c=0,d=this;d.enqueue=function(g,f){f=f>=0?f:10;var d={val:g,pri:f,next:0,prev:0},e=c;while(e&&e.pri>f)e=e.prev;if(e){d.prev=e;d.next=e.next;e.next=d;if(d.next)d.next.prev=d;else c=d}else{d.next=a;if(a)a.prev=d;else c=d;a=d}return ++b};d.dequeue=function(){if(a&&b--){var d=a;a=a.next;if(a)a.prev=0;else c=0;d.next=d.prev=0;return d.val}};d.remove=function(e){var d=a;while(b&&d){if(d.val===e){if(d.next)d.next.prev=d.prev;else c=d.prev;if(d.prev)d.prev.next=d.next;else a=d.next;d.next=d.prev=0;--b;break}d=d.next}return b};d.count=function(){return b}}).as("Msn.Queue");(function(){var c=this,b=window,e=new Msn.Queue,d=[],a=null;c.Throttle=5;Function.addMethod("RQ",function(m,j,a,i,h){var k=this;function l(){var f=this,n=0,c=null;f.Pri=a;function o(){if(n){b.clearTimeout(n);n=0}d.remove(f);b.setTimeout(g,1)}f.send=function(){var e=0,d=1;if(!c){c=new XMLHttpRequest;if(c&&typeof c.open!="undefined"){c.onreadystatechange=function(){if(c&&c.readyState==4&&d){d=0;o();l(c);c=null}};if(i)for(var a in i)c.setRequestHeader(a,i[a]);try{c.open(h?"POST":"GET",m,true);c.send(h?h:null)}catch(f){c=null;l(f);b.setTimeout(g,1)}if(c){if(j>0)n=b.setTimeout(p,j);e=1}}else{c=null;l("not supported");b.setTimeout(g,1)}}return e};function p(){f.cancel();l("timeout");c=null}f.cancel=function(){if(!c)e.remove(f);else if(c.readyState!=4){c.abort();c=null;o()}};function l(a){if(!k(a)&&Msn.DOM)Msn.DOM.Updated()}}function g(){while(e.count()>0&&(c.Throttle<=0||d.length<c.Throttle)){var a=e.dequeue();if(a&&a.send())d.push(a)}}a=a>=0?a:10;var f=new l;if(f)if(a&&c.Enabled()){e.enqueue(f,a);b.setTimeout(g,1)}else if(f.send())d.push(f);return f});c.Enabled=function(){if(a===null){var b=new XMLHttpRequest;if(a===null)a=b&&typeof b.open!="undefined"?"native":""}return a};if(typeof XMLHttpRequest=="undefined")XMLHttpRequest=function(){if(a)return new ActiveXObject(a);else if(a===null){var e=navigator.userAgent,d=e.indexOf("MSIE");if(d>=0)if(parseFloat(e.substring(d+4))<5.01){a="";return}var c=["Microsoft.XMLHTTP","MSXML2.XMLHTTP"];for(var b=3;b<=6;++b)c.push(("MSXML2.XMLHTTP.{0}.0").format(b));for(b=c.length-1;b>=0;--b){a=c[b];try{return new ActiveXObject(c[b])}catch(f){a=""}}}}}).ns("Msn.Ajax");(function(){var m=this,c=Msn.DOM,d=Msn.HP.Settings,g=document;m.AddContent=function(C,B,y,z,A,v,D){var n=e(C);if(n&&Msn.Ajax.Enabled()&&v.length>0){var h,r=a("div"),o=a("form"),w=a("ul"),k,g,t,l,u,p,x;c.AddClass(n,z);b(n,a("h2",B));x=c.HasClass(n,D);r.className="child c1 first";b(n,r);o.action="#";b(r,o);if(y)b(o,a("p",y));w.className=A;b(o,w);var q;for(h=0;h<v.length;++h){k=a("li");b(w,k);if(h==0)k.className="first";g=v[h];if(g.id){t="cb_"+g.id;l=a("input");l.type="checkbox";l.id=t;l.value=h;b(k,l);u=a("label",g.name);u.htmlFor=t;b(k,u);q=g.qs;if(q){var m=q.split(":");if(m.length==2&&m[0]&&m[1]&&j(0,m[0])==m[1]){var s=d.GetModuleData(g.code);s.V=1;s.E=1;d.SetModuleData(g.code,s)}}p=d.GetModuleData(g.code);l.checked=p.V?true:false;if(!x)g.pos=h%2+1+","+(Math.floor(h/2)+1);i(l,g);if(p.V)f(g,p.E)}}if(k&&c.PrevElem(k,"LI"))k.className="last"}};function j(b,g){var a;if(!b)a=location.search.substring(1,location.search.length);else a=b.substring(b.indexOf("?",b.length));if(a&&a.length){a=a.replace(/\+/g," ");var e=a.split("&");for(var d=0;d<e.length;d++){var c=e[d].split("=");if(c.length==2){var f=unescape(c[0]);if(f.toLowerCase()==g.toLowerCase())return c[1]}}}return ""}function i(b,a){(function(h){h=c.Event(h);var j=c.Target(h),i=j.checked,g=d.GetModuleData(a.code),b=e(a.id);if(i)if(b)b.style.display="block";else f(a,g.E);else if(b)b.style.display="none";g.V=i?1:0;d.SetModuleData(a.code,g)}).hook(b,"click");b=0}function f(b,i){var g=h(b.bind);if(g){var d=b.pos.split(","),f=e("area"+d[0]);if(f){var a=k(b,d[1],i);if(a){f.insertBefore(a,l(f,d));Msn.HP.ExpandCollapse.bind(a,b.code);g.bind(a,b);if(c.HasClass(a,"closed"))c.Updated()}}}}function l(e,f){var d=null;for(var c=0;c<e.childNodes.length;++c){var b=e.childNodes[c];if(b.nodeType==1){var a=b.getAttribute("priority");a=a?parseInt(a):0;if(a>f[1]){d=b;break}}}return d}function a(c,a){var b=g.createElement(c);if(a)b.innerHTML=a;return b}function b(a,b){a.appendChild(b)}function k(c,h,g){var d=a("div");d.className="parent "+(c.chrome?c.chrome:"chrome5")+(g?"":" closed");d.id=c.id;d.setAttribute("priority",h);var e,f=a("h2");if(c.href){e=a("a");e.href=c.href;e.innerHTML=c.name;b(f,e)}else f.innerHTML=c.name;b(d,f);return d}function h(d){var a=null,b=d?d.split("."):[];if(b.length>0){a=window;for(var c=0;a&&c<b.length;++c)a=a[b[c]]}return a}function e(a){return g.getElementById(a)}}).ns("Msn.HP.Module");(function(a,g){if(!g)g={};var o=Msn.Util.ArgWithDefault(g.gtl,"linklist16"),l="Hide",m="Disambiguator Selection",j=this,k=window,r=document,h=Msn.DOM,e=h.AppendChild,d=h.CreateElement,i,b,c,f=typeof g.close!="undefined"?g.close:l;if(typeof f!="string")f=f?l:0;j.dispose=function(){if(c){k.clearTimeout(c);c=0}a=i=b=0};function q(){if(c)a.style.display="block"}j.msg=function(d,f,e){if(c){k.clearTimeout(c);c=0}if(d){i.innerHTML=d;if(e){a.style.display="none";c=k.setTimeout(q,e)}else a.style.display="block";if(f)a.className="ambi "+f}else a.style.display="none";Msn.Bind.Unbind(b,1);b.innerHTML="";b.style.display="none"};j.add=function(g,c){b.style.display="block";var f=d("li");e(b,f);var a=d("a");a.href=c?c:"#";a.innerHTML=g;if(m)a.setAttribute("piitxt",m);e(f,a);return a};function p(){h.AddClass(a,"ambi");a.style.display="none";if(f){var c=d("a");c.className="del";c.href="#";c.setAttribute("notrack",1);e(a,c);var g=d("div");e(c,g);g.style.visibility="visible";c.title=f;n.hook(c,"click");c=0}i=d("p");e(a,i);b=d("ul");b.className=o;b.style.display="none";e(a,b)}function n(b){b=h.Event(b);a.style.display="none";return h.CancelEvent(b)}p()}).as("Msn.HP.DA");(function(b,e){if(!e)e={};var g=Msn.Util.ArgWithDefault,s=g(e.exp,"expand"),r=g(e.clt,"collapse"),j=g(e.cc,"H"),q=g(e.dv,"open"),u=g(e.tt,"Highlights Module"),i=document,x=Msn.TrackStub.Event,c=Msn.DOM,o=c.HasClass,n=c.AddClass,k=Msn.HP.Settings,p="open",m="closed";if(!o(b,"n")){var v=k.GetServerSetting(j);if(!v){k.SetServerSetting(j,q);n(b,q)}var f=c.ChildElem(b,"H2");if(f){var a=i.createElement("a"),w=!o(b,m);a.href="#";a.className="ocb";a.title=w?r:s;var l=i.createElement("span");l.className="tip";var d=i.createElement("a"),h=i.createTextNode(a.title);d.href="#";d.appendChild(h);l.appendChild(d);t.hook(a,"click");t.hook(d,"click");f.insertBefore(a,f.firstChild);f.insertBefore(l,f.lastChild)}}function t(f){f=c.Event(f);var e=m;if(o(b,p)){n(b,e);c.DelClass(b,p);a.title=s;k.SetServerSetting(j,e)}else{e=p;c.DelClass(b,m);n(b,e);a.title=r;k.SetServerSetting(j,e)}d.removeChild(h);h=i.createTextNode(a.title);d.appendChild(h);if(!c.Target(f).getAttribute("notrack"))x(a,"",u+" "+e);return c.CancelEvent(f)}this.dispose=function(){b=f=a=l=d=h=null}}).as("Msn.HP.High");(function(){var l=this,n=document,m=Msn.HP.Settings,b=Msn.DOM,d=b.ChildElem,k=b.HasClass,i=b.PrevElem,g=b.ParentElem,j=b.AddClass,h=b.DelClass,c=b.CreateElement,e=b.AppendChild;l.Data=function(y,l){if(!l)l={};var u=Msn.Util.ArgWithDefault,Y=u(l.load,"Loading..."),G=u(l.err,"Feed is temporarily unavailable."),cb=u(l.timeout,5000),V=u(l.gtl,"linklist16"),A=u(l.cutoff,5),W=u(l.delay,2000),U=u(l.dsi,"DSI"),S=this,w,r,T,P,q,Q,s,p,o,O=0,v=0,eb="block",x="none",B="ulWImg",L=g(y),E='<img src="{0}" alt="{1}"/>',I='<img src="{0}" alt="{1}" width="{2}" height="{3}"/>',M=l.code?l.code:"",H=l.url?l.url:"",t=l.max?parseInt(l.max):0,N=l.def?parseInt(l.def):0,bb=l.opennew?1:0,C=l.chan?l.chan:0,D=l.disp?l.disp:0,R=l.brfl?l.brfl:"",F;if(l.allhot)F=l.defhref||l.href;var z=l.omit;function K(b){var a=p.firstChild;while(a&&b--){while(a&&(a.nodeType!=1||a.nodeName!="LI"))a=a.nextSibling;if(b)a=a.nextSibling}return a}function J(g,f){var b=n.createTextNode(g);if(f){var a=c("a");a.href=f;if(bb){var d=Msn.HP.OpenNew;if(d)d.bind(a);else a.target="_blank"}b=e(a,b)}return b}function Z(H){var j,E,n,w=d(H,"rss",1),u=w&&d(w,"channel",1);if(w&&u){var m=0,y;b.ForEach(function(k){var n=a(k,"title");if(n){var j=a(k,"link");if(R)if(d(k,"enclosure"))return;if(z&&j==z)return;var l=!j||j=="#",g=J(n,l?F:j),b;if(l)g=e(c("strong"),g);if(++m>v){b=c("li");e(b,g);e(p,b);if(!i(b))b.className="first"}else{b=K(m);h(b,"last");Msn.Bind.Unbind(b.firstChild,1);b.removeChild(b.firstChild);b.appendChild(g)}if(l)b.className="nb";if(o>0&&m>o)f(b,x);if(t>0&&m==t)return 1}},u,"item");if(y&&i(y))y.className="last";t=m;if(!o)o=m;if(o>t)o=t;if(t>=A){s=ab(u);if(s){var l=i(p,"DIV");while(l){if(k(l,"linkedimg"))g(l).removeChild(l);l=i(l,"DIV")}q.insertBefore(s,p);if(o<A){f(s,x);h(p,B)}}}if(D){j=a(w,"msn:displayname",1);if(typeof D=="string")j=j&&D.format(j);if(j){n=c("h4");n.innerHTML=j;q.insertBefore(n,p)}}if(C){j=a(u,"title",1);E=a(u,"link",1);if(typeof C=="string")j=j&&C.format(j);if(j){n=c("h4");e(n,J(j,E));q.insertBefore(n,p)}}if(q)f(q,eb);O=1}else r.msg(G,"err")}function ab(o){var n,i,j,f,m,l,h,e=d(o,"msn:image");if(e){j=a(e,"msn:url");f=a(e,"msn:title");i=a(e,"msn:link");m=a(e,"msn:width");l=a(e,"msn:height");if(m&&l)h=I.format(j,f,m,l);else h=E.format(j,f)}else{e=d(o,"m:image");if(e){j=a(e,"m:url");f=a(e,"m:title");i=a(e,"m:link");m=a(e,"m:width");l=a(e,"m:height");if(m&&l)h=I.format(j,f,m,l);else h=E.format(j,f)}else{e=d(o,"enclosure");if(e){var k=g(e);if(z&&a(k,"link")==z){k=b.NextElem(k,"item");if(k){var p=d(k,"enclosure");if(p)e=p}}j=e.getAttribute("url");f=a(k,"description");if(!f||f.indexOf("\u00A9")==-1)f=a(k,"title");i=a(k,"link");h=E.format(j,f)}}}if(h){n=c("div");if(!i||i=="#")i=F;if(i){n.className="linkedimg";n.innerHTML=('<a href="{0}">').format(i)+h+"</a>"}else n.innerHTML=h}return n}function X(){var a=0,i=1;if(k(L,U))A=t+1;p=d(y,"UL");if(p){o=m.GetServerSetting(M);if(!o)o=N;v=b.ChildCount(p,"LI");if(!o&&v)o=v;q=g(p,"DIV");b.ForEach(function(a){if(d(a,"IMG"))return s=a},q,"DIV");if(t<o)t=o;if(o)if(o<v){b.ForEach(function(a){if(i==o)j(a,"last");else if(i>o){f(a,x);h(a,"last")}++i},p,"LI");if(s&&o<A){f(s,x);h(p,B)}}else a=o>v}else{q=c("div");q.className="imglistset1 cf";e(y,q);f(q,x);p=c("ul");p.className=V;e(q,p);o=m.GetServerSetting(M);if(!o)o=N;a=1}if(s)j(p,B);var l=c("div");e(y,l);r=new Msn.HP.DA(l);if(a)db()}function db(){if(!O&&H){r.msg(Y,"msg",W);if(w)w.cancel();w=(function(a){r.msg();if(a.responseXML)Z(a.responseXML);else r.msg(G,"err");if(!K(o))o=b.ChildCount(p,"LI")}).RQ(H,cb)}else if(!H)r.msg(G,"err")}S.dispose=function(){if(w)w.cancel();if(r)r.dispose();y=w=r=T=P=L=q=s=p=Q=0};X()};l.Module=function(b,h){var d=this,a,f=0;d.dispose=function(){b=a=0};d.OnExpand=function(){if(!f){l.Data.bind(a,h);f=1}};function g(){j(b,"single1 cf");a=c("div");a.className="child c1 first";e(b,a);if(!k(b,"closed"))d.OnExpand()}g()};function a(e,a,c){return b.InnerText(d(e,a,c))}function f(a,b){if(a)a.style.display=b}}).ns("Msn.HP.Rss");(function(){var o=this,p=document,g=Msn.HP.Settings,a=Msn.DOM,c=a.ChildElem,j=a.ParentElem,d=a.AddClass,k=a.DelClass,m=a.Event,i=a.CancelEvent,l=a.HasClass,f=a.AppendChild,e=a.CreateElement,n="undefined";o.Data=function(D,p){if(!p)p={};var u=Msn.Util.ArgWithDefault,kb=u(p.load,"Loading..."),N=u(p.err,"Feed is temporarily unavailable."),mb=u(p.timeout,5000),db=u(p.gtl,"linklist16"),jb=u(p.plus,"Show more headlines"),gb=u(p.minus,"Show fewer headlines"),y=u(p.cutoff,5),eb=u(p.delay,2000),cb=u(p.ahc,"AH"),bb=u(p.dsi,"DSI"),nb=this,x,w,S,R,r,s,q,o,ab=0,z=0,T,v,K="block",C="none",Q="hidden",P="visible",J="div",U="ul",A="LI",X="first",Y="last",E="ulWImg",H=j(D),B=p.code?p.code:"",O=p.url?p.url:"",t=p.max?parseInt(p.max):0,W=p.def?parseInt(p.def):0,ob=B&&(typeof p.pm==n||p.pm)?1:0,I=p.omit;function lb(k){var h=c(k,"feed",1);if(h){var g=c(h,J,1),f=c(h,U,1);if(I){var i=g.childNodes[0],j=G(i);if(j.indexOf(I)!=-1)g.removeChild(i)}while(g.childNodes[1])g.removeChild(g.childNodes[1]);var e=0;a.ForEach(function(b){++e;if(I){var a=f.childNodes[e-1],c=G(a);if(c.indexOf(I)!=-1)f.removeChild(a)}if(o>0&&e>o)b.setAttribute("style","display:none;");if(t>0&&e>t){while(f.childNodes[e-1])f.removeChild(f.childNodes[e-1]);e--;return 1}},f,"li");t=e;if(!o)o=e;if(o>t)o=t;F();r.innerHTML=G(g)+G(f);s=r.firstChild;q=r.lastChild;if(o<y)M(s,q);if(o>=y&&s)d(q,E);T=c(q,A);if(T)d(T,X);if(r)b(r,K);if(w)b(w,K);ab=1}else v.msg(N,"err")}function F(){h(R,o>1?P:Q);h(S,o<t?P:Q)}function L(b){var a=q.firstChild;while(a&&b--){while(a&&(a.nodeType!=1||a.nodeName!=A))a=a.nextSibling;if(b)a=a.nextSibling}return a}function fb(a){a=m(a);if(o>1){b(L(o--),C);if(o==y-1&&s)M(s,q);g.SetServerSetting(B,o)}F();return i(a)}function ib(a){a=m(a);if(o<t){var c=L(++o);if(c){b(c,K);if(o==y&&s){b(s,K);d(q,E)}}else Z();g.SetServerSetting(B,o)}F();return i(a)}function V(b,f,d,c){var a=e("a");a.href="#";a.title=f;a.className=b;a.setAttribute("notrack",1);h(a,c?P:Q);d.hook(a,"click");return a}function hb(){var h=0,m=1;if(l(H,bb))y=t+1;q=c(D,"UL");if(q){d(c(q,A),X);o=g.GetServerSetting(B);if(!o)o=W;z=a.ChildCount(q,A);if(!o&&z)o=z;r=j(q,"DIV");a.ForEach(function(a){if(c(a,"IMG"))return s=a},r,"DIV");if(t<o)t=o;if(o)if(o<z){a.ForEach(function(a){if(m==o)d(a,Y);else if(m>o){b(a,C);k(a,Y)}++m},q,A);if(s&&o<y)M(s,q)}else h=o>z}else{r=e(J);r.className="imglistset1 cf";f(D,r);b(r,C);q=e(U);q.className=db;f(r,q);o=g.GetServerSetting(B);if(!o)o=W;h=1}if(s)d(q,E);if(ob){w=e(J);w.className="pm";f(w,S=V("plus",jb,ib,o<t));f(w,R=V("minus",gb,fb,o>1));if(l(H,cb)){var i=c(H,"H2");i.insertBefore(w,i.firstChild);i=0}if(h&&!z)b(w,C)}var n=e(J);f(D,n);v=new Msn.HP.DA(n);if(h)Z()}function Z(){if(!ab&&O){v.msg(kb,"msg",eb);if(x)x.cancel();x=(function(b){v.msg();if(b.responseXML)lb(b.responseXML);else v.msg(N,"err");if(!L(o))o=a.ChildCount(q,A);F()}).RQ(O,mb)}else if(!O)v.msg(N,"err")}function M(a,c){b(a,C);k(c,E)}function G(a){if(a.xml)return a.xml;else{var b=new XMLSerializer;return b.serializeToString(a)}}nb.dispose=function(){if(x)x.cancel();if(v)v.dispose();D=x=v=S=R=H=r=s=q=w=0};hb()};function b(a,b){if(a)a.style.display=b}function h(a,b){if(a)a.style.visibility=b}}).ns("Msn.HP.Feed");(function(b,e){if(!e)e={};var h=Msn.Util.ArgWithDefault,i=h(e.exp,"Expand module"),g=h(e.col,"Collapse module"),l=this,m=document,c=Msn.DOM,k=Msn.HP.Settings,d=!c.HasClass(b,"closed"),j=e,a,f=c.ChildElem(b,"H2",1);if(f){a=m.createElement("a");a.href="#";a.className="ocb";a.setAttribute("notrack",1);a.title=d?g:i;(function(f){f=c.Event(f);if(d){c.AddClass(b,"closed");a.title=i}else{c.DelClass(b,"closed");a.title=g;for(var e=0;e<b.bindings.length;++e){var l=b.bindings[e];if(typeof l.OnExpand=="function")l.OnExpand()}}d=!d;var h=k.GetModuleData(j);h.E=d?1:0;k.SetModuleData(j,h);return c.CancelEvent(f)}).hook(a,"click");f.insertBefore(a,f.firstChild)}l.dispose=function(){b=f=a=0}}).as("Msn.HP.ExpandCollapse");(function(a){var b=a.value;this.dispose=function(){a=null};if(b){(function(){if(a.value==b){a.value="";a.select()}}).hook(a,"focus");(function(){if(!a.value)a.value=b}).hook(a,"blur")}}).as("Msn.HP.TextBoxHint");(function(){var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],k=["January","February","March","April","May","June","July","August","September","October","November","December"],l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["AM","PM"];function h(b,c){if(!b)b=12;if(b>12)b-=12;return c?a(b):b}function a(b,a){a=a?a:2;var d="",e=Math.pow(10,a-1);while(--a&&b<e){d+="0";e/=10}return d+c(b)}function f(b,f){var d=b<0?"-":"+";b*=b<0?-1:1;var e=c(b/60);if(!f)d+=e;else{d+=a(e);if(f>1)d+=":"+a(b%60)}return d}var g={d:[function(a){return a.getDate()},function(b){return a(b.getDate())},function(a){return l[a.getDay()]},function(a){return m[a.getDay()]}],f:[function(b){return a(e(b)/100,1)},function(b){return a(e(b)/10,2)},function(b){return a(e(b),3)}],h:[function(a){return h(b(a))},function(a){return h(b(a),1)}],H:[function(a){return b(a)},function(c){return a(b(c))}],m:[function(a){return a.getMinutes()},function(b){return a(b.getMinutes())}],M:[function(a){return a.getMonth()+1},function(b){return a(b.getMonth()+1)},function(a){return j[a.getMonth()]},function(a){return k[a.getMonth()]}],s:[function(a){return a.getSeconds()},function(b){return a(b.getSeconds())}],t:[function(a){return i[c(b(a)/12)].charAt(0)},function(a){return i[c(b(a)/12)]}],y:[function(a){return a.getYear()},function(b){return a(b.getYear())},function(a){return a.getFullYear()},function(a){return a.getFullYear()}],z:[function(a){return f(d(a))},function(a){return f(d(a),1)},function(a){return f(d(a),2)}]};function d(a){return a.getTimezoneOffset()}function e(a){return a.getMilliseconds()}function b(a){return a.getHours()}function c(a){return Math.floor(a)}Date.addMethod("format",function(d){var c,f,h,e=[],b="",a=0;for(;a<d.length;++a){c=d.charAt(a);if(c=="\\"){if(++a<d.length)b+=d.charAt(a)}else if(g[c]){if(b){e.push(b);b=""}f=g[c];h=a;while(d.charAt(a+1)==c)++a;e.push(f[Math.min(a-h,f.length-1)](this,a-h+1))}else b+=c}if(b)e.push(b);return e.join("")})}).ns("Msn.DateFormatting");(function(k,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,J=b(a.go,"Go"),D=b(a.load,"Loading..."),p=b(a.err,"Horoscope data is temporarily unavailable."),I=b(a.timeout,5000),L=b(a.delay,2000),K=b(a.durl,"msn.com_files//horoscope.aspx?zodiacsign={0}"),v=b(a.hint,"Select a sign"),s=[{code:"ari",text:"Aries (March 21 - April 19)"},{code:"tau",text:"Taurus (April 20 - May 20)"},{code:"gem",text:"Gemini (May 21 - June 21)"},{code:"can",text:"Cancer (June 22 - July 22)"},{code:"leo",text:"Leo (July 23 - August 22)"},{code:"vir",text:"Virgo (August 23 - September 22)"},{code:"lib",text:"Libra (September 23 - October 22)"},{code:"sco",text:"Scorpio (October 23 - November 21)"},{code:"sag",text:"Sagittarius (November 22 - December 21)"},{code:"cap",text:"Capricorn (December 22 - January 19)"},{code:"aqu",text:"Aquarius (January 20 - February 18)"},{code:"pis",text:"Pisces (February 19 - March 20)"}],B=b(a.dd,"ari"),H=b(a.mtxt,"More..."),C=b(a.red,"http://astrocenter.astrology.msn.com/msn/MyToday.aspx?Af=-1000"),G=b(a.whatnew,"What's New on MSN Astrology"),w=this,M=document,d=Msn.DOM,u=d.InnerText,m=d.ChildElem,g=d.CreateElement,c=d.AppendChild,q=Msn.HP.Settings,j,i,n,e,f,h,r,y="",l="div",x="none",t="err";w.dispose=function(){if(e)e.dispose();if(j)j.cancel();k=i=n=f=h=e=j=0};w.OnExpand=function(){o()};function o(){if(j){j.cancel();j=null}var a=f.value;if(a){var b=document.getElementById("hor_"+a);if(b){if(i!=b){i.style.display=x;b.style.display="block";i=b}}else{e.msg(D,"msg",L);j=(function(b){e.msg();if(b.responseXML){r=b.responseText;if(null!=r){var c=r.split("<ad>");if(c.length>1)y=c[1].split("</ad>")[0]}E(a,b.responseXML)}else e.msg(p,t)}).RQ(K.format(a),I)}}}function E(k,f){var d=m(f,"rss");if(d){var b=m(d,"item");if(b){var j=u(m(b,"title")),h=u(m(b,"description")),g=(new Date).format("MMM dd, yyyy");if(i)i.style.display=x;var a=document.createElement(l);a.id="hor_"+k;a.innerHTML=("<h4>Today's {0} Horoscope: {1}</h4><p>{2} <a href='{3}'>{4}</a></p>").format(j,g,h,C,H);c(n,a);i=a;var o=m(f,"ad");if(o)F()}else e.msg(p,t)}else e.msg(p,t)}function F(){if(!h){d.DelClass(k,"single1");d.AddClass(k,"double2");h=g(l);h.className="child c2 last";c(k,h)}else h.innerHTML="";var a=document.createElement(l);a.innerHTML=("<h4>{0}</h4>{1}").format(G,y);c(h,a)}function A(){var p=q.GetModuleData(a.code),t=p&&p.D?p.D:B;d.AddClass(k,"single1");var i=g(l);i.className="child c1 first";c(k,i);n=g(l);c(i,n);var r=g(l);c(i,r);e=new Msn.HP.DA(r);var b=g("form");b.className="simple1";b.action="#";z.hook(b,"submit");c(i,b);Msn.TrackStub.FormBind(b);f=g("select");if(v){f.title=v;f.id="horosdrpdwn"}c(b,f);var h;for(var m=0;m<s.length;++m){h=g("option");h.value=s[m].code;if(h.value==t)h.selected=true;h.innerHTML=s[m].text;c(f,h)}var j=g("input");j.type="submit";j.className="button";j.value=J;c(b,j);if(!d.HasClass(k,"closed"))o()}function z(c){c=d.Event(c);var b=q.GetModuleData(a.code);if(!b||f.value!=b.D){o();b.D=f.value;q.SetModuleData(a.code,b)}return d.CancelEvent(c)}A()}).as("Msn.HP.Horoscope");(function(j,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,E=b(a.timeout,5000),C=b(a.len,100),F=b(a.go,"Go"),l=b(a.hint,"Get guides by city or ZIP code"),B=b(a.max,15),J=b(a.delay,2000),D=b(a.surl,"msn.com_files//cityGuidesSearch.aspx?ldlocation={0}"),u=b(a.durl,"msn.com_files//cityGuidesDataXDOM.aspx?xml_url=http://cityguides.msn.com/data/hp.aspx?where={0}"),x=b(a.load,"Loading..."),A=b(a.choose,"Possible matches are listed below. Please select a location from the list below or enter a new location in the text box above."),t=b(a.err,"City guide data is temporarily unavailable."),I=b(a.dup,"The City Guide for this location is already being displayed."),v=b(a.dd,"lg:newyorkny"),o=this,G=document,e=Msn.DOM,s=e.Event,q=e.CancelEvent,r=e.ChildElem,k=Msn.HP.Settings,z=Msn.TrackStub.Event,g,m,c,d,f;o.dispose=function(){if(c)c.dispose();if(g)g.cancel();j=d=c=f=g=0};o.OnExpand=function(){var b=k.GetModuleData(a.code),c=b&&b.D?b.D:v;if(c&&c!=m)n(c)};function y(b){b=s(b);var d=e.Target(b);z(d);var f=k.GetModuleData(a.code);if(f&&f.D==d.href)c.msg(I,"err");else n(d.href,true);return q(b)}function n(h,i){var e=k.GetModuleData(a.code),b=h,g=-1;if(e){e.D=h;k.SetModuleData(a.code,e)}Msn.Bind.Unbind(f,1);f.innerHTML="";if(i||!Msn.Page.Zip.z){g=b.indexOf("lg:");if(g>=0)b=b.substr(g+3);m=b;a.url=u.format(b)}else{m=Msn.Page.Zip.z;a.url=u.format(Msn.Page.Zip.z)}Msn.HP.Rss.Data.bind(f,a);c.msg();d.value=l}function w(a){if(g){g.cancel();g=null}var b=d.value==l?"":d.value;if(b){c.msg(x,"msg",J);g=(function(a){if(a.responseXML)H(a.responseXML);else c.msg(t,"err")}).RQ(D.format(b),E)}else c.msg();a=s(a);return q(a)}function H(g){var d=r(g,"results");if(d){var a=new K;e.ForEach(function(b){e.ForEach(function(b){var c=p(b,"providerid");if(!a.contains(c))a.add(c,p(b,"displayname"))},b,"provider")},d,"location");if(a.length==1)n(a[0].id,true);else{c.msg(A,"msg");for(var b=0;b<a.length&&b<B;++b){var f=a[b];y.hook(c.add(f.name,f.id),"click")}}}else c.msg(t,"err")}function K(){var a=this,b={};a.length=0;a.contains=function(a){return b[a]==1};a.add=function(c,d){b[c]=1;a[a.length++]={id:c,name:d}}}function h(a){return G.createElement(a)}function i(a,b){a.appendChild(b)}function p(b,a){return e.InnerText(r(b,a))}function L(){e.AddClass(j,"double2 cf");f=h("div");f.className="child c1 first";i(j,f);var g=h("div");g.className="child c2 last";i(j,g);var a=h("form");a.id=j.id=="lnmod"?"localnews":"cityguides";a.action="#";w.hook(a,"submit");i(g,a);Msn.TrackStub.FormBind(a);d=h("input");d.type="text";d.className="hint";d.maxLength=C;d.value=d.title=l;Msn.HP.TextBoxHint.bind(d);i(a,d);var b=h("input");b.type="submit";b.className="button";b.value=F;i(a,b);var k=h("div");i(a,k);c=new Msn.HP.DA(k);if(!e.HasClass(j,"closed"))o.OnExpand()}L()}).as("Msn.HP.CityGuide");(function(c,b){if(!b)b={};a("timeout",5000);a("len",100);a("go","Go");a("hint","Find news by city or ZIP code");a("max",15);a("delay",2000);a("surl","msn.com_files//localNewsSearch.aspx?ldlocation={0}");a("durl","msn.com_files//localNewsData.aspx?providerid={0}");a("load","Loading...");a("choose","Possible matches are listed below. Please select a location from the list below or enter a new location in the text box above.");a("err","Local news data is temporarily unavailable.");a("dup","The local news for this location is already being displayed.");a("dd","LN:WNBC");function a(a,c){if(typeof b[a]=="undefined")b[a]=c}return new Msn.HP.CityGuide(c,b)}).as("Msn.HP.LocalNews");(function(D,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,M=b(a.timeout,5000),ib=b(a.timeout,","),Kb=b(a.durl,"msn.com_files//weatherdata.aspx?wealocations={0}&weadegreetype={1}"),Nb=b(a.surl,"msn.com_files//weathersearch.aspx?weasearchstr={0}"),X=b(a.delay,2000),bb=b(a.load,"Loading..."),fb=b(a.none,"Add weather forecasts by entering the zip code or city below and clicking Go."),Ab=b(a.choose,"Possible matches are listed below. Please select a location from the list below or enter a new location in the text box above."),C=b(a.err,"Weather data is temporarily unavailable."),eb=b(a.nores,"Data for this location was not found.  Please enter a new city name or zip in the text box above."),Vb=b(a.dup,"The weather for this location is already on your list."),wb=b(a.nomore,'Please delete a weather location before adding a new one. To delete a weather location, hover over the location above you want to delete and click the "X" that appears.'),lb=b(a.max,15),db=b(a.fore,4),I=b(a.units,"W"),xb=b(a.sc,1),v=b(a.zc,"zip"),p=b(a.zd,".msn.com"),F=b(a.rt,"|"),G=b(a.rt,":"),Pb=b(a.zu,"msn.com_files//revip.aspx"),gb=b(a.rt,"z:ZIP|la:Latitude|lo:Longitude|c:CountryISO"),ob=b(a.togf,"\u00B0F"),mb=b(a.togc,"\u00B0C"),Lb=b(a.togf,"Change units to Fahrenheit"),Ib=b(a.togc,"Change units to Celsius"),Ob=b(a.del,"Remove {0}"),Tb=b(a.up,"Move up {0}"),yb=b(a.dn,"Move down {0}"),Mb=b(a.cur,"{0} {1}"),Rb=b(a.highlow,"{0} / {1}"),Ub=b(a.na,"n/a"),ub=b(a.temp,"{0}\u00B0"),E=b(a.ze,30),Y=b(a.rm,"hr:"),hb=b(a.rdmkt,"ko-kr,en-in,th-th"),nb=b(a.cexp,3650),rb=b(a.cnam,"CULTURE"),kb=b(a.cdom,".msn.com"),Jb=this,Sb=window,Qb=document,f=Msn.HP.Settings,O=Msn.Bind,c=Msn.DOM,l=c.Event,x=c.Target,q=c.CancelEvent,g=c.ChildElem,k=c.ParentElem,n=c.PrevElem,m=c.NextElem,B=c.AddClass,jb=c.DelClass,Z=c.HasClass,A=c.ChildCount,K=f.SetCookie,zb=Msn.TrackStub.Event,ab,s,r,e,i,o,t,tb=typeof a.fc!="undefined"?a.fc:1,P={F:Lb,C:Ib},j,L=1,N="none",Q="block",Wb={F:"C",C:"F"};Jb.dispose=function(){if(e)e.dispose();if(t){t.cancel();t=null}D=r=e=i=s=o=0};function z(a){var b=L;if(a&&a.length>0){b?e.msg(bb,"msg",X):0;t=(function(a){if(a.responseXML)Hb(a.responseXML,b);else b?e.msg(C,"err"):0}).RQ(Kb.format(a.join(ib),f.GetServerSetting(I)),M)}}function Hb(I,q){var A=g(I,"weatherdata");if(A){q?e.msg():0;q?r.focus():0;q?r.value="":0;var D=g(i,"P",1);if(D)w(i,D);var s,p,a,t=[];c.ForEach(function(b){a={weatherCode:b.getAttribute("weatherlocationcode"),displayName:b.getAttribute("weatherlocationname"),weatherUrl:b.getAttribute("url"),imageBase:b.getAttribute("imagerelativeurl"),forecasts:[]};if(!W(a.weatherCode))f.AddWeatherCode(a.weatherCode);t.push(a);c.ForEach(function(b){switch(b.nodeName){case "current":a.current={desc:b.getAttribute("skytext"),temp:b.getAttribute("temperature")};break;case "forecast":a.forecasts.push({day:b.getAttribute("day"),high:b.getAttribute("high"),low:b.getAttribute("low"),code:b.getAttribute("skycodeday"),desc:b.getAttribute("skytextday"),date:Date.parse(b.getAttribute("date"))});break}},b)},A,"weather");var j=g(i,"UL",1);if(!j){j=d("ul");j.className="forecast1";h(i,j)}for(var x=0;x<t.length;++x){a=t[x];if(a.weatherCode){var l=null;c.ForEach(function(b){if(y(b,1)==a.displayName)return l=b},j,"LI");var k=d("li");k.className="cf";j.insertBefore(k,l);if(l){O.Unbind(l,1);w(j,l);l=null}else{var E=n(k,"LI");if(E)u(E,"UpdateButtons")}cb.bind(k,{code:a.weatherCode,name:a.displayName});p=d("h4");if(a.weatherUrl)p.innerHTML=('<a href="{1}">{0}</a>').format(a.displayName,a.weatherUrl);else p.innerHTML=a.displayName;h(k,p);if(a.current){s=d("span",Mb.format(a.current.desc,H(a.current.temp)));h(k,s)}var b,z=d("ul");z.className="cf";for(var o=0;o<4&&o<a.forecasts.length;++o){var m=a.forecasts[o];b=d("li");if(o==1)b.className="first";var J=d("h5",m.day);h(b,J);var v=d("img");v.src="msn.com_files/17246.gif";v.alt=m.desc;h(b,v);var F=H(m.high),G=H(m.low);s=d("span",Rb.format(F,G));h(b,s);h(z,b)}if(b&&!Z(b,"first"))B(b,"last");h(k,z)}}}else q?e.msg(C,"err"):0}function H(a){return a?ub.format(a):Ub}function cb(a,o){o=o?o:{};var g=this,J=o.name,v=o.code,b=[],i;function L(){var c=d("div");c.className="btnbar";a.insertBefore(c,a.firstChild);b.push(B(c,"rem",Ob,D));b.push(B(c,"dn",yb,G,!m(a,"LI")));b.push(B(c,"up",Tb,M,!n(a,"LI")))}function B(i,e,g,c,f){var a=d("a");a.href="#";a.className=e;a.title=g.format(J);a.setAttribute("notrack",1);c.hook(a,"click");E.hook(a,"focus");F.hook(a,"blur");h(i,a);if(f)y(a,N);var b=d("div");h(a,b);return b}function E(a){a=l(a);i=x(a).childNodes[0];p(i,"visible")}function F(a){a=l(a);if(j!=g)p(i,"hidden");i=0}function H(){if(j!=g)t()}function K(a){a=l(a);if(!I(a.relatedTarget?a.relatedTarget:a.toElement))s()}function t(){for(var a=0;a<b.length;++a)p(b[a],"visible");j=g}function C(a){u(a,"Activate")}function s(){if(j==g){for(var a=0;a<b.length;++a){var c=b[a];if(c!=i)p(c,"hidden")}j=0}}function I(b){while(b){if(b==a)break;b=b.parentNode}return b}function p(b,a){b.style.visibility=a}function y(a,b){if(a)a.style.display=b}function M(h){h=l(h);e.msg();var d=r(x(h)),c=n(a,"LI");if(c){f.WeatherUp(v);if(j&&j.IsBoundTo(c)){j.Deactivate();t()}else if(j==g){s();C(c)}if(!n(c,"LI"))if(d){d.blur();d=k(b[1],"A")}k(a).insertBefore(a,c);z();u(c,"UpdateButtons");if(d)d.focus()}return q(h)}function G(i){i=l(i);e.msg();var h=r(x(i)),d=c.NextElem(a,"LI");if(d){f.WeatherDown(v);if(j&&j.IsBoundTo(d)){j.Deactivate();t()}else if(j==g){s();C(d)}if(!m(d,"LI"))if(h){h.blur();h=k(b[2],"A")}k(a).insertBefore(d,a);z();u(d,"UpdateButtons");if(h)h.focus()}return q(i)}function D(d){d=l(d);e.msg();f.DelWeatherCode(v);var b;if(!n(a,"LI"))b=m(a,"LI");else if(!m(a,"LI"))b=n(a,"LI");var g=a;O.Unbind(g,1);var c=k(g);w(c,g);if(b)u(b,"UpdateButtons");else if(A(c,"LI")==0){w(k(c),c);T()}return q(d)}function r(a){while(a&&(a.nodeType!=1||a.tagName!="A"))a=k(a);return a}function z(){y(r(b[2]),n(a,"LI")?Q:N);y(r(b[1]),m(a,"LI")?Q:N)}g.Deactivate=s;g.Activate=t;g.UpdateButtons=z;g.IsBoundTo=function(b){return b==a};g.dispose=function(){a=b=i=0};L();H.hook(a,"mouseover");K.hook(a,"mouseout")}function Db(){s=g(D,"FORM");if(s){var a=g(s,"INPUT");while(a){if(a.type=="text"){r=a;ab=r.value}a=m(a,"INPUT")}Eb.hook(s,"submit");var b=d("div");h(k(s),b);e=new Msn.HP.DA(b)}}function Cb(){i=g(D,"DIV",1);while(i&&!Z(i,"child"))i=m(i,"DIV");var a=g(i,"UL");if(!a||A(a,"LI")==0){if(a)w(k(a),a);T()}}function u(a,d){if(a&&a.bindings)for(var b=0;b<a.bindings.length;++b){var c=a.bindings[b];if(typeof c[d]=="function")c[d]()}}function T(){h(i,d("P",fb))}function Eb(b){var a=encodeURI(r.value);if(a&&a!=ab)if(f.GetWeatherCodes().length<db){e.msg(bb,"msg",X);t=(function(a){if(a.responseXML)sb(a.responseXML);else e.msg(C,"err")}).RQ(Nb.format(a),M)}else e.msg(wb,"err");b=l(b);return q(b)}function sb(h){var a=g(h,"weatherdata");if(a){var f=0;switch(A(a,"weather")){case 0:e.msg(eb,"err");break;case 1:var b=g(a,"weather"),d=b.getAttribute("searchdistance");if(!parseFloat(d)){V(b.getAttribute("weatherlocationcode"));break}default:e.msg(Ab,"msg");c.ForEach(function(a){pb.hook(e.add(a.getAttribute("weatherfullname"),a.getAttribute("weatherlocationcode")),"click");return ++f>=lb},a,"weather");break}}else e.msg(C,"err")}function V(a){f.AddWeatherCode(a);if(W(a))e.msg(Vb,"err");else z([a])}function y(h,f){var a,d=g(h,"H4");if(d)if(f)a=c.InnerText(d);else{var e=g(d,"A");if(e){var i=/wealocations=([^&]*)/,b=i.exec(e.href);if(b&&b.length>1)a=b[1]}}return a}function W(d){var a=0,b=g(i,"UL");if(b)c.ForEach(function(b){if(y(b)==d)return a=1},b,"LI");return a}function pb(a){a=l(a);var b=x(a);zb(b);V(b.href);return q(a)}function qb(){var a=g(i,"UL");if(a)if(A(a,"LI")>0)c.ForEach(function(a){cb.bind(a,{code:y(a),name:y(a,1)})},a,"LI");else Fb()}function Fb(){var a=f.GetWeatherCodes();if(a.length>0)z(a)}function d(c,a){var b=Qb.createElement(c);if(a)b.innerHTML=a;return b}function h(a,b){return a.appendChild(b)}function w(a,b){return a.removeChild(b)}function Gb(){var e=f.GetServerSetting(I),c=e=="F",b=g(D,"H2");if(b){var a=d("ul");a.className="linklist9 tog";b.insertBefore(a,b.firstChild);U(a,ob,"F","first",c);U(a,mb,"C","last",!c)}}function U(i,f,c,e,g){var a;if(g){a=d("li",f);B(a,"selected");o=a}else{a=d("li");var b=d("a",f);b.title=P[c];b.className=c;b.href="#";J.hook(b,"click");h(a,b)}if(e)B(a,e);h(i,a)}function J(c){c=l(c);var b=x(c);if(b){var g=b.className;if(g){jb(o,"selected");var i=Wb[g],a=d("a",o.innerHTML);a.title=P[i];a.className=i;a.href="#";o.innerHTML="";h(o,a);J.hook(a,"click");var e=k(b,"LI");if(e){B(e,"selected");J.unhook(b,"click");e.innerHTML=b.innerHTML;o=e}f.SetServerSetting(I,g);z(f.GetWeatherCodes());return q(c)}}}function S(a){var b=a.match(new RegExp("\\bc:(..)","i"))?RegExp.$1:0;hb.match(new RegExp(("(..-{0})(\\|(\\d+)|)").format(b),"i"));if(RegExp.$1){if(RegExp.$3)E=RegExp.$3;K(rb,RegExp.$1,nb,kb)}}function vb(){var a=f.GetCookie(v),d=0,c=Msn.Page.Zip;if(!a){if(c){var e=[],b;for(b in c){d|=c[b]?1:0;e.push(b+G+c[b])}if(d){a=e.join(F);S(a);K(v,a,E,p?p:f.GetCookieDomain())}}if(!d&&xb)t=(function(a){if(a.responseXML){Bb(a.responseXML);R()}}).RQ(Pb,M)}R()}function R(){var a=f.GetCookie(v);if(a&&a.indexOf(Y)<0){a+=("{0}{1}1").format(F,Y);K(v,a,E,p?p:f.GetCookieDomain())}}function Bb(h){var l=g(h,"IPLookup"),n=g(h,"ZIP"),i=g(h,"CountryISO");if(l){var m=gb.split(F),d=[],a,b;for(var e=0;e<m.length;++e){b=m[e].split(G);if(b.length==2){a=g(l,b[1]);if(a)d.push(b[0]+G+c.InnerText(a))}a=0}if(d.length){var k=d.join(F);S(k);f.SetCookie(v,k,E,p?p:f.GetCookieDomain())}if(f.GetWeatherCodes().length==1&&n&&i){var o=c.InnerText(i),j=c.InnerText(n);if(o.toLowerCase()=="us"&&(/^\d{5}$/).test(j)){L=0;z([j]);L=1}}}}vb.hook(Sb,"load");if(Msn.Ajax/.Enabled()){Db();Cb();if(tb)Gb();qb()}}).as("Msn.HP.Weather");(function(g,b){if(!b)b={};var e=Msn.Util.ArgWithDefault,p=e(b.durl,"Encarta.xml"),C=e(b.timeout,5000),J=e(b.delay,2000),y=e(b.load,"Loading..."),n=e(b.err,"Encarta data is temporarily unavailable."),m=e(b.protocol,"enc:"),I="p"+e(b.tab,"2"),F=e(b.gtl,"linklist16"),D=e(b.imgabs,"linkedimglink1 cf"),u=e(b.nav,"linklist9"),v=e(b.headers,"Today's Quiz;On This Day;Word of the Day"),s=e(b.forms,[{hookinto:2,url:"http://encarta.msn.com/encnet/features/dictionary/dictionaryresults.aspx",go:"Go",hint:"Find a word",max:100,tname:"search"}]),A=e(b.delim,";"),B=v.split(A),o=this,K=document,d=Msn.DOM,h=d.ChildElem,c=d.CreateElement,a=d.AppendChild,l=Msn.HP.Settings,r=0,i,k,j,f;function q(){if(!r&&p){f.msg(y,"msg",J);if(i)i.cancel();i=(function(a){f.msg();if(a.responseXML)z(a.responseXML);else f.msg(n,"err")}).RQ(p,C)}}function z(j){var i=h(j,"feeds");if(i){var e=0,b;d.ForEach(function(i){var f=h(i,"feed");if(f){H(B[e],"p"+e,++e);b=c("div");b.className="child c"+(e+1)+" p"+(e-1);a(g,b);var d=h(f);switch(d.nodeName){case "headlines":G(b,d);break;case "imageabstract":E(b,d);break}w(b,e-1)}},i);if(b)d.AddClass(b,"last");r=1}else f.msg(n,"err")}function w(g,h){for(var f=0;f<s.length;f++){var e=s[f];if(e.hookinto==h){var d=c("form");d.action=e.url;d.method="get";d.id="encarta";a(g,d);Msn.TrackStub.FormBind(d);var b=c("input");b.type="text";b.maxLength=e.max;b.value=b.title=e.hint;b.className="hint";b.name=e.tname;a(d,b);Msn.HP.TextBoxHint.bind(b);b=c("input");b.type="submit";b.className="button";b.value=e.go;a(d,b)}}}function G(g,f){var b,h=0,e=c("ul");e.className=F;d.ForEach(function(f){b=c("li");if(!h++)b.className="first";var d=c("a");d.href=f.getAttribute("url");d.innerHTML=f.getAttribute("text");a(b,d);a(e,b)},f,"link");if(b&&b.className!="first")b.className="last";a(g,e)}function E(l,j){var b,g,e,f=c("span");f.className=D;a(l,f);var d=h(j,"image");if(!d)d=h(j,"img");if(d){g=d.getAttribute("url");if(g){b=c("a");b.href=g}e=c("img");e.src=d.getAttribute("src");e.width=d.getAttribute("width");e.height=d.getAttribute("height");e.alt=d.getAttribute("text");if(b){a(b,e);a(f,b)}else a(f,e)}var i=h(j,"link");if(i){var k=c("span");k.innerHTML=i.getAttribute("text");g=i.getAttribute("url");if(b&&g==b.href)a(b,k);else{b=c("a");b.href=i.getAttribute("url");a(f,b);a(b,k)}}}function x(a){a=d.Event(a);var f=d.Target(a),e=f.href.substring(m.length);d.DelClass(g,j);d.AddClass(g,e);j=e;var c=l.GetModuleData(b.code);c.D=j;l.SetModuleData(b.code,c);return d.CancelEvent(a)}function H(g,e,f){var d=c("li");if(f==1)d.className="first";if(f==3)d.className="last";var b=c("a");b.className=e;b.href=m+e;b.innerHTML=g;b.setAttribute("notrack",1);x.hook(b,"click");a(d,b);a(k,d);return d}function t(){d.AddClass(g,"quad5 cf");var h=l.GetModuleData(b.code);j=h.D&&h.D.length==2?h.D:I;d.AddClass(g,j);var e=c("div");e.className="child c1 first cf";a(g,e);k=c("ul");k.className=u;a(e,k);var i=c("div");a(e,i);f=new Msn.HP.DA(i);if(!d.HasClass(g,"closed"))q()}o.OnExpand=function(){q()};o.dispose=function(){if(i)i.cancel();if(f)f.dispose();g=i=f=k=0};t()}).as("Msn.HP.Encarta");(function(g,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,L=b(a.show,8000),Y=b(a.fade,0),M=b(a.gap,1000),p=b(a.man,0),gb=b(a.pp,1),t=b(a.prev,"< Previous"),s=b(a.next,"Next >"),q=b(a.ss,"block"),eb=b(a.spli,"msn.com_files/t.gif"),hb=b(a.flip,"nav"),T=b(a.pcls,"prev"),R=b(a.ncls,"next"),P=b(a.pauply,"pauply"),E=b(a.play,"play"),J=b(a.paut,"Pause"),S=b(a.playt,"Play"),db=b(a.track,"Slideshow pause/play {0} clicked"),c=Msn.DOM,G=c.ChildElem,kb=c.HasClass,ib=c.AddClass,jb=c.DelClass,v=document,h=window,m=0,i=0,e=0,y=1,l=[],j=[],w=0,n=0,k=Q(),d,B="",D="mousemove",u="click",Z=Msn.TrackStub.Event,lb=b(a.ppid,"");if(k>1){U(g);n=h.setTimeout(I,1000)}function x(a){return v.createElement(a)}function o(a,b){a.appendChild(b)}function Q(){var d=g.childNodes?g.childNodes.length:0;for(var c=0;c<d;++c){var a=g.childNodes[c];if(a.nodeType==1&&a.tagName.toUpperCase()=="DIV"){l.push(a);if(a.currentStyle&&a.currentStyle.display=="block")q="block";var b=G(a,"img");if(!b)b=G(a,"IMG");if(b)j.push(b)}}return l.length}function O(){if(t||s){var a=x("div");a.className=hb;o(c.ParentElem(g),a);if(t)W.hook(A(a,t,T,1,"","","spprev"),u);if(gb&&k>1){d=A(a,"",P,0,J,lb);fb.hook(d,u)}if(s)V.hook(A(a,s,R,1,"","","spnext"),u)}}function K(){if(B){var b=v.getElementById(B);if(b&&b.bindings){var a,c=0;for(;a=b.bindings[c++];)if(typeof a.CV=="function")a.CV()}}if(d)d.style.display=q}function W(a){K();z(k-1);a=c.Event(a);return c.CancelEvent(a)}function V(a){K();z(1);a=c.Event(a);return c.CancelEvent(a)}function fb(b){b=c.Event(b);var a=c.Target(b);p=!p;if(!c.Target(b).getAttribute("notrack"))Z(c.Target(b),"",db.format(d.id?"id:"+d.id:""));if(a)if(kb(a,E)){jb(a,E);a.title=J}else{ib(a,E);a.title=S}f();return c.CancelEvent(b)}function z(a){C();i=(i+a)%k;r();f()}function I(){if(!w){O();w=1;var c=new RegExp(eb+"\\?(.*)","i"),b;for(var a=1;a<k;a++)if(j[a]&&j[a].src){b=j[a].src.match(c);if(b&&b[1])j[a].src=b[1]}}}function H(a){if(!w){I();if(n)h.clearTimeout(n)}l[i].style.display=a;l[i].className=l[i].className}function r(){H(q)}function C(){H("none")}function A(d,i,h,e,f,g,c){var a=x("a");a.href="#";if(f)a.title=f;if(g)a.id=g;if(e)a.setAttribute("notrack",e);a.className=h;o(a,v.createTextNode(i));if(c){var b=x("span");b.className=c;o(b,a);o(d,b)}else o(d,a);return a}function U(a){if(!p){f.hook(a,D);if(Y)a.style.filter=("progid:DXImageTransform.Microsoft.Fade(duration={0})").format(M/2000);var b=a.filters;e=b&&b.length>0?b[0]:0;if(e)(function(){if(y)h.setTimeout(N,1);else f();y=!y}).hook(a,"filterchange");else L+=M/2;a=0;f()}}function f(){if(m)h.clearTimeout(m);m=p?0:h.setTimeout(X,L)}function X(){if(e){e.apply();C();e.play()}else C();i=(i+1)%k;if(!e)N()}function N(){if(e){e.apply();r();e.play()}else{r();f()}}function F(a){B=a}function ab(a){if(d)d.style.display="none";F(a);f.unhook(g,D);window.clearTimeout(m)}function bb(){if(d)d.style.display=q;F("");f.hook(g,D);z(0)}function cb(){if(m)h.clearTimeout(m);if(n)h.clearTimeout(n)}cb.hook(h,"unload");this.dispose=function(){g=l=j=0};this.BV=ab;this.AV=bb}).as("Msn.HP.Slideshow");(function(d,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,O=b(a.txt,"Make this your homepage"),p=b(a.tc,""),F=b(a.spurl,"msn.com_files//searchpromo.aspx"),Q=b(a.tced,30),x=b(a.tsps,"Search Prompt shown"),H=b(a.tsp,"Set Provider"),B=b(a.tdss,"Don't Show Search"),R=b(a.thps,"Homepage Prompt shown"),G=b(a.tshp,"Set HomePage"),y=b(a.tdsh,"Don't Show Homepage"),D=b(a.dhppurl,"msn.com_files//DHPpromo.aspx"),A=b(a.shpt,1),k=a.url?a.url:window.location.href,c=Msn.DOM,j=c.ChildElem,f=c.CreateElement,i=c.AppendChild,v=Msn.HP.Settings,u=Msn.TrackStub.Event,P=document,e,g,l,r=1,s=2,h=false,m;d.style.behavior="url(#default#homepage)";if(S()){var o=v.GetCookie(p);m=o?o:0;if(!(o&r)){m|=r;q.RQ(F)}else if(A&&(typeof d.isHomePage!="undefined"&&!d.isHomePage(k))&&!(o&s)){h=true;m|=s;q.RQ(D)}}L();this.dispose=function(){d=g=e=0};function S(){if(p){var a=navigator.userAgent,b=a.indexOf("MSIE"),c=a.indexOf("MSN");if(c<0&&b>0&&parseInt(a.substring(b+4))>=7)return true}return false}function L(){if(typeof d.isHomePage!="undefined"&&!d.isHomePage(k)){w("none");g=f("a");g.href=k;g.innerHTML=O;K.hook(g,"click");i(d,g)}}function q(d){var a=1,c=d.responseXML;if(c){var b=j(c,"channel");if(b)a=N(b)}return a}function N(d){var j=n(d,"title",1),o=n(d,"description",1),g=J("wrapper");if(g){e=f("div");e.id="tickler";e.style.filter="progid:DXImageTransform.Microsoft.gradient(startColor=0, endColorStr=#ffffff)";g.insertBefore(e,g.firstChild);var b=f("a");b.className="del";b.href="#";i(e,b);var k=f("div");i(b,k);k.style.visibility="visible";b.title="Close";C.hook(b,"click");var a=f("form");a.action="#";a.method="GET";i(e,a);I.hook(a,"submit");if(h)j=j.format(M(d));else{e.className="search";z(d)}var l=f("label",j);i(a,l);var c=f("input");c.type="submit";c.className="button";c.value=o;i(a,c);v.SetCookie(p,m,Q);u(a,"",h?R:x);b=l=a=c=0}return 0}function M(e){var a=j(e,"item",1);if(a){var c,b,d;c=j(a,"enclosure",1);b=c.getAttribute("url");if(b){d=n(a,"title",1);return ('<img src="{0}" alt="{1}" />').format(b,d)}}return "MSN"}function z(b){var c=j(b,"item",1),a=n(c,"link",1);if(a&&!l)l=a}function C(a){u(c.Target(a),"",h?y:B);a=c.Event(a);e.style.display="none";return c.CancelEvent(a)}function I(a){a=c.Event(a);var b=c.Target(a);track.Event(b,"",h?G:H);try{if(h)t();else E()}catch(d){}e.style.display="none";return c.CancelEvent(a)}function E(){if(l&&window.external&&typeof window.external.AddSearchProvider!="undefined")window.external.AddSearchProvider(l)}function t(){d.setHomePage(k);if(d.isHomePage(k)){d.removeChild(g);w()}}function K(a){t();a=c.Event(a);return c.CancelEvent(a)}function w(c){for(var b=0;b<d.childNodes.length;++b){var a=d.childNodes[b];if(a.nodeType==1)if(c){a.prevDisplay=a.style.display;a.style.display=c}else a.style.display=a.prevDisplay}}function n(b,d,e){var a=j(b,d,e);return a?c.InnerText(a):""}function J(a){return P.getElementById(a)}}).as("Msn.HP.MakeMSN");(function(d,a){if(!a)a={};var b=Msn.Util.ArgWithDefault(txt,"Restore defaults"),h=document,c=Msn.DOM,f=Msn.HP.Settings;if(b)g();function g(){var a=h.createElement("a");a.href="#";a.innerHTML=b;e.hook(a,"click");d.appendChild(a)}function e(a){a=c.Event(a);f.ClearCookies();window.location.reload(false);return c.CancelEvent(a)}this.dispose=function(){d=null}}).as("Msn.HP.Restore");(function(a,d){var b=Msn.DOM,e=window,c=Msn.TrackStub.Event;this.dispose=function(){a=0};(function(f){f=b.Event(f);var g=typeof d=="string"?d:a.rel?a.rel:"";if(b.HasClass(a,"popup")){e.open(a.href,"",g);c(a);return b.CancelEvent(f)}else if(e.open(a.href,"",g)){c(a);return b.CancelEvent(f)}}).hook(a,"click")}).as("Msn.HP.OpenNew");(function(c,b){if(!b)b={};this.dispose=function(){c=a=0};var e=Msn.Util.ArgWithDefault,k=e(b.hd,"Windows Live Messenger"),i=e(b.upMsg,"Windows Live Messenger has a fresh new look, but it's still got all the features you know and love. Use Windows Live Messenger to chat with your friends!"),a=null,d=false;function h(){d=true;try{a=new ActiveXObject("MSNMessenger.Hotmail2Control")}catch(b){a=null}}function g(b){b=Msn.DOM.Event(b);if(!d)h();if(a)try{a.ShowContactList();return Msn.DOM.CancelEvent(b)}catch(c){a=null}}function j(){g.hook(c,"click")}function f(){var a='<div class="double1 cf"><div class="child c1 msg"><span class="head"><b>{0}</b></span><span class="msg">{1}</span></div><div class="child c2 logo"/></div>';c.innerHTML=a.format(k,i)}if(!b.up)j();else f()}).as("Msn.HP.Messenger");(function(){var f=Msn.Tracking,d,c=Msn.DOM,e=c.ParentElem,a,b="http://www.msn.com/";function h(d,c){a=d;a.style.behavior="url(#default#homepage)";if(c&&c.hp)b=c.hp;if(!b)b=window.location.href;return typeof a.setHomePage!="undefined"&&(typeof a.isHomePage=="undefined"?true:!a.isHomePage(b))}this.S=h;function i(a){if(!a["trackSetHomepage"])return false;d=a["trackSetHomepage"];return true}this.I=i;function g(j){j=c.Event(j);var i=c.Target(j);try{a.setHomePage(b)}catch(l){}var h=e(i);if(h)var k=e(h);if(f&&h){var g=document.createElement("form");g.action="#";g.method="GET";g.style.display="none";if(i.id)g.id=i.id;h.removeChild(i);h.appendChild(g);f.Event(g,"",d);h.removeChild(g);g=0}a.removeChild(k);c.Updated();h=k=0;return c.CancelEvent(j)}this.T=g;this.dispose=function(){a=0}}).ns("Msn.HP.IndividualTickler.H");(function(){var a,b="http://www.msn.com/";function c(d,c){a=d;a.style.behavior="url(#default#homepage)";if(c&&c.hp)b=c.hp;if(!b)b=window.location.href;return typeof a.setHomePage=="undefined"&&(typeof a.isHomePage=="undefined"?true:!a.isHomePage(b))}this.S=c;this.dispose=function(){a=0}}).ns("Msn.HP.IndividualTickler.F");(function(){var b,c,e,a=Msn.DOM,d=a.ParentElem,f=Msn.Tracking;function h(a){b=a;var c=navigator.userAgent;return c.indexOf("MSN Optimized")<0}this.S=h;function i(a){if(!a["IEAKUrl"])return false;e=a["IEAKUrl"];if(!a["trackNavigateIEAK"])return false;c=a["trackNavigateIEAK"];return true}this.I=i;function g(j){j=a.Event(j);var i=a.Target(j),h=d(i);if(h)var k=d(h);if(f&&h){var g=document.createElement("form");g.action="#";g.method="GET";g.style.display="none";if(i.id)g.id=i.id;h.removeChild(i);h.appendChild(g);f.Event(g,"",c);h.removeChild(g);g=0}b.removeChild(k);a.Updated();h=k=0;try{window.location.href=e}catch(l){}return a.CancelEvent(j)}this.T=g;this.dispose=function(){b=0}}).ns("Msn.HP.IndividualTickler.I");(function(){var d,e,c=window.external,b,a=Msn.DOM,f=a.ParentElem,g=Msn.Tracking;function j(e){d=e;var a=navigator.userAgent,b=a.indexOf("MSIE"),f=a.indexOf("MSNbMSFT"),c=a.indexOf("Firefox/");return f<0&&b>0&&parseInt(a.substring(b+4))>=7||c>0&&parseInt(a.substring(c+8))>1}this.S=j;function k(a){if(!a["searchProviderUrl"])return false;b=a["searchProviderUrl"];if(!a["trackSetProvider"])return false;e=a["trackSetProvider"];return true}this.I=k;function i(j){j=a.Event(j);var i=a.Target(j);try{h()}catch(l){}var c=f(i);if(c)var k=f(c);if(g&&c){var b=document.createElement("form");b.action="#";b.method="GET";b.style.display="none";if(i.id)b.id=i.id;c.removeChild(i);c.appendChild(b);g.Event(b,"",e);c.removeChild(b);b=0}d.removeChild(k);a.Updated();c=k=0;return a.CancelEvent(j)}this.T=i;function h(){try{if(b&&c&&typeof c.AddSearchProvider!="undefined")c.AddSearchProvider(b)}catch(a){}}this.dispose=function(){d=0}}).ns("Msn.HP.IndividualTickler.S");(function(){var i=document,f=Msn.DOM,b,a,d,k,e,g="ae;ar;at;au;be;bh;bo;br;ca;ch;cl;cn;co;cr;cu;de;dk;do;dz;ec;eg;es;fi;fr;gb;gt;hk;ht;hn;id;ie;il;in;iq;it;jo;jp;kr;kw;lb;lx;ly;ma;mx;my;ni;nl;no;nz;om;pa;pe;ph;pk;pl;pr;pt;py;qa;ru;sa;se;sg;sv;tn;th;tr;tt;tw;uy;ve;vn;za;",h=/\|c:([a-z]{2})/i,c="zip";function o(a){return !!(d=a["navigateUrl"])}this.I=o;function m(l,d){var i="ae;ar;at;au;be;bh;bo;br;ca;ch;cl;cn;co;cr;cu;de;dk;do;dz;ec;eg;es;fi;fr;gb;gt;hk;ht;hn;id;ie;il;in;iq;it;jo;jp;kr;kw;lb;lx;ly;ma;mx;my;ni;nl;no;nz;om;pa;pe;ph;pk;pl;pr;pt;py;qa;ru;sa;se;sg;sv;tn;th;tr;tt;tw;uy;ve;vn;za;",j="http://www.msn.com/",f=Msn.Util.ArgWithDefault;if(d){c=f(d.cn,c);i=f(d.ls,i);j=f(d.msn,j);g+=f(d.lc,"")}var k;if(j.toLowerCase()==Msn.Page.HPUrl.toLowerCase()){b=Msn.HP.Settings.GetCookie(c);if(b){a=h.exec(b)[1];if(a){e=new RegExp(a+"(?=;)","i");k=i.match(e)}}}return !!k}this.S=m;function l(){var a=g.match(e);a=a?a[0]:0;return a}this.A=l;function n(g){var e="{0}({1})",b=f.Target(f.Event(g));if(b){var c=f.ParentElem(b),a=i.createElement("a");c.removeChild(b);c.appendChild(a);a.href=d;a.id=b.id;a.innerText=e.format(b.value,k);if(i.all)a.click();else Msn.TrackStub.Nav(a);window.location=d;c.removeChild(a);c.appendChild(b);a=c=0}else window.location=d}function j(k){var d,j,f,i,e;if(!k)return null;if(!b)b=Msn.HP.Settings.GetCookie(c);if(b&&!a)a=h.exec(b)[1];if(a){d=k.split("-");if(d)for(var g=0;g<d.length;g++){e=d[g].split(":");if(e.length==2){f=e[0];i=e[1];if(a&&f&&a.toLowerCase()==f.toLowerCase()){j=parseInt(i);return j}}}}return null}this.E=j;this.G=n}).ns("Msn.HP.IndividualTickler.C");(function(){var b,a=Msn.HP.Tb;function e(){return 1}this.I=e;function d(i,f){var e="15,17,19",c=e.split(",");if(f)c=Msn.Util.ArgWithDefault(f.ca,e).split(",");var h=a.Val(),g=c.length;b=c[g-1];for(var d=0;d<g;++d)if(c[d]==h)return true;return false}this.S=d;function c(){var c=a.Val();c==b?a.Reset():1;return c}this.A=c}).ns("Msn.HP.IndividualTickler.W");(function(i,b){if(!b)b={};var c=Msn.Util.ArgWithDefault,A=c(b.tcn,"ushppr"),K=c(b.st,"S"),W=c(b.sqs,"ShowTickler"),I=c(b.rt,"R"),z=c(b.tcs,"|"),x=c(b.tcds,":"),t=c(b.ti,"I"),P=c(b.ap,"/msn.com_files//"),M=".aspx",E="-",u=c(b.tl,"C:1:30,F:1:30,H:1:30,I:1:30,S:1:30"),H=c(b.fno,"{0} Prompt shown"),F=c(b.fnc,"Don't show tickler {0}"),e=c(b.tns,Msn.HP.IndividualTickler),B=c(b.tlp,0),y=c(b.ep,3652),o=c(b.tcm,{H:"F"}),k="",j=Msn.DOM,f=j.ChildElem,h=j.InnerText,n=Msn.Tracking,v=Msn.HP.Settings,s=Msn.Bind.Select,w=document,d={},a,g,C=86400000,q,m=0;if(u){N();D()}function T(b,g){var a;if(!b)a=location.search.substring(1,location.search.length);else a=b.substring(b.indexOf("?",b.length));if(a&&a.length){a=a.replace(/\+/g," ");var e=a.split("&");for(var d=0;d<e.length;d++){var c=e[d].split("=");if(c.length==2){var f=unescape(c[0]);if(f.toLowerCase()==g.toLowerCase())return c[1]}}}return ""}function N(){var c=v.GetCookie(A);if(c){var f=p(new Date),e=c.split(z);for(var b=0;b<e.length;++b){var a=e[b].split(x);if(a&&a.length<4&&a[0]&&a[1]&&a[2]&&!isNaN(a[1])&&f<a[2])d[a[0]]={D:parseInt(a[1]),E:a[2]}}}}function R(b){if(a&&b){if(a.toLowerCase()==b.toLowerCase())return true;if(o&&o[b.toUpperCase()]){var d=o[b.toUpperCase()].split(",");for(var c=0;c<d.length;c++)if(a.toLowerCase()==d[c].toLowerCase())return true}}return false}function D(){var k=u.split(","),f;for(;m<k.length;m++){f=k[m].split("|");var b=f[0].split(":");if(b.length>1&&b[0]&&b[1]&&!isNaN(b[1]))try{a=b[0];q=b[1];var h=0,g=0;if(e&&e[a]){h=e[a][K];g=e[a][I]}var j=d[a],n=T(0,W).toLowerCase();if((d.length==0||!j||j.D!=q||R(n))&&(!l(h)||h(i,B[a]))){if(b[2]){var c;if(a.toLowerCase()=="c"&&f.length==2)if(Msn.HP.IndividualTickler.C.E)c=Msn.HP.IndividualTickler.C.E(f[1]);if(!c)c=parseInt(b[2]);if(!isNaN(c)&&c>=0)y=c}if(l(g)?g(i,B[a]):V())break}}catch(o){}}}function Q(a){var b=a.indexOf("<content>"),c=a.indexOf("</content>");if(b!=-1)return a.substring(b+9,c);return 0}function L(b){b=j.Event(b);if(n)n.Event(j.Target(b),"",F.format(k?k:a));i.removeChild(g);j.Updated();return j.CancelEvent(b)}function X(){if(n&&g){var b=w.createElement("form");b.action="#";b.method="GET";b.style.display="none";g.appendChild(b);n.Event(b,"",H.format(k?k:a));g.removeChild(b);b=0}}function O(O,N){var c=f(O,"tickler");if(c){var J=f(c,"content",1),q=f(c,"functions",1),r=f(c,"variables",1),K=f(c,"class",1),M=f(c,"id",1),I=f(c,"friendlyname",1),E=Q(N),b="";try{if(J&&E){g=w.createElement("div");var n=h(M);if(n)g.id=n;var m=h(K);if(m)g.className=m;g.innerHTML=E;i.insertBefore(g,i.firstChild);var d;if(n)d=s("#"+n+" .del");else if(m)d=s("."+m+" .del");var p;if(d&&d.length>0){L.hook(d[0],"click");d=0}k=h(I);if(q)for(p=0;p<q.childNodes.length;++p){var u=q.childNodes[p],C=h(f(u,"name",1)),B=h(f(u,"event",1)),z=h(f(u,"element",1));if(!C||!B||!z)throw b;var o=s(z);if(!o)throw b;var D=C.split("."),j=e;if(!j)throw b;for(var v=0;v<D.length;v++){j=j[D[v]];if(!j){throw b;b=0}}if(l(j)){for(var y=0;y<o.length;y++)j.hook(o[y],B);o=0}else{throw b;b=0}}if(r){if(!e||!e[a]||!l(e[a][t]))throw b;var H=[];for(var x=0;x<r.childNodes.length;++x){var A=r.childNodes[x],G=h(f(A,"variablename",1)),F=h(f(A,"variablevalue",1));if(!G||!F)throw b;H[G]=F}if(!e[a][t](H)){throw b;b=0}}X();return 1}}catch(P){i.removeChild(g);return 0}}return 0}function V(){var c=P+a,b=0;if(e&&e[a]){b=e[a]["A"];var d;if(l(b)&&(d=b()))c+=E+d}var f=c+M;return (function(b){var a=1,d=b.responseXML,c=b.responseText;if(c&&d&&O(d,c)){S();a=0}else{m++;window.setTimeout(D,1)}return a}).RQ(f)}function U(a){var b;a+="";if(a!="undefined"&&a.length==6)b=new Date(parseInt(a.substring(0,2),10)+2000,a.substring(2,4),a.substring(4));else{b=new Date;b.setYear(2000)}return b}function p(a){return ("{0}{1}{2}").format(r(a.getYear()%100),r(a.getMonth()),r(a.getDate()))}function S(){if(a){d[a]={D:q};var e=new Date;e.setTime(e.getTime()+y*C);d[a].E=p(e)}var f=[],c=p(new Date);for(var b in d)if(b){f.push(J(b));if(c<d[b].E)c=d[b].E}v.SetCookie(A,f.join(z),G(c))}function J(a){var b=[a];if(d[a]){b.push(d[a].D);if(d[a].E)b.push(d[a].E)}return b.join(x)}function G(a){var b=U(a),c=new Date;return (b.getTime()-c.getTime())/C}function r(b){var a=b+"";if(a=="undefined"||a.length==0)a="00";else if(a.length==1)a="0"+a;return a}function l(a){return typeof a=="function"}this.dispose=function(){i=g=0}}).as("Msn.HP.GenericTickler");(function(){var a=[];this.Setup=function(b,c){b?a.push({id:b,args:c}):1};this.Init=function(){var b,c=0;for(;b=a[c++];)Msn.HP.Video.Build.bind(b.id,b.args)}}).ns("Msn.HP.Video");(function(c,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,J=b(a.ad,true),S=b(a.allowFullScreen,true),O=b(a.allowScriptAccess,"always"),K=b(a.ap,true),C=b(a.base,"http://images.soapbox.msn.com/flash/soapbox1_1.swf"),A=b(a.bsbpg,"http://rad.msn-int.com/ADSAdClient31.dll?GetAd?PG=T4VID4"),W=b(a.c,"v"),w=b(a.cbprefix,"Msn.Video."),N=b(a.ch,true),U=b(a.closeBtnBottom,true),Z=b(a.closeBtnTop,true),L=b(a.closeBtnTrackingText,"Close Button Clicked"),v=b(a.closetext,"close"),P=b(a.fg,"gtlv2"),X=b(a.flashPlayerUrl,"http://images.soapbox.msn.com/flash/soapbox1_1.swf"),o=b(a.flashVersion,"9"),R=b(a.fr,"inline"),z=b(a.height,265),G=b(a.idp,"http://video.msn.com"),H=b(a.ifs,true),I=b(a.mkt,"en-us"),bb=b(a.ns,"public"),s=b(a.partnerlogo,true),T=b(a.pg,"http://rad.msn-int.com/ADSAdClient31.dll?GetAd?PG=T4VID3"),M=b(a.playButtonTrackText,"Video id:{0} clicked"),t=b(a.playlistmin,2),cb=b(a.ps,2),x=b(a.quality,"high"),V=b(a.rv,false),F=b(a.skin,0),u=b(a.timePlaying,15),B=b(a.wmode,"window"),r=document,d=Msn.DOM,l="",ab=c.id,y=b(a.Fuuids,""),E=b(a.host,""),D=b(a.hide,""),f=g(E),e=g(D),q="function",m="click",h,i,j=b(a.width,0),p=Msn.TrackStub.Event,Y=b(a.p,"");function Q(b){if(!f||!e)return false;if(e.style)i=e.style.display;if(!i)i="block";e.style.display="none";if(!d.Target(b).getAttribute("notrack"))p(d.Target(b),"",M.format(c.id));var E="",D="",a=r.createElement("div");a.id=c.id+"ct";a.className="vidct";a.style.display="block";if(Z)E=('<div class="clst"><a href="#" id="{0}">{1}[x]</a></div>').format(c.id+"c",v+"&nbsp;");if(U)D=('<div class="clsb"><a href="#" id="{0}"></a></div>').format(c.id+"b");a.innerHTML=('{0}<div id="{1}"></div>{2}<div class="vidm" id="{3}"></div><div class="vida" id="{4}"></div>').format(E,c.id+"_p",D,c.id+"_m",c.id+"_a");f.insertBefore(a,e);var L=[("skin={0}").format(F),("mkt={0}").format(I),("p={0}").format(Y),("idp={0}").format(G),("fr={0}").format(R),("fg={0}").format(P),("ad={0}").format(J),("timePlaying={0}").format(u),("partnerlogo={0}").format(s),("ch={0}").format(N),("pg={0}").format(T),("bsbpg={0}").format(A),("cbdata={0}").format(c.id),("cbprefix={0}").format(w),("playlistmin={0}").format(t),("ifs={0}").format(H),("c={0}").format(W),("v={0}").format(y),("ap={0}").format(K),("rv={0}").format(V)].join("&amp;");if(j==0||j>f.clientWidth)j=f.clientWidth;Msn.Flash.Build(X,o,j,z,c.id+"_p",O,S,C,x,B,L);l=c.id;h=f.bindings;if(h){var k,Q=0;for(;k=h[Q++];)if(typeof k.BV==q)k.BV(l)}n.hook(g(c.id+"c"),m);n.hook(g(c.id+"b"),m);b=d.Event(b);return d.CancelEvent(b)}if(Msn.Flash.Version()>=o)Q.hook(c,m);function n(a){k();if(!d.Target(a).getAttribute("notrack"))p(d.Target(a),"",L);a=d.Event(a);return d.CancelEvent(a)}function k(){var a=g(l+"ct");if(a){vid="";e.style.display=i;a.style.display="none";var c=f.removeChild(a);c=null}if(h){var b,d=0;for(;b=h[d++];)if(typeof b.AV==q)b.AV()}}k.hook(window,"unload");function g(a){return r.getElementById(a)}this.dispose=function(){c=f=e=0};this.CV=k}).as("Msn.HP.Video.Build");(function(){var a=this,b=document,c=60,d=300;a.OnLinkback=function(d,e,f){var f=f+"_m",a,c=b.getElementById(f);if(c){c.innerHTML="";for(a=0;a<=d.length-1;a++)if(d[a]&&e[a])c.innerHTML=c.innerHTML+'<a href="'+e[a]+'">'+d[a]+"</a>"}};a.OnAdLoaded=function(a,f){if(a&&a.imageUrl&&a.clickUrls&&a.clickUrls.length>=2&&f){var e=b.getElementById(f+"_a");if(e)e.innerHTML='<a href="'+a.clickUrls[1]+'"><img src="'+a.imageUrl+'" width="'+d+'" height="'+c+'"></a>'}};return a}).ns("Msn.Video");(function(a,h){var i=Msn.DOM,P=i.ChildElem,M=i.ParentElem,F=i.CreateElement,z=i.AppendChild,D=i.HasClass,o=i.CancelEvent,v="DIV",W="LI",X="UL",K="sp",J="sn",S="mouseover",V="mouseout",E="click",q="block",s,r,m,p,x,y,u,e,b=[],c,d,I="Previous",H="Next",k,w,g;if(!h)h={};var l=Msn.Util.ArgWithDefault,O=l(h.cSp,40),N=l(h.cDly,2000),t=l(h.cDir,-1),G=l(h.cIntv,10),I=l(h.cPrvT,"Previous item"),H=l(h.cNxtT,"Next item");U();function n(a){if(a){clearInterval(a);a=0}}this.dispose=function(){a=c=d=k=s=r=0};function U(){if(!a)return;B.hook(a,S);L.hook(a,V);d=i.PrevElem(a,v);if(d&&D(d,K)){Q.hook(d,E);d.title=I;d.style.display=q;var f=F("a");f.href="#";z(d,f)}c=i.NextElem(a,v);if(c&&D(c,J)){Y.hook(c,E);c.title=H;c.style.display=q;f=F("a");f.href="#";z(c,f)}if(!c&&!d)a.style.width="100%";k=P(a,v,1);a.style.display=q;var r=M(a);r.style.display=q;k.style.left=e=0;x=k.offsetWidth;y=x-a.offsetWidth>0?x-a.offsetWidth:0;u=-y;var o=0,l=k.childNodes,p=l.length;for(var g=0;g<p;g++){var n=l[g];if(n.tagName==X){var m=n.childNodes,s=m.length;for(var h=0;h<s;h++){var j=m[h];if(j.tagName==W){b[o]=j.offsetLeft;o++}}}}C()}function C(){n(s);g=O||g;m=a.clientWidth;p=(new Date).getTime();s=setInterval(Z,G)}function Z(){var b=(new Date).getTime(),c=(b-p)/1000*g;if(c>0){var a=e+t*c;if(t==-1&&a>-y-m||t==1&&a<+m){p=b;f(a)}else{n(s);f(u);T(u)}}else p=b}function f(a){if(k.style)k.style.left=(e=a)+"px"}function T(){f(m);C()}function Y(d){var c=b.length;if(Math.abs(e)>=b[c-1])f(0);else for(var a=0;a<c;a++)if(Math.abs(e)-b[a]<0){f(-b[a]);break}else if(Math.abs(e)-b[a]==0&&a<c-1){f(-b[a+1]);break}A(d);o(d)}function Q(c){var a=b.length;if(Math.abs(e)<b[1])f(-b[a-1]);else for(j=a-1;j>=0;j--)if(Math.abs(e)-b[j]>=0){f(-b[j-1]);break}A(c);o(c)}function A(a){n(r);r=setInterval(R,N);B(a)}function R(){n(r);g=w}function B(a){if(g!=0){w=g;g=0}o(a)}function L(a){g=w;o(a)}}).as("Msn.HP.Scroller");(function(){var b=90,d=3650,h="ushpcli",e="hpcli",i="ushpsvr",j="hpsvr",f="hpovrt",k="hpoly",a="|",m=".",g="W.H|L.|S.|R.|U.L|C.",o="O:1|H:1";function n(){p();q();l();r()}function p(){cliValue=h.GetCookie();if(!cliValue)e.SetCookie("",-1);else{h.SetCookie(cliValue,b);if(cliValue.substr(0,1)=="0")e.SetCookie(g,d);else{var i=cliValue.split(a),j=g.split(a),n=0,l=1,m=3,k=5;for(var f=1;f<i.length;f++){if(!i[f])continue;switch(i[f].substr(0,1)){case "H":if(i[f]=="H.1.0")j[n]+="1";break;case "R":j[m]+=c(i[f]);break;case "C":j[k]+=c(i[f]);break;case "L":j[l]+=c(i[f]);break;default:break}}e.SetCookie(j.join(a),d)}}}function c(b){var a=b.split(m);return a.length>3&&a[1]=="1"?a[3]:""}function q(){svrValue=i.GetCookie();if(!svrValue)j.SetCookie("",-1);else{i.SetCookie(svrValue,b);v10parts=svrValue.split(a);v11parts=[];for(var c=0;c<v10parts.length;c++){if(!v10parts[c])continue;switch(v10parts[c].substr(0,1)){case "M":case "F":case "T":case "E":case "D":case "W":v11parts.push(v10parts[c]);default:break}}j.SetCookie(v11parts.join(a),d)}}function l(){var a=f.GetCookie();if(a){f.SetCookie("",-1,".msn.com");f.SetCookie(a,b)}}function r(){if(!k.GetCookie())k.SetCookie(o,b)}n.hook(window,"unload")}).as("Msn.HP.Migrate");(function(q,a){if(!a)a={};var b=Msn.Util.ArgWithDefault,zb=b(a.surl,"http://www.hotmail.msn.com/cgi-bin/mymsn/mymsn.js"),vb=b(a.curl,"http://mymsn.hotmail.msn.com/cgi-bin/mymsn/mymsn.html"),Db=b(a.d,0),jb=b(a.cCookie,"MyMsn"),kb=b(a.durl,"{0}/cgi-bin/HoTMaiL?_HMaction=delete&{1}=on&{2}"),Eb=b(a.timeout,10000),J=b(a.msgs,"msgcount"),Bb=b(a.scarab,"signin"),rb=b(a.stitle,"Sign In"),qb=b(a.sclass,"scarab"),lb=b(a.delay,2000),ub=b(a.load,"Loading..."),W=b(a.empty,"You have no new messages in your inbox."),u=b(a.err,"The Hotmail service is temporarily unavailable."),mb=b(a.noacct,"This module requires an activated Hotmail account. Click here to sign in."),pb=b(a.inact,"Your Hotmail account is inactive. Click here to sign in and reactivate."),sb=b(a.block,"This Hotmail account has been closed. Access is denied."),Z=b(a.hmdown,"Hotmail is temporarily unavailable. We apologize for the inconvenience."),O=b(a.hmunavail,"Hotmail is temporarily unavailable through this site. Please go directly to <a href=http://www.hotmail.com>www.hotmail.com</a> to access your account. We apologize for the inconvenience."),A=b(a.msl,24),F=b(a.subapp,"..."),M=b(a.today,"Today"),H=b(a.yester,"Yesterday"),I=b(a.date,"ddd MMM d"),K=b(a.time,"h:mm tt"),hb=b(a.cntdef,"Check your mail"),tb=b(a.cnt0,"No new messages."),wb=b(a.cnt1,"1 new message!"),ab=b(a.cnt2,"{0} new messages!"),cb=b(a.nav,"linklist9"),bb=b(a.more,"More..."),N=[{text:"Compose",cmd:"compose",piiurl:"http://www.hotmail.msn.com/pii/Top_Compose/"},{text:"Inbox",cmd:"hotmail",piiurl:"http://www.hotmail.msn.com/pii/Top_Inbox/"},{text:"Calendar",url:"http://calendar.msn.com/calendar/isapi.dll"},{text:"Contacts",cmd:"addresses",piiurl:"http://www.hotmail.msn.com/pii/Top_Contacts/"}],V=b(a.defhref,"http://www.hotmail.msn.com/cgi-bin/sbox?rru=hotmail"),R=b(a.cntpiiurl,"http://www.hotmail.msn.com/pii/GreetingBar_Inbox/"),Q=b(a.cntpiitxt,"New Messages"),T=b(a.cmc,0),C=b(a.cmm,999),U=b(a.msgpiiurl,"http://www.hotmail.msn.com/pii/Email_Read/"),S=b(a.msgpiitxt,"Read Email"),B="Delete",ib='<a href="{1}">{0}<span title="{2}" class="{3}"></span></a>',j=typeof a.del!="undefined"?a.del:B;if(typeof j!="string")j=j?B:0;var p=a.auth?a.auth:0;if(p&&typeof p=="string")p=p.toLowerCase()=="true";var z=this,r=document,c=window,h=Msn.DOM,n=h.HasClass,e=h.AddClass,s=h.Updated,f=h.CreateElement,d=h.AppendChild,m=h.SetAttribute,g,k,o,l,y,L=0,E="hotmail";function G(a){return r.getElementById(a)}z.dispose=function(){if(g)g.dispose();q=o=l=g=0};z.OnExpand=function(){if(!L){var b="hmiFrame";if(!Db)if(p){var a=r.getElementById(b);if(!a){a=f("iframe");a.id=a.name=b;a.width=a.height=0;a.src=vb+"?"+(new Date).getTime();xb.hook(a,"load");r.body.appendChild(a)}}else{c.iError=2;i()}else{c.iError=6;i()}}};function xb(){var e=new RegExp("\\b"+jb+"\\s*=\\s*([^;]*)","i"),b=e.exec(r.cookie),a=b&&b.length>1?b[1]:"";if(a)switch(a){case "1":case "6":c.iError=parseInt(a);i();break;default:var d=zb+"?mmc="+a+"&nocache="+Math.random();Ab(d);break}else{c.iError=6;i()}}function nb(){P();t();if(c.bIsNewMail)j=0;if(c.aInboxView.length==0)g.msg(W,"msg");else{g.msg();var n=parseInt(a.max),m=n!="NaN"&&c.aInboxView.length>n?n:c.aInboxView.length,o=m<c.iInboxTotal,i,b,k=f("ul");e(k,"linklist1");d(l,k);for(var h=0;h<m;++h){var p=c.aInboxView[h];b=f("li");e(b,!h?"first":!o&&h==m-1?"last":"");d(k,b);if(j)db.bind(b,p);X(b,p)}if(o){b=f("li");e(b,"last");i=f("a");i.href=x(E);e(i,"morelink");i.innerHTML=bb;d(b,i);d(k,b)}}}function db(b,m){var a,g=0;this.dispose=function(){b=a=0};function o(){var c=f("a");e(c,"del");c.setAttribute("notrack",1);c.title=j;d(b,c);c.href=p(m.strMsgLink);s.hook(c,"click");q.hook(c,"focus");r.hook(c,"blur");a=f("div");d(c,a)}function q(){g=1;k()}function r(){g=0;i()}function s(j){var f=new Image;f.onload=f.onerror=function(){f.onload=f.onerror=null};f.src=h.ParentElem(a,"A").href;if(m.oIcon.bRead){--c.iNewInbox;t()}--c.iInboxTotal;var d=b;if(n(d,"first")){var g=h.NextElem(d,"LI");if(g){e(g,"first");if(n(g,"last"))h.DelClass(g,"last")}}else if(n(d,"last")){var i=h.PrevElem(d,"LI");if(i&&!n(i,"first"))e(i,"last")}Msn.Bind.Unbind(d,1);h.ParentElem(d).removeChild(d);j=h.Event(j);return h.CancelEvent(j)}function p(e){var f="#",d=e.match(/http:\/\/([^\/?\s])*/i);if(d&&d[0]){var b=e.match(/\brru=([^&]*)/i);if(b&&b.length>1&&b[1]){var a=unescape(b[1]).match(/\bmsg=([^&]*)/i);if(a&&a.length>1&&a[1])f=kb.format(d[0],a[1],c.strA)}}return f}function k(){l("visible")}function i(){if(!g)l("hidden")}function l(b){a.style.visibility=b}o();k.hook(b,"mouseover");i.hook(b,"mouseout")}function X(i,b){var a=f("a");a.href=b.strMsgLink+"&"+c.strA;e(a,"msg "+gb(b));if(b.oIcon.bRead)e(a,"unread");m(a,"piitxt",S);m(a,"piiurl",U);d(i,a);var g=f("div");e(g,"pri "+Y(b));d(a,g);d(g,v("sent",fb(b.dDate)));d(g,v("from",b.strFromName));var h=b.strSubject;if(h.length>A)h=h.substring(0,A-F.length).concat(F);d(g,v("subj",h));return a}function fb(b){var a,e=86400000,g=new Date,f=g.getDay(),d=b.getDay(),c=g.getTime()-b.getTime();if(M&&c<e&&f==d)a=M;else if(H&&c<2*e&&f==(d+1)%7)a=H;if(I&&!a)a=b.format(I);if(K)a+=(a?"<br/>":"")+b.format(K);return a}function v(b,c){var a=f("div");e(a,b);a.innerHTML=c;return a}function gb(d){var a=d.oIcon,c=a.iReply,b=a.iGroup;if(c==1)return "replied";if(c==2)return "forwarded";if(b==3)return "msn";if(b==4)return "courier";if(a.bAttach)return "attach";if(a.bRead)return "unread";return "read"}function Y(a){switch(a.oIcon.iPriority){case 1:return "low";case 2:return "high";default:return "norm"}}function Ab(e){g.msg(ub,"msg",lb);L=1;var b=r.getElementsByTagName("head")[0],a=f("script");a.type="text/javascript";a.onload=i;a.onerror=eb;a.onreadystatechange=function(){if(a.readyState=="loaded"){a.onreadystatechange=null;d(b,a);i()}};a.src=e;k=c.setTimeout(Cb,Eb);if(typeof a.readyState=="undefined"){d(b,a);if(typeof c.iError!="undefined")i()}}function i(){if(typeof c.iError=="number"&&c.iError){w();switch(c.iError){case 1:case 2:g.msg(D(mb),"msg");break;case 3:g.msg(D(pb),"msg");break;case 4:g.msg(sb,"err");break;case 5:g.msg(Z,"err");break;case 6:g.msg(O,"err");break;default:g.msg(u,"err");break}s()}else if(typeof c.aInboxView=="object")if(!c.aInboxView){w();g.msg(u,"err");s()}else if(typeof c.AmIDone=="number"&&c.AmIDone){w();nb();s()}}function eb(){c.iError=99;i()}function Cb(){if(k){k=0;if(typeof c.AmIDone=="number"&&c.AmIDone==1)i();else{g.msg(u,"err");s()}}}function D(a){if(y)a=ib.format(a,y,rb,qb);return a}function w(){if(k){c.clearTimeout(k);k=0}g.msg()}function x(a){return c.strBaseURL+c.strA+"&rru="+a}function P(){var b,g=f("ul");e(g,cb);for(var c=0;c<N.length;++c){var a=N[c];b=yb(g,a.text,a.cmd?x(a.cmd):a.url,a.piiurl);if(!c)e(b,"first")}if(b)e(b,"last");d(o,g)}function yb(h,g,e,c){var b=f("li"),a=f("a");a.href=e;a.innerHTML=g;if(c)m(a,"piiurl",c);d(b,a);d(h,b);return b}function t(){if(J){var b=G(J);if(b){if(b.tagName&&b.tagName.toLowerCase()=="a")a=b;else{b.innerHTML="";var a=f("a");d(b,a)}if(typeof c.iError!="number"||c.iError||typeof c.iNewInbox!="number"){a.innerHTML=hb;a.href=V}else{var g=c.iNewInbox;switch(g){case 0:a.innerHTML=tb;break;case 1:a.innerHTML=wb;e(a,"new");break;default:if(T&&g>C)g=C+"+";a.innerHTML=ab.format(g);e(a,"new");break}a.href=x(E)}m(a,"piiurl",R);m(a,"piitxt",Q)}}}function ob(){e(q,"double2 cf");o=f("div");e(o,"child c1 first");d(q,o);l=f("div");e(l,"child c2 last");d(q,l);var b=f("div");d(l,b);g=new Msn.HP.DA(b,{close:0});var a=G(Bb);if(a){if(!a.href)a=h.ChildElem(a,"A");if(a)y=a.href}t();if(!n(q,"closed"))z.OnExpand()}ob()}).as("Msn.HP.Hotmail");(function(){this.SetText=function(c,b){var a=document.getElementById(c);if(a)a.value=b}}).ns("Msn.HP.TextBox")