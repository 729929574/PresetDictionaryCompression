(function(){var a=this,c="string";Function.addMethod("hook",function(d,e){if(d){var f=b();if(!f&&d.addEventListener)d.addEventListener(e,this,false);else if(!f&&d.attachEvent)d.attachEvent("on"+e,this);else{var c=d["x"+e];if(c&&c.constructor==Array)if(c.contains(this))c=null;else c.push(this);else c=d["x"+e]=[this];if(c){d["on"+e]=function(d){var f=true;d=a.Event(d);for(var b=0;b<c.length;++b){var e=c[b](d);if(typeof e!="undefined"&&!e)f=false}return f};d=null}}}return this});Function.addMethod("unhook",function(a,c){if(a){var e=b();if(!e&&a.removeEventListener)a.removeEventListener(c,this,false);else if(!e&&a.detachEvent)a.detachEvent("on"+c,this);else{var d=a["x"+c];if(d&&d.constructor==Array)d.remove(this);else a["on"+c]=null}}return this});a.CancelEvent=function(b){b=a.Event(b);if(b){b.cancelBubble=true;if(b.stopPropagation)b.stopPropagation();b.returnValue=false;if(b.preventDefault)b.preventDefault()}return false};a.Event=function(a){return a||window.event};a.Target=function(c){c=a.Event(c);var b=c.target||c.srcElement;if(b&&b.nodeType!=1)b=a.ParentElem(b);return b};a.InnerText=function(b){var d="";if(b)if(typeof b.innerText==c)d=b.innerText;else for(var f=0;f<b.childNodes.length;++f){var e=b.childNodes[f];switch(e.nodeType){case 1:d+=a.InnerText(e);break;case 3:d+=e.nodeValue;break}}return d};a.NextElem=function(c,b){var a=c.nextSibling;while(a&&(a.nodeType!=1||b&&a.nodeName!=b))a=a.nextSibling;return a};a.PrevElem=function(c,b){var a=c.previousSibling;while(a&&(a.nodeType!=1||b&&a.nodeName!=b))a=a.previousSibling;return a};a.ParentElem=function(c,b){var a=c.parentNode;while(a&&(a.nodeType!=1||b&&a.nodeName!=b))a=a.parentNode;return a};a.ChildElem=function(e,f,g){var d=null,b;for(var c=0;!d&&c<e.childNodes.length;++c){b=e.childNodes[c];if(b.nodeType==1)if(!f||b.nodeName==f)d=b}if(!g)for(c=0;!d&&c<e.childNodes.length;++c){b=e.childNodes[c];if(b.nodeType==1)d=a.ChildElem(b,f)}return d};a.ForEach=function(e,d,c){for(var b=0;b<d.childNodes.length;++b){var a=d.childNodes[b];if(a.nodeType==1&&(!c||a.nodeName==c))if(e(a))break}};a.ChildCount=function(d,c){var e=0,a,b;for(a=0;a<d.childNodes.length;++a){b=d.childNodes[a];e+=b.nodeType==1&&(!c||b.nodeName==c)?1:0}return e};a.AddClass=function(a,e){var c=a.className;if(c){var g=c.collapse().split(" "),d=e.collapse().split(" ");for(var b=0;b<d.length;++b){var f=d[b];if(!g.contains(f))a.className+=" "+f}}else a.className=e;return a.className};a.DelClass=function(b,g){var a=b.className;if(a){var f=a.collapse().split(" "),d=g.collapse().split(" ");for(var c=0;c<d.length;++c)f.remove(d[c]);var e=f.join(" ");if(e!=a)b.className=e}return b.className};a.HasClass=function(a,b){return a&&a.className&&a.className.collapse().split(" ").contains(b)};a.AppendChild=function(a,b){a.appendChild(b);return a};a.SetInnerHtml=function(a,b){a.innerHTML=b};a.SetAttribute=function(b,a,c){b.setAttribute(a,c)};a.GetAttribute=function(b,a){return b.getAttribute(a)};a.CreateElement=function(d,a){var b=document.createElement(d);if(typeof a==c)setInnerHtml(b,a);else if(a)appendChild(b,a);return b};a.Updated=function(){if(a.Access&&typeof a.Access.Updated=="function")a.Access.Updated()};function b(){return navigator.userAgent.indexOf("Safari")>=0}}).ns("Msn.DOM");if(typeof encodeURIComponent=="undefined")window.encodeURIComponent=function(i){var d="",c=63,j=55296,g=56320,l=57344,k=65536,b=128,e=0,a,f,m="0123456789ABCDEF",n="0123456789-_.!~*'()";function h(){var c=0,a,d,b="";for(;c<arguments.length;++c){a=arguments[c];d=String.fromCharCode(a);if(64<a&&a<91||96<a&&a<123||n.indexOf(d)>=0)b+=d;else b+="%"+m.charAt(a>>4)+m.charAt(a&15)}return b}for(;e<i.length;++e){a=i.charCodeAt(e);if(j<=a&&a<g){if(++e>=i.length)break;f=i.charCodeAt(e);if(f<g||l<=f)continue;a=(a-j<<10)+(f-g)+k}else if(g<=a&&a<l)continue;if(a<b)d+=h(a);else if(a<2048)d+=h(a>>6|192,a&c|b);else if(a<k)d+=h(a>>12|224,a>>6&c|b,a&c|b);else d+=h(a>>18|240,a>>12&c|b,a>>6&c|b,a&c|b)}return d};(function(){var a="wpv",b=this;(function(){var c=b.Val()+1;a.SetCookie(c,30)}).hook(window,"unload");b.Val=function(){var b=parseInt(a.GetCookie());return b>=-1?b:0};b.Reset=function(){a.SetCookie(-1,30)}}).ns("Msn.HP.Tb");(function(){var o=">",m="body",l="[form submit]",r=document,c=Msn.DOM,g=c.CancelEvent,k=Msn.HP.Tb,a=this,j="notrack",h="notracktmp";function d(){if(k)k.Reset()}a.Setup=function(b){if(!b)b={};if(a.Impl&&a.Impl.Setup)a.Impl.Setup(b)};a.Event=function(b,c,e,f,h,d){var g=a.Create(b,c,e,f,h,d);return a.Send(g,b.nodeName,b.sourceIndex)};a.Navigation=function(b,c,f,g,i,e){d();var h=a.Create(b,c,f,g,i,e);return a.Send(h,b.nodeName,b.sourceIndex,1)};a.Create=function(a,e,g,h,k,n){var q=[],j;if(a){var d=null;while(a){switch(a.nodeName){case "A":case "AREA":if(!d){d=a;if(i(d))return 0}if(!e){j=a.href;e=b(a,"piiurl",j)}if(!g)g=b(a,"piitxt",c.InnerText(a));case "IMG":if(!g)g=b(a,"alt");break;case "FORM":if(!d){d=a;if(i(d))return 0}if(!e){j=a.action;e=b(a,"piiurl",j)}if(!g)g=b(a,"piitxt",l);break}if(a.id){if(d&&!k)k=f(a,d);q.splice(0,0,a.id)}a=c.ParentElem(a)}}var s=null;if(e){if(!h){h=q.join(o);if(!h)h=m}if(!k)k=f(r.body,d);if(!n)n=p(e);s={tgt:e,pii:j,cm:h,ce:k,hl:g,gt1:n?n:"",node:d}}return s};a.Send=function(c,e,d,f){var b=false;if(c)if(a.Impl&&a.Impl.Send)b=a.Impl.Send(c,e,d,f);return b};function i(a){var c=0;if(b(a,j))c=1;else if(b(a,h)){c=1;n(a,h)}return c}function f(b,c){var a=0;if(b)if(b==c)a=1;else a=e(b,c);return a>0?a:0}function e(d,f,a){if(!a)a=-1;for(var c=0;a<0&&c<d.childNodes.length;++c){var b=d.childNodes[c];if(b.nodeType==1){if(b==f)return -a;if(!b.id){switch(b.nodeName){case "A":case "AREA":case "FORM":if(b.href&&!b.getAttribute(j))--a;break}a=e(b,f,a)}}}return a}function p(b){var c=/\bGT1=(\d+)/i,a=c.exec(b);return a?a[1]:""}function b(d,b,c){var a=d.getAttribute(b);return a?a:c}function n(c,b,a){c.setAttribute(b,typeof a=="undefined"?"":a)}function q(a){while(a&&!((a.nodeName=="A"||a.nodeName=="AREA")&&a.href))a=c.ParentElem(a);return a}(function(b){b=c.Event(b);var e=c.Target(b),f=true;if(b.button!=2&&q(e)){var h=a.Create(e);if(h)if(a.Impl&&a.Impl.Click){d();if(!a.Impl.Click(h,b,e.nodeName,e.sourceIndex))f=g(b)}}return f}).hook(document,"click");a.Form=function(b){var e=this;e.dispose=function(){b=0};(function(e){e=c.Event(e);var f=true,h=a.Create(b);if(h)if(a.Impl&&a.Impl.Click){d();if(!a.Impl.Click(h,e,b.nodeName,b.sourceIndex))f=g(e)}return f}).hook(b,"submit")}}).ns("Msn.Tracking");(function(){var d=this,a=null,b=document;d.GetVersion=function(a){return c(a)};function c(h){if(h||a===null){var c;a=0;try{var d,g=window.navigator.plugins;if(g&&g.length){if(g["Silverlight Plug-In"]){c=b.createElement("div");b.body.appendChild(c);c.innerHTML='<embed type="application/x-silverlight" />';d=c.childNodes[0]}}else if(window.ActiveXObject)d=new ActiveXObject("AgControl.AgControl");if(d){var f=["2.0","1.1","1.0"];for(var e=0;e<f.length;++e)if(d.IsVersionSupported(f[e])){a=f[e];break}}}catch(i){}if(c)b.body.removeChild(c)}return a}}).ns("Msn.AgTest");(function(){var n="ushpsvr",e="|",h=":",l="ushpcli",g=".",p="ushpwea",m="Q",k="A",c=this,d={},f=0,a={},b=[];function i(){var h=l.GetCookie();if(h){var b=h.split(e);f=b&&b.length>0?parseInt(b[0]):0;for(var c=1;c<b.length;++c){var a=b[c].split(g);d[a[0]]={V:a.length>1?parseInt(a[1]):0,E:a.length>2?parseInt(a[2]):1,D:a.length>3?a[3]:""}}}}function j(){var d=n.GetCookie();if(d){var f=d.split(e);for(var c=0;c<f.length;++c){var b=f[c].split(h);a[b[0]]=b.length>1?b[1]:""}}}function o(){var a=p.GetCookie();if(a)b=a.split(e);else b=[]}c.Settings=function(l){var c,f,e={},h=[],g=0;if(a["D"])e["D"]=a["D"];e["W"]=b?b.length:0;for(c in a){f=parseInt(a[c]);if(f)e[c]=f}for(c in d){var j=d[c];if(j.V){g++;if(j.E)if(c==="H"){f=l;e[c]=f}else{f=parseInt(a[c]);e[c]=f?f:1}else e[c]="C"}else if(e[c])e[c]=""}e[m]=g;var i=Msn.AgTest;if(i)e[k]=i.GetVersion();for(c in e)if(e[c]!=="")h.push(c+e[c]);return h.join(",")};i();j();o();c.C=d;c.H=f;c.W=b;c.S=a}).ns("Msn.HP.State");(function(){var e=window,h=document,f=screen,a=h.documentElement,b=this,g="undefined",d=0,c=0,j=e.location.href;function l(){if(typeof a.addBehavior!=g){a.addBehavior("#default#homePage");return typeof a.isHomepage!=g&&a.isHomepage(Msn.Page.HPUrl)?1:0}return 0}function k(){if(typeof e.innerWidth=="number"){d=e.innerWidth;c=e.innerHeight}else if(a&&a.clientWidth){d=a.clientWidth;c=a.clientHeight}else if(a.offsetWidth){d=a.offsetWidth;c=a.offsetHeight}}function i(){return h.cookie?"Y":"N"}k();b.hp=l;b.url=j;b.bw=d;b.bh=c;b.s=f.width+"x"+f.height;b.c=f.colorDepth;b.k=i}).ns("Msn.User");(function(){var s=this,n=window,E=document,M=Msn.DOM,L=Msn.HP.State,c=Msn.User,I=500,J=2000,A="http://g.msn.com/_0USHP/32?{0}&&{1}",z="http://exp.msn.com/ct.aspx?{0}",r="msn.com_files/s12259782108012.gif",v="010",w=1,G=3,m="",l="",k="",e="",a,g,h,C,o,f={},b,j,t;s.Setup=function(a){a.pp=(""+a.pp).toLowerCase()=="true"?1:0;var b={ndh:1,t:K(),ns:"msnportal",pageName:a.pn,g:c.url,r:E.referrer,s:c.s,c:c.c,k:c.k(),bw:c.bw,bh:c.bh,hp:c.hp()?"Y":"N"};t=b;f=a;if(a.opv)w=parseInt(a.opv);if(a.lt)v=a.lt;if(a.oUrl)r=a.oUrl;if(a.gUrl)A=a.gUrl;if(a.eUrl)z=a.eUrl;if(w)H(f)};s.Send=function(f,e,a,g){var h=false;D();var c=y(f,e,a);for(b=0;j=c[b++];)p(j);h=1;if(g){var d=(new Date).getTime();while((new Date).getTime()-d<I);}};s.Click=function(c,m,t,r){var k=true;D();q();var e=y(c,t,r);a=self;if(m.shiftKey||m.ctrlKey)a=0;var f=c.node&&c.node.getAttribute("target");if(f=="_blank")a=0;if(a&&f&&f!="_top")try{while(a&&f!=a.name)a=a===a.parent?null:a.parent}catch(u){a=1}if(!a)for(b=0;j=e[b++];)p(j);else{k=false;g=c.pii;var i=[],o=0,s=e.length;for(b=0;e[b];){var d=new Image;d.onerror=d.onload=function(){d.onerror=d.onload=null;if(h&&g&&++o==s){var e=a,b=g;q();x(c.node,e,b)}};i[b++]=d}h=n.setTimeout(function(){var d;for(b=0;d=i[b++];)d.onerror=d.onload=null;var f=a,e=g;q();x(c.node,f,e)},J);var l;for(b=0;l=i[b];)l.src=e[b++]}return k};function K(){var a=new Date;return a.getDate()+"/"+a.getMonth()+"/"+a.getFullYear()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+" "+a.getDay()+" "+a.getTimezoneOffset()}function H(a){var b={ch:a.ch,server:"msn.com",c1:"Portal",v1:(new Date).getMonth()+1+"/"+(new Date).getFullYear(),c2:"en-us",v2:(new Date).getMonth()+1+"/"+(new Date).getDate()+"/"+(new Date).getFullYear(),c3:"10.5",c19:L.Settings(a.pp),c22:a.pp?"True":"False",c29:c.url};o=d(t);var e=r.format(u(),o,d(b));p(e)}function u(){var b=new Date,a=Math,c=a&&a.random?a.floor(a.random()*10000000000000):b.getTime();return "s"+a.floor(b.getTime()/10800000)%10+c}function d(b){var c=[];for(var a in b){var d=b[a];c.push(a+"="+encodeURIComponent(d))}return c.join("&")}function x(a,c,b){if(a)try{a.setAttribute("notracktmp",1);if(a.submit){if(a.action!="#"&&!(/weather/i).test(a.action))a.submit()}else a.click()}catch(d){c.location=b}}function y(a,j,B){var c=[],h=v.split(""),i=parseInt,s,p=120,q=135,g="_";if(h.length==G){var b=[];if(g.length>1)g=g.substring(0,1);a.cm.length<=p?b.push(a.cm):b.push(a.cm.substring(1,p));a.hl.length<=q?b.push(a.hl):b.push(a.hl.substring(1,q));s=b.join(g);var y={ps:m,pi:l,di:k,gt1:a.gt1,ce:a.ce>0?a.ce:0,cm:a.cm,hl:a.hl,su:e},x={k1:"du",v1:a.tgt,k2:"ps",v2:m,k3:"pi",v3:l,k4:"di",v4:k,k5:"gt1",v5:a.gt1,k6:"ce",v6:a.ce>0?a.ce:0,k7:"cm",v7:a.cm,k8:"hl",v8:a.hl,k9:"pp",v9:f.pp,k10:"su",v10:e},w={c12:a.tgt,c13:a.cm,c15:a.ce,c16:a.hl,c17:f.pn+":"+f.ch,c18:a.gt1,pe:"lnk_o",pev2:a.hl},t={c38:"10.5",events:"event4",v11:s,v12:a.tgt,pev1:a.tgt,pid:f.pn,pidt:"1",oid:a.tgt,ot:j,oi:B};if(i(h[0]))c.push(z.format(d(x)));if(i(h[1]))c.push(A.format(F(a.tgt),d(y)));if(i(h[2])){var n=d(w);if(j=="A"||j=="AREA")n+="&"+d(t);c.push(r.format(u(),o,n))}}return c}function F(a){a=B(a);return a?a:B(n.location.href)}function B(a){if(a){var b=a.indexOf("#");if(b>=0)a=a.substring(0,b)}return a}function p(b){var a=new Image;a.onload=a.onerror=function(){a.onload=a.onerror=null};a.src=b}function q(){if(h){n.clearTimeout(h);h=0;g=0}a=0}function D(){if(typeof C=="undefined"){var b=E.getElementById("ctag");C=!b;if(b){var a=b.src;if(a){if(!k)k=i(a,"di");if(!l)l=i(a,"pi");if(!m)m=i(a,"ps");if(!e)e=i(a,"tp")}}}if(!e)e=n.location.href}function i(c,b){var d=new RegExp("\\b"+b+"=([^&]+)","i"),a=d.exec(c);return a?a[1]:""}}).ns("Msn.Tracking.Impl")